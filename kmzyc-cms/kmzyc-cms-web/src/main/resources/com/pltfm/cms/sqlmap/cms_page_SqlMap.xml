<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="CMS_PAGE" >
  <resultMap id="abatorgenerated_CmsPageResult" class="com.pltfm.cms.vobject.CmsPage" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    <result column="PAGE_ID" property="pageId"/>
    <result column="NAME" property="name"/>
    <result column="TEMPLATE_PATH" property="templatePath" />
    <result column="OUTPUT_PATH" property="outputPath" />
    <result column="TITLE" property="title"/>
    <result column="SEO" property="seo"/>
    <result column="KEYWORDS" property="keywords" />
    <result column="COMPANY" property="company"/>
    <result column="AUTHOR" property="author"/>
    <result column="DESCRIBE" property="describe"  />
    <result column="REMARK" property="remark"/>
    <result column="STATUS" property="status"/>
    <result column="CREATE_DATE" property="createDate"/>
    <result column="CREATED" property="created"/>
    <result column="MODIFY_DATE" property="modifyDate" />
    <result column="MODIFIED" property="modified"/>
    <result column="TEMPLATE_ID" property="templateId"/>
    <result column="PUBLISH_TYPE" property="publicType"/>
    <result column="SITE_ID" property="siteId"/>
    <result column="STYLES_ID" property="stylesId"/>
  </resultMap>
  
  
  <resultMap id="abatorgenerated_CmsPageResult_getAllPage" extends="abatorgenerated_CmsPageResult"
		class="com.pltfm.cms.vobject.CmsPage">
		  <result column="THEME" property="theme"/>
	</resultMap>
  
  <sql id="abatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="abatorgenerated_selectByPrimaryKey" resultMap="abatorgenerated_CmsPageResult_getAllPage" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    select page.PAGE_ID, page.NAME, page.TEMPLATE_PATH, page.OUTPUT_PATH, page.TITLE, page.SEO, page.KEYWORDS, page.COMPANY, page.AUTHOR,
      page.DESCRIBE, page.REMARK, page.STATUS, page.CREATE_DATE, page.CREATED, page.MODIFY_DATE, page.MODIFIED,page.TEMPLATE_ID,page.PUBLISH_TYPE,page.SITE_ID,page.STYLES_ID,ct.NAME as THEME 
    from CMS_PAGE page,CMS_THEME ct
    where page.TEMPLATE_ID = ct.theme_id(+) and page.PAGE_ID = #pageId#
  </select>
  
  <select id="abatorgenerated_selectByPrimaryPublishType" resultMap="abatorgenerated_CmsPageResult" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    select PAGE_ID, NAME, TEMPLATE_PATH, OUTPUT_PATH, TITLE, SEO, KEYWORDS, COMPANY, AUTHOR,
      DESCRIBE, REMARK, STATUS, CREATE_DATE, CREATED, MODIFY_DATE, MODIFIED,TEMPLATE_ID,PUBLISH_TYPE,SITE_ID,STYLES_ID
    from CMS_PAGE
    where PUBLISH_TYPE = #publicType# 
    <isNotEmpty property="siteId">
  		<isNotNull prepend="and" property="siteId">
  			SITE_ID= #siteId#
  		</isNotNull>
	</isNotEmpty>
  </select>
  
  
  
    <select id="abatorgenerated_selectBpageId" resultMap="abatorgenerated_CmsPageResult" parameterClass="com.pltfm.cms.vobject.CmsPage" >
     select PAGE_ID, NAME, TEMPLATE_PATH, OUTPUT_PATH, TITLE, SEO, KEYWORDS, COMPANY, AUTHOR,
      DESCRIBE, REMARK, STATUS, CREATE_DATE, CREATED, MODIFY_DATE, MODIFIED,TEMPLATE_ID,PUBLISH_TYPE,SITE_ID,STYLES_ID
    from CMS_PAGE where  PAGE_ID in (select PAGE_ID from cms_page_window where  WINDOW_ID=#windwId#)
  </select>
  
  
  <select id="abatorgenerated_selectByPrimaryPublishType1" resultMap="abatorgenerated_CmsPageResult" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    select PAGE_ID, NAME, TEMPLATE_PATH, OUTPUT_PATH, TITLE, SEO, KEYWORDS, COMPANY, AUTHOR,
      DESCRIBE, REMARK, STATUS, CREATE_DATE, CREATED, MODIFY_DATE, MODIFIED,TEMPLATE_ID,PUBLISH_TYPE,SITE_ID,STYLES_ID
    from CMS_PAGE
    where PUBLISH_TYPE in (#publicType#,7,8)
    <isNotEmpty property="siteId">
  		<isNotNull prepend="and" property="siteId">
  			SITE_ID= #siteId#
  		</isNotNull>
	</isNotEmpty>
  </select> 
  
  <select id="abatorgenerated_selectByPrimaryPublishType2" resultMap="abatorgenerated_CmsPageResult" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    select PAGE_ID, NAME, TEMPLATE_PATH, OUTPUT_PATH, TITLE, SEO, KEYWORDS, COMPANY, AUTHOR,
      DESCRIBE, REMARK, STATUS, CREATE_DATE, CREATED, MODIFY_DATE, MODIFIED,TEMPLATE_ID,PUBLISH_TYPE,SITE_ID,STYLES_ID
    from CMS_PAGE
    where PUBLISH_TYPE in (#publicType#)
    <isNotEmpty property="siteId">
  		<isNotNull prepend="and" property="siteId">
  			SITE_ID= #siteId#
  		</isNotNull>
	</isNotEmpty>
  </select> 
  
  <select id="abatorgenerated_selectByExample" resultMap="abatorgenerated_CmsPageResult" parameterClass="com.pltfm.cms.vobject.CmsPageExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    select PAGE_ID, NAME, TEMPLATE_PATH, OUTPUT_PATH, TITLE, SEO, KEYWORDS, COMPANY, AUTHOR,
      DESCRIBE, REMARK, STATUS, CREATE_DATE, CREATED, MODIFY_DATE, MODIFIED,TEMPLATE_ID,PUBLISH_TYPE,SITE_ID,STYLES_ID
    from CMS_PAGE
    <isParameterPresent >
      <include refid="CMS_PAGE.abatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <delete id="abatorgenerated_deleteByPrimaryKey" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    delete from CMS_PAGE
    where PAGE_ID = #pageId#
  </delete>
  <delete id="abatorgenerated_deleteByExample" parameterClass="com.pltfm.cms.vobject.CmsPageExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    delete from CMS_PAGE
    <include refid="CMS_PAGE.abatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="abatorgenerated_insert" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    <selectKey keyProperty="pageId">
    	select SEQ_CMS_PAGE.nextval from dual
    </selectKey>
    insert into CMS_PAGE (PAGE_ID, NAME, TEMPLATE_PATH, OUTPUT_PATH, TITLE, SEO, KEYWORDS, COMPANY,
      AUTHOR, DESCRIBE, REMARK, STATUS, CREATE_DATE, CREATED, MODIFY_DATE, MODIFIED,TEMPLATE_ID,PUBLISH_TYPE,SITE_ID,STYLES_ID)
    values (#pageId#, #name#, #templatePath#, #outputPath#,
      #title#, #seo#, #keywords#, #company#, #author#,
      #describe#, #remark#, #status#, #createDate#, #created#,
      #modifyDate#, #modified#,#templateId#,#publicType#,#siteId#,#stylesId#)
  </insert>
  
   <delete id="abatorgenerated_delete_page_online" parameterClass="com.pltfm.cms.vobject.CmsPage">
 	 <!-- 删除 -->
 	   BEGIN
      delete from cms_page_online where page_id =#pageId#;
      delete  from CMS_PAGE_WINDOW_ONLINE where PAGE_ID=#pageId#;
      
       delete from  cms_window_online a where a.window_id in 
      
      (select b.window_id from cms_window b, cms_page_window c  where b.window_id = c.window_id and c.page_id=#pageId# );
      
      
        <!--1.删除其它数据类型的数据-->
         delete from cms_window_data_online a where a.window_id in 
     
     (select  d.window_id from  cms_window b, cms_page_window c,cms_window_data d
 
      where b.window_id=d. window_id and b.window_id = c.window_id   
      
     and c.page_id =#pageId# and d.data_type!=4);
     
     <!--1.删除窗口数据类型的数据-->
      delete from cms_window_data_online e where e.window_id in 

      (select distinct a.window_id from (
         select * from cms_window_data  where data_type=4) a
         
     start with  a.window_id in 
     
       (   select distinct d.window_id from  cms_window b, cms_page_window c,cms_window_data d
 
      where b.window_id=d. window_id and b.window_id = c.window_id   
      
     and c.page_id =#pageId# and data_type=4  )
     
     connect by prior a.data_id =a.window_id);
       END;
 </delete>
   <!-- 备份线上数据 -->
    <insert id="abatorgenerated_insert_page_online" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    
    BEGIN
     
      
      
      <!-- 备份 -->
      <!-- cms_page表 -->
      insert  into cms_page_online(page_id,name,template_path,output_path,title,seo,keywords,company,author,describe,remark,status,
      create_date,created,modify_date,modified,publish_type,template_id,site_id,styles_id)  select 
      page_id,name,template_path,output_path,title,seo,keywords,company,author,describe,remark,status,create_date,created,modify_date,
        modified,publish_type,template_id,site_id,styles_id
        from  cms_page b  where  b.page_id =#pageId#;
      <!-- cms_page_window 表 -->
      insert into  CMS_PAGE_WINDOW_ONLINE a   select * from  CMS_PAGE_WINDOW b where  b.PAGE_ID=#pageId#;
      <!-- cms_window 表 -->
      insert into cms_window_online a
      select b.* from cms_window b, cms_page_window c where b.window_id = c.window_id and c.page_id =#pageId#;
      
     
       <!-- cms_window_data 表 -->
      <!--1.添加其它数据类型的数据 -->
       insert into  cms_window_data_online a select d.* from  cms_window b, cms_page_window c,cms_window_data d
 
      where b.window_id=d. window_id and b.window_id = c.window_id   
     and c.page_id =#pageId# and d.data_type!=4;
     


           <!--2.先添加窗口数据类型的数据(递归) -->
           
           
          insert into  cms_window_data_online a   select * from (
         select * from cms_window_data  where data_type=4) a
         
     start with  a.window_id in 
     
       (   select distinct d.window_id from  cms_window b, cms_page_window c,cms_window_data d
 
      where b.window_id=d. window_id and b.window_id = c.window_id   
      
     and c.page_id =#pageId# and data_type=4  )
     
     connect by prior a.data_id =a.window_id;
     
     
      
     
          insert into  cms_window_data_online a
    (   select *  from cms_window_data c where c.window_id in 
    (select data_id  from (
         select * from cms_window_data  where data_type=4) a
         
     start with  a.window_id in 
     
     
       (   select distinct d.window_id from  cms_window b, cms_page_window c,cms_window_data d
 
      where b.window_id=d. window_id and b.window_id = c.window_id   
      
     and c.page_id =#pageId# and data_type=4  )
     
     connect by prior a.data_id =a.window_id) and c.data_type!=4  
     
     and window_data_id not in (select window_data_id from cms_window_data_online) );
 
    
     END;
  </insert>
  <!-- 所有页面 -->
  <select id="abatorgenerated_queryAllPage" resultClass="java.lang.Integer" >
   
    select page_id from CMS_PAGE
   
  </select>
  <update id="abatorgenerated_updateByPrimaryKey" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    update CMS_PAGE
    set NAME = #name#,
      TEMPLATE_PATH = #templatePath#,
      OUTPUT_PATH = #outputPath#,
      TITLE = #title#,
      SEO = #seo#,
      KEYWORDS = #keywords#,
      COMPANY = #company#,
      AUTHOR = #author#,
      DESCRIBE = #describe#,
      REMARK = #remark#,
      STATUS = #status#,
      CREATE_DATE = #createDate#,
      CREATED = #created#,
      MODIFY_DATE = #modifyDate#,
      MODIFIED = #modified#,
      TEMPLATE_ID = #templateId#,
      PUBLISH_TYPE = #publicType#,
      SITE_ID = #siteId#,
      STYLES_ID = #stylesId#
    where PAGE_ID = #pageId#
  </update>
  <update id="abatorgenerated_updateByPrimaryKeySelective" parameterClass="com.pltfm.cms.vobject.CmsPage" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    update CMS_PAGE
    <dynamic prepend="set" >
      <isNotNull prepend="," property="name" >
        NAME = #name#
      </isNotNull>
      <isNotNull prepend="," property="templatePath" >
        TEMPLATE_PATH = #templatePath#
      </isNotNull>
      <isNotNull prepend="," property="outputPath" >
        OUTPUT_PATH = #outputPath#
      </isNotNull>
      <isNotNull prepend="," property="title" >
        TITLE = #title#
      </isNotNull>
      <isNotNull prepend="," property="seo" >
        SEO = #seo#
      </isNotNull>
      <isNotNull prepend="," property="keywords" >
        KEYWORDS = #keywords#
      </isNotNull>
      <isNotNull prepend="," property="company" >
        COMPANY = #company#
      </isNotNull>
      <isNotNull prepend="," property="author" >
        AUTHOR = #author#
      </isNotNull>
      <isNotNull prepend="," property="describe" >
        DESCRIBE = #describe#
      </isNotNull>
      <isNotNull prepend="," property="remark" >
        REMARK = #remark#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS = #status#
      </isNotNull>
      <isNotNull prepend="," property="createDate" >
        CREATE_DATE = #createDate#
      </isNotNull>
      <isNotNull prepend="," property="created" >
        CREATED = #created#
      </isNotNull>
      <isNotNull prepend="," property="modifyDate" >
        MODIFY_DATE = #modifyDate#
      </isNotNull>
      <isNotNull prepend="," property="modified" >
        MODIFIED = #modified#
      </isNotNull>
        <isNotNull prepend="," property="siteId" >
        SITE_ID = #siteId#
      </isNotNull>
        <isNotNull prepend="," property="stylesId" >
        STYLES_ID = #stylesId#
      </isNotNull>
    </dynamic>
    where PAGE_ID = #pageId#
  </update>
  <select id="abatorgenerated_countByExample" parameterClass="com.pltfm.cms.vobject.CmsPageExample" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    select count(*) from CMS_PAGE
    <include refid="CMS_PAGE.abatorgenerated_Example_Where_Clause" />
  </select>
  <update id="abatorgenerated_updateByExampleSelective" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    update CMS_PAGE
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.pageId" >
        PAGE_ID = #record.pageId#
      </isNotNull>
      <isNotNull prepend="," property="record.name" >
        NAME = #record.name#
      </isNotNull>
      <isNotNull prepend="," property="record.templatePath" >
        TEMPLATE_PATH = #record.templatePath#
      </isNotNull>
      <isNotNull prepend="," property="record.outputPath" >
        OUTPUT_PATH = #record.outputPath#
      </isNotNull>
      <isNotNull prepend="," property="record.title" >
        TITLE = #record.title#
      </isNotNull>
      <isNotNull prepend="," property="record.seo" >
        SEO = #record.seo#
      </isNotNull>
      <isNotNull prepend="," property="record.keywords" >
        KEYWORDS = #record.keywords#
      </isNotNull>
      <isNotNull prepend="," property="record.company" >
        COMPANY = #record.company#
      </isNotNull>
      <isNotNull prepend="," property="record.author" >
        AUTHOR = #record.author#
      </isNotNull>
      <isNotNull prepend="," property="record.describe" >
        DESCRIBE = #record.describe#
      </isNotNull>
      <isNotNull prepend="," property="record.remark" >
        REMARK = #record.remark#
      </isNotNull>
      <isNotNull prepend="," property="record.status" >
        STATUS = #record.status#
      </isNotNull>
      <isNotNull prepend="," property="record.createDate" >
        CREATE_DATE = #record.createDate#
      </isNotNull>
      <isNotNull prepend="," property="record.created" >
        CREATED = #record.created#
      </isNotNull>
      <isNotNull prepend="," property="record.modifyDate" >
        MODIFY_DATE = #record.modifyDate#
      </isNotNull>
      <isNotNull prepend="," property="record.modified" >
        MODIFIED = #record.modified#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="CMS_PAGE.abatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="abatorgenerated_updateByExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:55:46 CST 2013.
    -->
    update CMS_PAGE
    set PAGE_ID = #record.pageId#,
      NAME = #record.name#,
      TEMPLATE_PATH = #record.templatePath#,
      OUTPUT_PATH = #record.outputPath#,
      TITLE = #record.title#,
      SEO = #record.seo#,
      KEYWORDS = #record.keywords#,
      COMPANY = #record.company#,
      AUTHOR = #record.author#,
      DESCRIBE = #record.describe#,
      REMARK = #record.remark#,
      STATUS = #record.status#,
      CREATE_DATE = #record.createDate#,
      CREATED = #record.created#,
      MODIFY_DATE = #record.modifyDate#,
      MODIFIED = #record.modified#,
      TEMPLATE_ID = #templateId#,
      PUBLISH_TYPE = #publicType#,
      SITE_ID = #siteId#,
      STYLES_ID = #stylesId#
    <isParameterPresent >
      <include refid="CMS_PAGE.abatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <select id="abatorgenerated_getAllPage" parameterClass="com.pltfm.cms.vobject.CmsPage" resultMap="abatorgenerated_CmsPageResult_getAllPage">
  	 select page.PAGE_ID,page.NAME,page.TEMPLATE_PATH,page.OUTPUT_PATH,page.TITLE,page.SEO,page.KEYWORDS,page.COMPANY,page.AUTHOR,page.DESCRIBE,page.REMARK,
  	 page.STATUS,page.CREATE_DATE,page.CREATED,page.MODIFY_DATE,page.MODIFIED,page.TEMPLATE_ID,page.PUBLISH_TYPE,page.SITE_ID,page.STYLES_ID,ct.NAME as THEME from  (
                       select  ROW_NUMBER() OVER(order by MODIFY_DATE desc nulls last) as view_row_number, tt.* FROM CMS_PAGE tt
				    <dynamic prepend="where">
				    	<isNotEmpty property="name">
				    		<isNotNull prepend="and" property="name">
				    			NAME like '%$name$%'
				    		</isNotNull>
				    	</isNotEmpty>
				    	<isNotEmpty property="status">
				    		<isNotNull prepend="and" property="status">
				    			STATUS = #status#
				    		</isNotNull>	
				    	</isNotEmpty>
				    	
				    	<isNotEmpty property="publicType">
				    		<isNotNull prepend="and" property="publicType">
				    			PUBLISH_TYPE = #publicType#
				    		</isNotNull>	
				    	</isNotEmpty>
				    	
				    	<isNotEmpty property="pageId">
				    		<isNotNull prepend="and" property="pageId">
				    			PAGE_ID= #pageId#
				    		</isNotNull>
				    	</isNotEmpty>
				    	<isNotEmpty property="outputPath">
				    		<isNotNull prepend="and" property="outputPath">
				    			OUTPUT_PATH like '%$outputPath$%'
				    		</isNotNull>
				    	</isNotEmpty>
				    	<isNotEmpty property="siteId">
				    		<isNotNull prepend="and" property="siteId">
				    			SITE_ID= #siteId#
				    			
				    		</isNotNull>
				    	</isNotEmpty>
				    	<isNotEmpty property="ids">
				    		<isNotNull prepend="and" property="ids">
				    		$ids$
				    		</isNotNull>
				    	</isNotEmpty>
					</dynamic>
              ) page,Cms_Theme ct
         <![CDATA[ where page.TEMPLATE_ID = ct.theme_id(+) and page.view_row_number <= #endIndex# and page.view_row_number > #startIndex# ]]>
  </select>
    <!--  查询数目 -->
  <select id="abatorgenerated_countByPage" parameterClass="com.pltfm.cms.vobject.CmsPage" resultClass="java.lang.Integer" >
	select count(*) from  CMS_PAGE 
		<dynamic prepend="where">
	          <isNotEmpty property="name">
				    		<isNotNull prepend="and" property="name">
				    			NAME like '%$name$%'
				    		</isNotNull>
				    	</isNotEmpty>
				    	<isNotEmpty property="status">
				    		<isNotNull prepend="and" property="status">
				    			STATUS = #status#
				    		</isNotNull>	
				    	</isNotEmpty>
				    	
				    	<isNotEmpty property="publicType">
				    		<isNotNull prepend="and" property="publicType">
				    			PUBLISH_TYPE = #publicType#
				    		</isNotNull>	
				    	</isNotEmpty>
				    	
				    	<isNotEmpty property="pageId">
				    		<isNotNull prepend="and" property="pageId">
				    			PAGE_ID= #pageId#
				    		</isNotNull>
				    	</isNotEmpty>
				    	<isNotEmpty property="outputPath">
				    		<isNotNull prepend="and" property="outputPath">
				    			OUTPUT_PATH like '%$outputPath$%'
				    		</isNotNull>
				    	</isNotEmpty>
				    	<isNotEmpty property="siteId">
				    		<isNotNull prepend="and" property="siteId">
				    			SITE_ID= #siteId#
				    		</isNotNull>
				    	</isNotEmpty>
				    	<isNotEmpty property="ids">
				    		<isNotNull prepend="and" property="ids">
				    		$ids$
				    		</isNotNull>
				    	</isNotEmpty>
		</dynamic>
 </select>
 <!-- 根据name查找 -->
 <select id="abatorgenerated_getPage" parameterClass="com.pltfm.cms.vobject.CmsPage" resultMap="abatorgenerated_CmsPageResult">
 	select PAGE_ID,NAME,TEMPLATE_PATH,OUTPUT_PATH,TITLE,SEO,KEYWORDS,COMPANY,AUTHOR,DESCRIBE,REMARK,
  	 STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TEMPLATE_ID,PUBLISH_TYPE,SITE_ID,STYLES_ID from CMS_PAGE
  	<dynamic prepend="where">
		<isNotEmpty property="name">
			<isNotNull prepend="and" property="name">
				NAME = #name#
			</isNotNull>
		</isNotEmpty>
		<isNotEmpty property="siteId">
			<isNotNull prepend="and" property="siteId">
				SITE_ID = #siteId#
			</isNotNull>
		</isNotEmpty>
	</dynamic>
 </select>
  <select id="abatorgenerated_getLastId" resultClass="java.lang.Integer">
 	select SEQ_CMS_PAGE.nextval from dual
 </select>
 <delete id="abatorgenerated_delByPageId" parameterClass="java.lang.Integer">
 	delete from CMS_PAGE where PAGE_ID=#pageId#
 </delete>
 <!-- 输出路径验证 -->
 <select id="abatorgenerated_countOutPut" resultClass="java.lang.Integer">
  		select count(*) from (
		select page.page_id cid,page.name cname,page.output_path coutput,page.site_id from cms_page page 
			<dynamic prepend="where">
				<isNotEmpty property="pageId">
					<isNotNull prepend="and" property="pageId">
						PAGE_ID!=#pageId# and OUTPUT_PATH='$outputPath$'
					</isNotNull>
				</isNotEmpty>
			</dynamic>
		union
		select adc.adcolumn_id,adc.name,adc.output,adc.site_id from cms_adcolumn adc union
		select pro.id,pro.name,pro.output,pro.site_id from cms_promotion_task pro union
		select infor.infor_id,infor.name,infor.content,infor.site_id from cms_information infor )t
		 <dynamic prepend="where">
	          <isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				    	 t.cname = '$name$'
				     </isNotEmpty>
			  </isNotNull>
			  <isNotNull property="outputPath">
				     <isNotEmpty prepend="and" property="outputPath">
				     	t.coutput ='$outputPath$'
				     </isNotEmpty>
			  </isNotNull>
			  <isNotNull property="siteId">
			  		<isNotEmpty prepend="and" property="siteId">
			  			t.site_id = #siteId#
			  		</isNotEmpty>
			  </isNotNull>
		</dynamic>
  </select>
</sqlMap>