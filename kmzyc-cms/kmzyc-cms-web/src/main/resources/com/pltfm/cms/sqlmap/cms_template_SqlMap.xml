<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="CMS_TEMPLATE" >
  <resultMap id="abatorgenerated_CmsTemplateResult" class="com.pltfm.cms.vobject.CmsTemplate" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    <result column="TEMPLATE_ID" property="templateId"/>
    <result column="NAME" property="name"/>
    <result column="THEME" property="theme"/>
    <result column="PATH" property="path"/>
    <result column="REMARK" property="remark"/>
    <result column="STATUS" property="status"/>
    <result column="CREATE_DATE" property="createDate"/>
    <result column="CREATED" property="created"/>
    <result column="MODIFY_DATE" property="modifyDate"/>
    <result column="MODIFIED" property="modified"/>
    <result column="TYPE" property="type"/>
    <result column="PID" property="pid"/>
    <result column="SITE_ID" property="siteId"/>
  </resultMap>
  
   <resultMap id="abatorgenerated_CmsThemeTemplateResult" class="com.pltfm.cms.vobject.CmsTemplate" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    <result column="TEMPLATE_ID" property="templateId"/>
    <result column="NAME" property="name"/>
    <result column="THEME" property="theme"/>
    <result column="PATH" property="path"/>
    <result column="REMARK" property="remark"/>
    <result column="STATUS" property="status"/>
    <result column="CREATE_DATE" property="createDate"/>
    <result column="CREATED" property="created"/>
    <result column="MODIFY_DATE" property="modifyDate"/>
    <result column="MODIFIED" property="modified"/>
    <result column="TYPE" property="type"/>
    <result column="PID" property="pid"/>
    <result column="SITE_ID" property="siteId"/>
     <result column="theme_template_id" property="themeTemplateId"/>
  </resultMap>
  
   <resultMap id="abatorgenerated_CmsFilterTemplateResult" class="com.pltfm.cms.vobject.CmsTemplate" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    <result column="TEMPLATE_ID" property="templateId"/>
    <result column="NAME" property="name"/>
    <result column="THEME" property="theme"/>
    <result column="PATH" property="path"/>
    <result column="REMARK" property="remark"/>
    <result column="STATUS" property="status"/>
    <result column="CREATE_DATE" property="createDate"/>
    <result column="CREATED" property="created"/>
    <result column="MODIFY_DATE" property="modifyDate"/>
    <result column="MODIFIED" property="modified"/>
    <result column="TYPE" property="type"/>
    <result column="PID" property="pid"/>
    <result column="SITE_ID" property="siteId"/>
     <result column="flag_ID" property="flagId"/>
  </resultMap>
  <sql id="abatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="abatorgenerated_selectByPrimaryKey" resultMap="abatorgenerated_CmsTemplateResult" parameterClass="com.pltfm.cms.vobject.CmsTemplate" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    select TEMPLATE_ID, NAME, THEME, PATH, REMARK, STATUS, CREATE_DATE, CREATED, MODIFY_DATE,
      MODIFIED,TYPE,PID,SITE_ID
    from CMS_TEMPLATE
    where TEMPLATE_ID = #templateId#
  </select>
  <select id="abatorgenerated_selectByExample" resultMap="abatorgenerated_CmsTemplateResult" parameterClass="com.pltfm.cms.vobject.CmsTemplateExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    select TEMPLATE_ID, NAME, THEME, PATH, REMARK, STATUS, CREATE_DATE, CREATED, MODIFY_DATE,
      MODIFIED,TYPE,PID,SITE_ID
    from CMS_TEMPLATE
    <isParameterPresent >
      <include refid="CMS_TEMPLATE.abatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <delete id="abatorgenerated_deleteByPrimaryKey" parameterClass="com.pltfm.cms.vobject.CmsTemplate" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    delete from CMS_TEMPLATE
    where TEMPLATE_ID = #templateId#
  </delete>
  <delete id="abatorgenerated_deleteByExample" parameterClass="com.pltfm.cms.vobject.CmsTemplateExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    delete from CMS_TEMPLATE
    <include refid="CMS_TEMPLATE.abatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="abatorgenerated_insert" parameterClass="com.pltfm.cms.vobject.CmsTemplate" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    <selectKey resultClass="java.lang.Integer" keyProperty="templateId">
    	select SEQ_CMS_TEMPLATE.nextval from dual
    </selectKey>
    insert into CMS_TEMPLATE (TEMPLATE_ID, NAME, THEME, PATH, REMARK, STATUS, CREATE_DATE, CREATED,
      MODIFY_DATE, MODIFIED,TYPE,PID,SITE_ID)
    values (#templateId#, #name#, #theme#, #path#, #remark#,
      #status#, #createDate#, #created#, #modifyDate#, #modified#,
      #type#,#pid#,#siteId#)
  </insert>
  <update id="abatorgenerated_updateByPrimaryKey" parameterClass="com.pltfm.cms.vobject.CmsTemplate" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    update CMS_TEMPLATE
    set NAME = #name#,
      THEME = #theme#,
      PATH = #path#,
      REMARK = #remark#,
      STATUS = #status#,
      CREATE_DATE = #createDate#,
      CREATED = #created#,
      MODIFY_DATE =#modifyDate#,
      MODIFIED = #modified#,
      TYPE=#type#,
      PID=#pid#
    where TEMPLATE_ID = #templateId#
  </update>
  <update id="abatorgenerated_updateByPrimaryKeySelective" parameterClass="com.pltfm.cms.vobject.CmsTemplate" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    update CMS_TEMPLATE
    <dynamic prepend="set" >
      <isNotNull prepend="," property="name" >
        NAME = #name#
      </isNotNull>
      <isNotNull prepend="," property="theme" >
        THEME = #theme#
      </isNotNull>
      <isNotNull prepend="," property="path" >
        PATH = #path#
      </isNotNull>
      <isNotNull prepend="," property="remark" >
        REMARK = #remark#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS = #status#
      </isNotNull>
      <isNotNull prepend="," property="createDate" >
        CREATE_DATE = #createDate#
      </isNotNull>
      <isNotNull prepend="," property="created" >
        CREATED = #created#
      </isNotNull>
      <isNotNull prepend="," property="modifyDate" >
        MODIFY_DATE = #modifyDate#
      </isNotNull>
      <isNotNull prepend="," property="modified" >
        MODIFIED = #modified#
      </isNotNull>
    </dynamic>
    where TEMPLATE_ID = #templateId#
  </update>
  <select id="abatorgenerated_countByExample" parameterClass="com.pltfm.cms.vobject.CmsTemplateExample" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    select count(*) from CMS_TEMPLATE
    <include refid="CMS_TEMPLATE.abatorgenerated_Example_Where_Clause" />
  </select>
  <update id="abatorgenerated_updateByExampleSelective" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    update CMS_TEMPLATE
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.templateId" >
        TEMPLATE_ID = #record.templateId#
      </isNotNull>
      <isNotNull prepend="," property="record.name" >
        NAME = #record.name#
      </isNotNull>
      <isNotNull prepend="," property="record.theme" >
        THEME = #record.theme#
      </isNotNull>
      <isNotNull prepend="," property="record.path" >
        PATH = #record.path#
      </isNotNull>
      <isNotNull prepend="," property="record.remark" >
        REMARK = #record.remark#
      </isNotNull>
      <isNotNull prepend="," property="record.status" >
        STATUS = #record.status#
      </isNotNull>
      <isNotNull prepend="," property="record.createDate" >
        CREATE_DATE = #record.createDate#
      </isNotNull>
      <isNotNull prepend="," property="record.created" >
        CREATED = #record.created#
      </isNotNull>
      <isNotNull prepend="," property="record.modifyDate" >
        MODIFY_DATE = #record.modifyDate#
      </isNotNull>
      <isNotNull prepend="," property="record.modified" >
        MODIFIED = #record.modified#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="CMS_TEMPLATE.abatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="abatorgenerated_updateByExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Sep 03 08:56:27 CST 2013.
    -->
    update CMS_TEMPLATE
    set TEMPLATE_ID = #record.templateId#,
      NAME = #record.name#,
      THEME = #record.theme#,
      PATH = #record.path#,
      REMARK = #record.remark#,
      STATUS = #record.status#,
      CREATE_DATE = #record.createDate#,
      CREATED = #record.created#,
      MODIFY_DATE = #record.modifyDate#,
      MODIFIED = #record.modified#
    <isParameterPresent >
      <include refid="CMS_TEMPLATE.abatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <!-- 分页查询窗口数据列表信息 -->
    <select id="abatorgenerated_pageByTemplateData"  resultMap="abatorgenerated_CmsTemplateResult"  parameterClass="com.pltfm.cms.vobject.CmsTemplate">
    select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID from  (
                       select  ROW_NUMBER() OVER(order by TEMPLATE_ID desc) as view_row_number, tt.* FROM cms_template tt
			<dynamic prepend="where">
					<isNotNull property="templateId">
						<isNotEmpty prepend="and" property="templateId">
							TEMPLATE_ID = #templateId#
						</isNotEmpty>
					</isNotNull>
					<isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				     NAME like '%$name$%'
				      </isNotEmpty>
			       </isNotNull>
			       <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     TYPE = #type#
				      </isNotEmpty>
			       </isNotNull>
			       <isNull property="type">
			            <isEmpty prepend="and" property="type">
				     TYPE in (0,1,2,3,4,5,6,7,8,9,10,15,16)
				      </isEmpty>
			       </isNull>
			       <isNotNull property="status">
			       	<isNotEmpty prepend="and" property="status">
			       		STATUS = #status#
			       	</isNotEmpty>
			       </isNotNull>
				   <isNotNull property="theme">
				     <isNotEmpty prepend="and" property="theme">
				     THEME like '%$theme$%'
				      </isNotEmpty>
			       </isNotNull>
			       	<isNotEmpty property="siteId">
				    	<isNotNull prepend="and" property="siteId">
				    		SITE_ID= #siteId#
				    	</isNotNull>
				    </isNotEmpty>
			</dynamic>
              ) 
         <![CDATA[ where view_row_number <= #endIndex# and view_row_number > #startIndex# ]]>
    </select>
    
     <!-- 分页查询变量模板列表信息 -->
    <select id="abatorgenerated_queryVarTemplateList"  resultMap="abatorgenerated_CmsTemplateResult"  parameterClass="com.pltfm.cms.vobject.CmsTemplate">
    select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID from  (
                       select  ROW_NUMBER() OVER(order by TEMPLATE_ID desc) as view_row_number, tt.* FROM cms_template tt
			<dynamic prepend="where">
					<isNotNull property="templateId">
						<isNotEmpty prepend="and" property="templateId">
							TEMPLATE_ID = #templateId#
						</isNotEmpty>
					</isNotNull>
					<isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				     NAME like '%$name$%'
				      </isNotEmpty>
			       </isNotNull>
			       <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     TYPE = #type#
				      </isNotEmpty>
			       </isNotNull>
			       <isNull property="type">
			            <isEmpty prepend="and" property="type">
				     TYPE in (13,12)
				      </isEmpty>
			       </isNull>
			       <isNotNull property="status">
			       	<isNotEmpty prepend="and" property="status">
			       		STATUS = #status#
			       	</isNotEmpty>
			       </isNotNull>
				   <isNotNull property="theme">
				     <isNotEmpty prepend="and" property="theme">
				     THEME like '%$theme$%'
				      </isNotEmpty>
			       </isNotNull>
			       	<isNotEmpty property="siteId">
				    	<isNotNull prepend="and" property="siteId">
				    		SITE_ID= #siteId#
				    	</isNotNull>
				    </isNotEmpty>
			</dynamic>
              ) 
         <![CDATA[ where view_row_number <= #endIndex# and view_row_number > #startIndex# ]]>
    </select>
    <!--  查询 列表总数-->
  <select id="abatorgenerated_countByTemplate" parameterClass="com.pltfm.cms.vobject.CmsTemplate" resultClass="java.lang.Integer" >
	select count(*) from  CMS_TEMPLATE 
		 <dynamic prepend="where">
		 		<isNotNull property="templateId">
						<isNotEmpty prepend="and" property="templateId">
							TEMPLATE_ID = #templateId#
						</isNotEmpty>
					</isNotNull>
	          <isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				     NAME like '%$name$%'
				      </isNotEmpty>
			  </isNotNull>
			  <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     TYPE = #type#
				      </isNotEmpty>
			       </isNotNull>
			          <isNull property="type">
			            <isEmpty prepend="and" property="type">
				     TYPE in (0,1,2,3,4,5,6,7,8,9,10,15,16)
				      </isEmpty>
			       </isNull>
			       <isNotNull property="status">
			       	<isNotEmpty prepend="and" property="status">
			       		STATUS = #status#
			       	</isNotEmpty>
			       </isNotNull>
			       <isNotNull property="theme">
				     <isNotEmpty prepend="and" property="theme">
				     THEME like '%$theme$%'
				      </isNotEmpty>
			       </isNotNull>
			       	<isNotEmpty property="siteId">
				    		<isNotNull prepend="and" property="siteId">
				    			SITE_ID= #siteId#
				    			
				    		</isNotNull>
				    	</isNotEmpty>
		</dynamic>
  </select>
  
     <!--  查询 列表总数-->
  <select id="abatorgenerated_queryVarTemplateCounts" parameterClass="com.pltfm.cms.vobject.CmsTemplate" resultClass="java.lang.Integer" >
	select count(*) from  CMS_TEMPLATE 
		 <dynamic prepend="where">
		 		
	          <isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				     NAME like '%$name$%'
				      </isNotEmpty>
			  </isNotNull>
			  <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     TYPE = #type#
				      </isNotEmpty>
			       </isNotNull>
			          <isNull property="type">
			            <isEmpty prepend="and" property="type">
				     TYPE in (13,12)
				      </isEmpty>
			       </isNull>
			       <isNotNull property="status">
			       	<isNotEmpty prepend="and" property="status">
			       		STATUS = #status#
			       	</isNotEmpty>
			       </isNotNull>
			       <isNotNull property="theme">
				     <isNotEmpty prepend="and" property="theme">
				     THEME like '%$theme$%'
				      </isNotEmpty>
			       </isNotNull>
			       	<isNotEmpty property="siteId">
				    		<isNotNull prepend="and" property="siteId">
				    			SITE_ID= #siteId#
				    			
				    		</isNotNull>
				    	</isNotEmpty>
		</dynamic>
  </select>
  
   <!-- 查询模版列表（过滤已绑定数据）-->
    <select id="abatorgenerated_queryTemplateFilterBandTheme"  resultMap="abatorgenerated_CmsThemeTemplateResult"  parameterClass="com.pltfm.cms.vobject.CmsTemplate">
    select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID,theme_template_id from  (
                       select  ROW_NUMBER() OVER(order by tt.TEMPLATE_ID desc) as view_row_number, tt.*,ctt.theme_template_id FROM cms_template tt ,
             cms_theme_template ctt  where tt.template_id=ctt.template_id(+)   
			
					<isNotNull property="templateId">
						<isNotEmpty prepend="and" property="templateId">
							tt.TEMPLATE_ID = #templateId#
						</isNotEmpty>
					</isNotNull>
					<isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				     tt.NAME like '%$name$%'
				      </isNotEmpty>
			       </isNotNull>
			       <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     tt.TYPE = #type#
				      </isNotEmpty>
			       </isNotNull>
			        <isNull property="type">
			            <isEmpty prepend="and" property="type">
				     tt.TYPE in (13,12)
				      </isEmpty>
			       </isNull>
			       	<isNotEmpty property="siteId">
				    	<isNotNull prepend="and" property="siteId">
				    		tt.SITE_ID= #siteId#
				    	</isNotNull>
				    </isNotEmpty>
				    
				      	<isNotEmpty property="themeId">
				    	<isNotNull prepend="and" property="themeId">
				    		ctt.theme_id(+)= #themeId#
				    	</isNotNull>
				    </isNotEmpty>
			
              ) 
         <![CDATA[ where view_row_number <= #endIndex# and view_row_number > #startIndex# ]]>
    </select>
    
    
    
      <!-- 查询绑定变量模版列表（过滤已绑定数据）-->
    <select id="abatorgenerated_queryTemplateFilterBandWindow"  resultMap="abatorgenerated_CmsFilterTemplateResult"  parameterClass="com.pltfm.cms.vobject.CmsTemplate">
    select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID,relation_id as flag_Id from  (
                       select  ROW_NUMBER() OVER(order by relation_id desc) as view_row_number, tt.*,ctt.relation_id FROM cms_template tt ,
             cms_template_relation ctt  where tt.template_id=ctt.template_id(+)   
			
					<isNotNull property="templateId">
						<isNotEmpty prepend="and" property="templateId">
							ctt.p_template_id(+) = #templateId#
						</isNotEmpty>
					</isNotNull>
					<isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				     tt.NAME like '%$name$%'
				      </isNotEmpty>
			       </isNotNull>
			       <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     tt.TYPE = #type#
				      </isNotEmpty>
			       </isNotNull>
			        <isNull property="type">
			            <isEmpty prepend="and" property="type">
				     tt.TYPE in (13,12)
				      </isEmpty>
			       </isNull>
			       	<isNotEmpty property="siteId">
				    	<isNotNull prepend="and" property="siteId">
				    		tt.SITE_ID= #siteId#
				    	</isNotNull>
				    </isNotEmpty>
				    
				    
			
              ) 
         <![CDATA[ where view_row_number <= #endIndex# and view_row_number > #startIndex# ]]>
    </select>
    
    
     <!--  查询绑定变量模版列表总数-->
  <select id="abatorgenerated_queryTemplateFilterBandWindowCounts" parameterClass="com.pltfm.cms.vobject.CmsTemplate" resultClass="java.lang.Integer" >
	select count(*)   FROM cms_template tt ,
             cms_template_relation ctt  where tt.template_id=ctt.template_id
		
		 		<isNotNull property="templateId">
						<isNotEmpty prepend="and" property="templateId">
							ctt.p_template_id = #templateId#
						</isNotEmpty>
					</isNotNull>
					<isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				     tt.NAME like '%$name$%'
				      </isNotEmpty>
			       </isNotNull>
			       <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     tt.TYPE = #type#
				      </isNotEmpty>
			       </isNotNull>
			        <isNull property="type">
			            <isEmpty prepend="and" property="type">
				     tt.TYPE in (13,12)
				      </isEmpty>
			       </isNull>
			       	<isNotEmpty property="siteId">
				    	<isNotNull prepend="and" property="siteId">
				    		tt.SITE_ID= #siteId#
				    	</isNotNull>
				    </isNotEmpty>
		
  </select>
  
    
     
      <!-- 查询已绑定窗口-->
    <select id="abatorgenerated_queryBandWindowList"  resultMap="abatorgenerated_CmsFilterTemplateResult"  parameterClass="com.pltfm.cms.vobject.CmsTemplate">
    select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID,relation_id as flag_id from  (
                 
			
	select tt.*, ROW_NUMBER() OVER(order by relation_id desc) as view_row_number,t.relation_id  from CMS_TEMPLATE_RELATION t ,cms_template tt where t.template_id=tt.template_id  		
					<isNotNull property="templateId">
						<isNotEmpty prepend="and" property="templateId">
							t.p_template_id = #templateId#
						</isNotEmpty>
					</isNotNull> 
			
              ) 
         <![CDATA[ where view_row_number <= #endIndex# and view_row_number > #startIndex# ]]>
    </select>
    
       <!--  查询 列表总数-->
  <select id="abatorgenerated_queryBandWindowCounts" parameterClass="com.pltfm.cms.vobject.CmsTemplate" resultClass="java.lang.Integer" >
	select count(*) from  CMS_TEMPLATE_RELATION 
		 <dynamic prepend="where">
		 		<isNotNull property="templateId">
						<isNotEmpty prepend="and" property="templateId">
							p_template_id = #templateId#
						</isNotEmpty>
					</isNotNull> 
		</dynamic>
</select>
    
  <select id="abatorgenerated_countByTemplateName" parameterClass="java.lang.String" resultMap="abatorgenerated_CmsTemplateResult">
  	select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID
  		from CMS_TEMPLATE where NAME=#name#
  </select>
  <!-- 根据条件in查询-->
   <select id="abatorgenerated_querySeletedTemplateList" parameterClass="java.lang.String" resultMap="abatorgenerated_CmsTemplateResult">
  	select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID
  		from CMS_TEMPLATE where $value$
  </select>
  
  <!-- 根据pid和name查询 -->
  <select id="abatorgenerated_selectByPidAndName" parameterClass="com.pltfm.cms.vobject.CmsTemplate" resultMap="abatorgenerated_CmsTemplateResult">
  	select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID
  		from CMS_TEMPLATE
  		 <dynamic prepend="where">
				<isNotNull property="name">
				     <isNotEmpty prepend="and" property="name">
				    	NAME=#name#
				     </isNotEmpty>
			    </isNotNull>
				<isNotNull property="pid">
				     <isNotEmpty prepend="and" property="pid">
				     	PID=#pid#
				     </isNotEmpty>
			    </isNotNull>	
			    <isNotNull property="path">
				     <isNotEmpty prepend="and" property="path">
				     	PATH like '$path$%'
				     </isNotEmpty>
			    </isNotNull>
			    <isNotNull property="siteId">
				     <isNotEmpty prepend="and" property="siteId">
				     	SITE_ID =#siteId#
				     </isNotEmpty>
			    </isNotNull>
			     <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     	TYPE = #type#
				     </isNotEmpty>
			    </isNotNull>
		</dynamic>
  </select>
  <!-- 更新对象，主要为replace对象的path -->
  <update id="abatorgenerated_updateAllPath" parameterClass="com.pltfm.cms.vobject.CmsTemplate" >
    update CMS_TEMPLATE set 
    	MODIFY_DATE =#modifyDate#,
      	MODIFIED = #modified#,
    	PATH = replace(PATH,#path#,#name#) 
    		where TEMPLATE_ID = #templateId#
  </update>
  <!-- 删除以某种形式路径开始的对象 -->
  <delete id="abatorgenerated_deleteByPath" parameterClass="com.pltfm.cms.vobject.CmsTemplate" >
    delete from CMS_TEMPLATE where PATH like '$path$%'
  </delete>
  <select id="abatorgenerated_selectBySiteIdType" resultMap="abatorgenerated_CmsTemplateResult" parameterClass="com.pltfm.cms.vobject.CmsTemplate">
       	select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID
  		from CMS_TEMPLATE
  		 <dynamic prepend="where">
			    <isNotNull property="type">
				     <isNotEmpty prepend="and" property="type">
				     	TYPE = #type#
				     </isNotEmpty>
			    </isNotNull>
			    <isNotNull property="siteId">
				     <isNotEmpty prepend="and" property="siteId">
				     	SITE_ID =#siteId#
				     </isNotEmpty>
			    </isNotNull>
		</dynamic>
		 order by template_id
  </select>
  
   <!-- 分页列表信息 -->
   <select id="abatorgenerated_themeTempList" resultMap="abatorgenerated_CmsTemplateResult"  parameterClass="com.pltfm.cms.vobject.CmsThemeTemplate">
          select TEMPLATE_ID,NAME,THEME,PATH,REMARK,STATUS,CREATE_DATE,CREATED,MODIFY_DATE,MODIFIED,TYPE,PID,SITE_ID  
       from
            (
               select  ROW_NUMBER() OVER(order by RELATION_ID ) as view_row_number, tt.* FROM cms_template_relation tt               
                 <dynamic prepend="where">
				     
				     	  <isNotNull property="templateId">
							  <isNotEmpty prepend="and" property="TEMPLATE_ID">
								tt.P_TEMPLATE_ID = #templateId#
							  </isNotEmpty>
						  </isNotNull>
						  
				</dynamic>
						  
				   ) ctt ,cms_template ct where ct.type=0 and ctt.template_id=ct.template_id                    
                                                                 	
              
         <![CDATA[ and view_row_number <= #endIndex# and view_row_number > #startIndex# ]]>
    </select>
  
     <!-- 通过窗口数据总条数 -->
  <select id="abatorgenerated_themeTempCount" parameterClass="com.pltfm.cms.vobject.CmsThemeTemplate" resultClass="java.lang.Integer" >
	select count(*) from  cms_template_relation tt
		   <dynamic prepend="where">
				     		  <isNotNull property="templateId">
							  <isNotEmpty prepend="and" property="TEMPLATE_ID">
								tt.P_TEMPLATE_ID = #templateId#
							  </isNotEmpty>
						  </isNotNull>
						   
						 
					</dynamic>
	</select>
</sqlMap>