<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="CMS_LOG">
	<resultMap id="ibatorgenerated_BaseResultMap" class="com.pltfm.cms.vobject.CmsLog">
		<!--
			WARNING - This element is automatically generated by Apache iBATIS
			ibator, do not modify. This element was generated on Mon Oct 28
			17:24:43 CST 2013.
		-->
		<result column="CMS_LOG_ID" property="cmsLogId" jdbcType="Integer" />
		<result column="MODULE_NAME" property="moduleName" jdbcType="VARCHAR" />
		<result column="MODULE_CONTENT" property="moduleContent"
			jdbcType="VARCHAR" />
		<result column="CHANGE_RECORD" property="changeRecord"
			jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="Integer" />
		<result column="CONSOLE_OPERATOR" property="consoleOperator"
			jdbcType="Integer" />
		<result column="CONSOLE_OPERATOR_DATE" property="consoleOperatorDate"
			/>
	</resultMap>

	<resultMap id="ibatorgenerated_BaseResultMapRus" class="com.pltfm.cms.vobject.CmsLog">
		<result column="USER_NAME" property="userName" jdbcType="VARCHAR" />
		<result column="CMS_LOG_ID" property="cmsLogId" jdbcType="Integer" />
		<result column="MODULE_NAME" property="moduleName" jdbcType="VARCHAR" />
		<result column="MODULE_CONTENT" property="moduleContent"
			jdbcType="VARCHAR" />
		<result column="CHANGE_RECORD" property="changeRecord"
			jdbcType="VARCHAR" />
		<result column="TYPE" property="type" jdbcType="Integer" />
		<result column="CONSOLE_OPERATOR" property="consoleOperator"
			jdbcType="Integer" />
		<result column="CONSOLE_OPERATOR_DATE" property="consoleOperatorDate"
			 />
		
	</resultMap>


	<select id="ibatorgenerated_select" resultMap="ibatorgenerated_BaseResultMapRus"
		parameterClass="com.pltfm.cms.vobject.CmsLog">
		<!--
			WARNING - This element is automatically generated by Apache iBATIS
			ibator, do not modify. This element was generated on Mon Oct 28
			17:24:43 CST 2013.
		-->
		select CMS_LOG_ID, MODULE_NAME, MODULE_CONTENT, CHANGE_RECORD, TYPE,
		CONSOLE_OPERATOR,CONSOLE_OPERATOR_DATE,USER_NAME
		from cms_log l,sys_user u
		WHERE l.consoleOperator =u.user_id and CMS_LOG_ID = #cmsLogId:DECIMAL#
	</select>

	<delete id="ibatorgenerated_delete" parameterClass="com.pltfm.cms.vobject.CmsLog">
		<!--
			WARNING - This element is automatically generated by Apache iBATIS
			ibator, do not modify. This element was generated on Mon Oct 28
			17:24:43 CST 2013.
		-->
		delete from CMS_LOG
		where CMS_LOG_ID = #cmsLogId:Integer#
	</delete>

	<insert id="ibatorgenerated_insert" parameterClass="com.pltfm.cms.vobject.CmsLog">
		<selectKey resultClass="java.lang.Integer" keyProperty="cmsLogId">
			select seq_app_cms.nextval from dual
      </selectKey>
		insert into CMS_LOG
		<dynamic prepend="(">
			<isNotNull prepend="," property="cmsLogId">
				CMS_LOG_ID
      </isNotNull>
			<isNotNull prepend="," property="moduleName">
				MODULE_NAME
      </isNotNull>
			<isNotNull prepend="," property="moduleContent">
				MODULE_CONTENT
      </isNotNull>
			<isNotNull prepend="," property="changeRecord">
				CHANGE_RECORD
      </isNotNull>
			<isNotNull prepend="," property="type">
				TYPE
      </isNotNull>
			<isNotNull prepend="," property="consoleOperator">
				CONSOLE_OPERATOR
      </isNotNull>
			<isNotNull prepend="," property="consoleOperatorDate">
				CONSOLE_OPERATOR_DATE
      </isNotNull>
			)
		</dynamic>
		values
		<dynamic prepend="(">
			<isNotNull prepend="," property="cmsLogId">
				#cmsLogId:Integer#
      </isNotNull>
			<isNotNull prepend="," property="moduleName">
				#moduleName:VARCHAR#
      </isNotNull>
			<isNotNull prepend="," property="moduleContent">
				#moduleContent:VARCHAR#
      </isNotNull>
			<isNotNull prepend="," property="changeRecord">
				#changeRecord:VARCHAR#
      </isNotNull>
			<isNotNull prepend="," property="type">
				#type:Integer#
      </isNotNull>
			<isNotNull prepend="," property="consoleOperator">
				#consoleOperator:Integer#
      </isNotNull>
			<isNotNull prepend="," property="consoleOperatorDate">
				#consoleOperatorDate:DATE#
      </isNotNull>
			)
		</dynamic>
	</insert>


	<select id="selectCountByVo" parameterClass="com.pltfm.cms.vobject.CmsLog"
		resultClass="java.lang.Integer">
		select count(*) from cms_log l,sys_user u
		WHERE l.console_operator =u.user_id
		<isNotNull property="userName">
			<isNotEmpty prepend="and" property="userName">
				u.user_name like '%'||#userName#||'%'
			  </isNotEmpty>
		</isNotNull>

		<isNotNull property="moduleName">
			<isNotEmpty prepend="and" property="moduleName">
				l.MODULE_NAME like '%'||#moduleName#||'%'
			  </isNotEmpty>
		</isNotNull>

		<isNotNull property="consoleOperatorDate">
			<isNotEmpty prepend="and" property="consoleOperatorDate">
				    <![CDATA[   l.console_operator_date  >= #consoleOperatorDate#]]>
			</isNotEmpty>
		</isNotNull>

		<isNotNull property="endDate">
			<isNotEmpty prepend="and" property="endDate">
				     <![CDATA[   l.console_operator_date  <= #endDate#]]>
			</isNotEmpty>
		</isNotNull>

	</select>
	<!--  ****************  search page by vo  ****************  -->
	<select id="searchPageByVo" resultMap="ibatorgenerated_BaseResultMapRus"
		parameterClass="com.pltfm.cms.vobject.CmsLog">
		select CMS_LOG_ID, MODULE_NAME, MODULE_CONTENT, CHANGE_RECORD, TYPE,
		CONSOLE_OPERATOR,CONSOLE_OPERATOR_DATE,USER_NAME
		FROM (
		select ROW_NUMBER() OVER(order by CMS_LOG_ID desc) as view_row_number,
		l.*,u.user_name as USER_NAME from cms_log l,sys_user u
		WHERE l.console_operator =u.user_id
			<isNotNull property="userName">
			<isNotEmpty prepend="and" property="userName">
				u.user_name like '%'||#userName#||'%'
			  </isNotEmpty>
		</isNotNull>

		<isNotNull property="moduleName">
			<isNotEmpty prepend="and" property="moduleName">
				l.MODULE_NAME like '%'||#moduleName#||'%'
			  </isNotEmpty>
		</isNotNull>
		
		<isNotNull property="consoleOperatorDate">
			<isNotEmpty prepend="and" property="consoleOperatorDate">
				    <![CDATA[   l.console_operator_date  >= #consoleOperatorDate#]]>
			</isNotEmpty>
		</isNotNull>

		<isNotNull property="endDate">
			<isNotEmpty prepend="and" property="endDate">
				     <![CDATA[   l.console_operator_date  <= #endDate#]]>
			</isNotEmpty>
		</isNotNull>

		)
  <![CDATA[ where view_row_number <= #endIndex# and view_row_number > #startIndex# ]]>
	</select>
</sqlMap>