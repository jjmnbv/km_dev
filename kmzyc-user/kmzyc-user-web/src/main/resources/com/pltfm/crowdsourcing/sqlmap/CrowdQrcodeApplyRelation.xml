<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="CrowdQrcodeApplyRelation" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="com.km.crowdsourcing.model.QrcodeApplyRelation" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Mar 14 14:41:35 CST 2016.
    -->
    <result column="ID" property="id" jdbcType="DECIMAL" />
    <result column="INSTITUTION_CODE" property="institutionCode" jdbcType="VARCHAR" />
    <result column="INSTITUTION_CODE_APPLY_ID" property="institutionCodeApplyId" jdbcType="DECIMAL" />
  </resultMap>
  
  <select id="selectByRelation"  resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.km.crowdsourcing.model.QrcodeApplyRelation">
  	select ID, INSTITUTION_CODE, INSTITUTION_CODE_APPLY_ID
    from CROWD_QRCODE_APPLY_RELATION WHERE 1=1
    <isNotEmpty property="id">
    	AND ID=#id:DECIMAL#
    </isNotEmpty>
    <isNotEmpty property="institutionCode">
    	AND INSTITUTION_CODE=#institutionCode:VARCHAR#
    </isNotEmpty>
    <isNotEmpty property="institutionCodeApplyId">
    	AND INSTITUTION_CODE_APPLY_ID=#institutionCodeApplyId:DECIMAL#
    </isNotEmpty>
  </select>
  
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.km.crowdsourcing.model.QrcodeApplyRelation" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Mar 14 14:41:35 CST 2016.
    -->
    select ID, INSTITUTION_CODE, INSTITUTION_CODE_APPLY_ID
    from CROWD_QRCODE_APPLY_RELATION
    where ID = #id:DECIMAL#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.km.crowdsourcing.model.QrcodeApplyRelation" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Mar 14 14:41:35 CST 2016.
    -->
    delete from CROWD_QRCODE_APPLY_RELATION
    where ID = #id:DECIMAL#
  </delete>
  
  <insert id="ibatorgenerated_insert" parameterClass="com.km.crowdsourcing.model.QrcodeApplyRelation" >
    <selectKey resultClass="java.lang.Integer" keyProperty="id">
	   		select SEQ_CR_QR_APP_RELATION.nextval from dual
	   </selectKey>
    insert into CROWD_QRCODE_APPLY_RELATION (ID, INSTITUTION_CODE, INSTITUTION_CODE_APPLY_ID)
    values (#id:DECIMAL#, #institutionCode:VARCHAR#, #institutionCodeApplyId:DECIMAL#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.km.crowdsourcing.model.QrcodeApplyRelation" >
    <selectKey resultClass="java.lang.Integer" keyProperty="id">
	   		select SEQ_CR_QR_APP_RELATION.nextval from dual
	   </selectKey>
    insert into CROWD_QRCODE_APPLY_RELATION
    <dynamic prepend="(" >
      <isNotNull prepend="," property="id" >
        ID
      </isNotNull>
      <isNotNull prepend="," property="institutionCode" >
        INSTITUTION_CODE
      </isNotNull>
      <isNotNull prepend="," property="institutionCodeApplyId" >
        INSTITUTION_CODE_APPLY_ID
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="id" >
        #id:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="institutionCode" >
        #institutionCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="institutionCodeApplyId" >
        #institutionCodeApplyId:DECIMAL#
      </isNotNull>
      )
    </dynamic>
  </insert>
  
  
  
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.km.crowdsourcing.model.QrcodeApplyRelation" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Mar 14 14:41:35 CST 2016.
    -->
    update CROWD_QRCODE_APPLY_RELATION
    <dynamic prepend="set" >
      <isNotNull prepend="," property="institutionCode" >
        INSTITUTION_CODE = #institutionCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="institutionCodeApplyId" >
        INSTITUTION_CODE_APPLY_ID = #institutionCodeApplyId:DECIMAL#
      </isNotNull>
    </dynamic>
    where ID = #id:DECIMAL#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.km.crowdsourcing.model.QrcodeApplyRelation" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Mar 14 14:41:35 CST 2016.
    -->
    update CROWD_QRCODE_APPLY_RELATION
    set INSTITUTION_CODE = #institutionCode:VARCHAR#,
      INSTITUTION_CODE_APPLY_ID = #institutionCodeApplyId:DECIMAL#
    where ID = #id:DECIMAL#
  </update>
  
  <insert id="bathInsertRelations" parameterClass="java.util.List">
  	<!-- 
  	  批量插入二维码与地退人员关系表，此处生成的机构码暂时为KM+五位数字
  	  F_GET_CLOUD_PRODUCT_GRANT_ID为获取机构码地推人员关系表主键id（递增）
  	  F_GET_CR_QR_CODE_ID为获取机构码表主键id（递增）
  	 -->
  		INSERT ALL 
  		<iterate >
  			 INTO CROWD_QRCODE_APPLY_RELATION VALUES(F_GET_CR_QR_APP_RELATION_ID,'KM'||F_GET_CR_QR_CODE_ID,#list[]#)
  		</iterate>
  		SELECT 1 FROM DUAL
  </insert>
</sqlMap>