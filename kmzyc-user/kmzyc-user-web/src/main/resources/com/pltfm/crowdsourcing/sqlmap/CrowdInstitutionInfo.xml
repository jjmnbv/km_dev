<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="CrowdInstitutionInfo">
	<resultMap id="ibatorgenerated_BaseResultMap" class="com.km.crowdsourcing.model.InstitutionInfo">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="INSTITUTION_CODE" property="institutionCode"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_NAME" property="institutionName"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_ADDRESS" property="institutionAddress"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_CONTACTOR" property="institutionContactor"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_PHONENUMBER" property="institutionPhonenumber"
			jdbcType="VARCHAR" />
		<result column="REGIST_REBATE" property="registRebate"
			jdbcType="DECIMAL" />
		<result column="SPREAD_START_DATE" property="spreadStartDate" />
		<result column="SPREAD_END_DATE" property="spreadEndDate" />
		<result column="ACT_STATE" property="actState" jdbcType="DECIMAL" />
		<result column="IMAGE_URL" property="imageUrl" jdbcType="VARCHAR" />
		<result column="AUDITOR_LOGINID" property="auditorLoginId"
			jdbcType="DECIMAL" />
		<result column="AUDITOR_NAME" property="auditorName" jdbcType="VARCHAR" />
		<result column="AUDITE_DATE" property="auditeDate" />
		<result column="AUDITE_MEMO" property="auditeMemo" jdbcType="VARCHAR" />
		<result column="AUDITE_STATE" property="auditeState" jdbcType="DECIMAL" />
		<result column="BAGMAN_ID" property="bagmanId" jdbcType="DECIMAL" />
		<result column="PASSWORD" property="password" jdbcType="VARCHAR" />
		<result column="APPLY_TYPE" property="applyType" jdbcType="DECIMAL" />
		<result column="CREATE_DATE" property="createDate" />
		<result column="LOGINID" property="loginId" jdbcType="DECIMAL" />
		<result column="referrerNum" property="referrerNum" jdbcType="DECIMAL" />
		<result column="mobile" property="mobile" jdbcType="VARCHAR" />
		<result column="STATUS" property="status" jdbcType="DECIMAL" />

	</resultMap>
	<resultMap id="ibatorgenerated_BaseResultMap_new" class="com.km.crowdsourcing.model.InstitutionInfo">
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="INSTITUTION_CODE" property="institutionCode"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_NAME" property="institutionName"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_ADDRESS" property="institutionAddress"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_CONTACTOR" property="institutionContactor"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_PHONENUMBER" property="institutionPhonenumber"
			jdbcType="VARCHAR" />
		<result column="REGIST_REBATE" property="registRebate"
			jdbcType="DECIMAL" />
		<result column="SPREAD_START_DATE" property="spreadStartDate"
			jdbcType="DATE" />
		<result column="SPREAD_END_DATE" property="spreadEndDate"
			jdbcType="DATE" />
		<result column="ACT_STATE" property="actState" jdbcType="DECIMAL" />
		<result column="IMAGE_URL" property="imageUrl" jdbcType="VARCHAR" />
		<result column="AUDITOR_LOGINID" property="auditorLoginId"
			jdbcType="DECIMAL" />
		<result column="AUDITOR_NAME" property="auditorName" jdbcType="VARCHAR" />
		<result column="AUDITE_DATE" property="auditeDate" jdbcType="DATE" />
		<result column="AUDITE_MEMO" property="auditeMemo" jdbcType="VARCHAR" />
		<result column="AUDITE_STATE" property="auditeState" jdbcType="DECIMAL" />
		<result column="BAGMAN_ID" property="bagmanId" jdbcType="DECIMAL" />
		<result column="PASSWORD" property="password" jdbcType="VARCHAR" />
		<result column="APPLY_TYPE" property="applyType" jdbcType="DECIMAL" />
		<result column="CREATE_DATE" property="createDate" jdbcType="DATE" />
		<result column="LOGINID" property="loginId" jdbcType="DECIMAL" />
	</resultMap>
	<resultMap id="ibatorgenerated_BaseResultMap_list" class="com.km.crowdsourcing.model.InstitutionInfo"
		extends="ibatorgenerated_BaseResultMap">
		<result column="bagmanName" property="bagmanName" jdbcType="VARCHAR" />
		<result column="referrerSum" property="referrerSum" jdbcType="DECIMAL" />
	</resultMap>
	<resultMap id="ibatorgenerated_BaseResultMap_update" class="com.km.crowdsourcing.model.InstitutionInfo"
		extends="ibatorgenerated_BaseResultMap">
		<result column="name" property="bagmanName" jdbcType="VARCHAR" />
		<result column="STATUS" property="status" jdbcType="DECIMAL" />
		<result column="BANK_ACCOUNT" property="bankAccount" jdbcType="VARCHAR" />
		<result column="BANK_NAME" property="bankName" jdbcType="VARCHAR" />
		<result column="BANK_UNAME" property="bankUname" jdbcType="VARCHAR" />
		<result column="referrerSum" property="referrerSum" jdbcType="DECIMAL" />
	</resultMap>

	<resultMap id="ibatorgenerated_BaseResultMapPrimaryKey"
		class="com.km.crowdsourcing.model.InstitutionInfo">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="INSTITUTION_CODE" property="institutionCode"
			jdbcType="VARCHAR" />
		<result column="INSTITUTION_NAME" property="institutionName"
			jdbcType="VARCHAR" />
		<result column="ACT_STATE" property="actState" jdbcType="DECIMAL" />
		<result column="SPREAD_START_DATE" property="spreadStartDate"
			jdbcType="DATE" />
		<result column="SPREAD_END_DATE" property="spreadEndDate"
			jdbcType="DATE" />
		<result column="LOGINID" property="loginId" jdbcType="DECIMAL" />
		<result column="BANK_ACCOUNT" property="bankAccount" jdbcType="VARCHAR" />
		<result column="BANK_NAME" property="bankName" jdbcType="VARCHAR" />
		<result column="BANK_UNAME" property="bankUname" jdbcType="VARCHAR" />
		<result column="status" property="status" jdbcType="DECIMAL" />
		<result column="REGIST_REBATE" property="registRebate"
			jdbcType="DECIMAL" />
	</resultMap>

	<select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMapPrimaryKey"
		parameterClass="com.km.crowdsourcing.model.InstitutionInfo">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
		select ID,
		INSTITUTION_CODE,
		INSTITUTION_NAME,
		ACT_STATE,
		SPREAD_START_DATE,
		SPREAD_END_DATE,
		LOGINID,
		BANK_ACCOUNT,
		BANK_NAME,
		BANK_UNAME,
		STATUS,
		REGIST_REBATE
		from CROWD_INSTITUTION_INFO where
		LOGINID =
		#loginId:DECIMAL#
	</select>
	<select id="ibatorgenerated_selectById" resultMap="ibatorgenerated_BaseResultMap_update"
		parameterClass="java.lang.Long">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
		select
		(select count(1) from crowd_institution_user ciu where
		ciu.INSTITUTION_CODE=cii.INSTITUTION_CODE) as referrerNum,
		(select
		sum(CLEARING_AMOUNT) from
		crowd_institution_user ciu where
		ciu.INSTITUTION_CODE=cii.INSTITUTION_CODE and ciu.clearing_status=1) as referrerSum,
		csb.NAME,
		cii.ID,
		cii.INSTITUTION_CODE,
		cii.INSTITUTION_NAME,
		cii.INSTITUTION_ADDRESS,
		cii.INSTITUTION_CONTACTOR,
		cii.INSTITUTION_PHONENUMBER,
		cii.REGIST_REBATE,
		cii.SPREAD_START_DATE,
		cii.SPREAD_END_DATE,
		cii.ACT_STATE,
		cii.IMAGE_URL,
		cii.AUDITOR_LOGINID,
		cii.AUDITOR_NAME,
		cii.AUDITE_DATE, cii.AUDITE_MEMO,
		cii.AUDITE_STATE,
		cii.BAGMAN_ID,
		cii.PASSWORD, cii.APPLY_TYPE,
		cii.CREATE_DATE,
		cii.BANK_ACCOUNT,
		cii.BANK_NAME,
		cii.BANK_UNAME,
		cii.LOGINID,
		nvl(cii.STATUS,0) as STATUS,
		l.mobile
		from
		CROWD_INSTITUTION_INFO cii,
		crowd_sourcing_bagman csb
		,login_info l
		where cii.ID = #id:DECIMAL# and
		cii.BAGMAN_ID=csb.id and
		cii.LOGINID = l.n_login_id
	</select>
	<select id="ibatorgenerated_selectByInstitutionCodeOrName"
		resultMap="ibatorgenerated_BaseResultMap_new" parameterClass="com.km.crowdsourcing.model.InstitutionApplyRecord">
		<![CDATA[
		select ID,
		INSTITUTION_CODE, INSTITUTION_NAME, INSTITUTION_ADDRESS,
		INSTITUTION_CONTACTOR,
		INSTITUTION_PHONENUMBER, REGIST_REBATE,
		SPREAD_START_DATE, SPREAD_END_DATE, ACT_STATE,
		IMAGE_URL,
		AUDITOR_LOGINID, AUDITOR_NAME, AUDITE_DATE, AUDITE_MEMO,
		AUDITE_STATE,
		BAGMAN_ID,
		PASSWORD, APPLY_TYPE, CREATE_DATE,LOGINID
		from
		CROWD_INSTITUTION_INFO
		where (INSTITUTION_CODE =
		#institutionCode:VARCHAR#
		or INSTITUTION_NAME
		=
		#institutionName:VARCHAR#)
		and rownum <= 1
		 ]]>
	</select>

	<select id="ibatorgenerated_selectByInstitutionName" resultMap="ibatorgenerated_BaseResultMap_new"
		parameterClass="com.km.crowdsourcing.model.InstitutionApplyRecord">
		<![CDATA[
		select ID,
		INSTITUTION_CODE, INSTITUTION_NAME, INSTITUTION_ADDRESS,
		INSTITUTION_CONTACTOR,
		INSTITUTION_PHONENUMBER, REGIST_REBATE,
		SPREAD_START_DATE, SPREAD_END_DATE, ACT_STATE,
		IMAGE_URL,
		AUDITOR_LOGINID, AUDITOR_NAME, AUDITE_DATE, AUDITE_MEMO,
		AUDITE_STATE,
		BAGMAN_ID,
		PASSWORD, APPLY_TYPE, CREATE_DATE,LOGINID
		from
		CROWD_INSTITUTION_INFO
		where 
		UPPER(INSTITUTION_NAME) = UPPER(#institutionName:VARCHAR#)
		and rownum <= 1
		 ]]>
	</select>

	<select id="ibatorgenerated_selectByInstitutionCode" resultMap="ibatorgenerated_BaseResultMapPrimaryKey"
		parameterClass="java.lang.String">
	    select cii.ID,
	           cii.INSTITUTION_CODE,
	           cii.INSTITUTION_NAME,
	           li.n_status ACT_STATE,
	           cii.SPREAD_START_DATE,
	           cii.SPREAD_END_DATE,
	           cii.LOGINID,
	           cii.BANK_ACCOUNT,
	           cii.BANK_NAME,
	           cii.BANK_UNAME,
	           cii.STATUS,
	           cii.REGIST_REBATE
	      from CROWD_INSTITUTION_INFO cii
	      join LOGIN_INFO li
	        on cii.loginid = li.n_login_id where
		INSTITUTION_CODE = #institutionCode:VARCHAR#
	</select>

	<insert id="ibatorgenerated_insert" parameterClass="com.km.crowdsourcing.model.InstitutionInfo">
		<selectKey resultClass="java.lang.Integer" keyProperty="id">
			select SEQ_CR_INST_INFO.nextval from dual
		</selectKey>
		insert into CROWD_INSTITUTION_INFO (ID, INSTITUTION_CODE,
		INSTITUTION_NAME, INSTITUTION_ADDRESS,
		INSTITUTION_CONTACTOR,
		INSTITUTION_PHONENUMBER, REGIST_REBATE, SPREAD_START_DATE,
		SPREAD_END_DATE, ACT_STATE, IMAGE_URL, AUDITOR_LOGINID, AUDITOR_NAME,
		AUDITE_DATE,
		AUDITE_MEMO, AUDITE_STATE, BAGMAN_ID, PASSWORD,
		APPLY_TYPE, CREATE_DATE, LOGINID,STATUS)
		values (#id:DECIMAL#,
		#institutionCode:VARCHAR#, #institutionName:VARCHAR#,
		#institutionAddress:VARCHAR#, #institutionContactor:VARCHAR#,
		#institutionPhonenumber:VARCHAR#, #registRebate:DECIMAL#,
		#spreadStartDate#,
		#spreadEndDate#, #actState:DECIMAL#,
		#imageUrl:VARCHAR#, #auditorLoginId:DECIMAL#,
		#auditorName:VARCHAR#,
		#auditeDate#, #auditeMemo:VARCHAR#,
		#auditeState:DECIMAL#,
		#bagmanId:DECIMAL#, #password:VARCHAR#, #applyType:DECIMAL#,
		#createDate#,#loginId:DECIMAL#,#status:DECIMAL#)
	</insert>
	<insert id="ibatorgenerated_insertSelective" parameterClass="com.km.crowdsourcing.model.InstitutionInfo">
		<selectKey resultClass="java.lang.Integer" keyProperty="id">
			select SEQ_CR_INST_INFO.nextval from dual
		</selectKey>
		insert into CROWD_INSTITUTION_INFO
		<dynamic prepend="(">
			<isNotNull prepend="," property="id">
				ID
			</isNotNull>
			<isNotNull prepend="," property="institutionCode">
				INSTITUTION_CODE
			</isNotNull>
			<isNotNull prepend="," property="institutionName">
				INSTITUTION_NAME
			</isNotNull>
			<isNotNull prepend="," property="institutionAddress">
				INSTITUTION_ADDRESS
			</isNotNull>
			<isNotNull prepend="," property="institutionContactor">
				INSTITUTION_CONTACTOR
			</isNotNull>
			<isNotNull prepend="," property="institutionPhonenumber">
				INSTITUTION_PHONENUMBER
			</isNotNull>
			<isNotNull prepend="," property="registRebate">
				REGIST_REBATE
			</isNotNull>
			<isNotNull prepend="," property="spreadStartDate">
				SPREAD_START_DATE
			</isNotNull>
			<isNotNull prepend="," property="spreadEndDate">
				SPREAD_END_DATE
			</isNotNull>
			<isNotNull prepend="," property="actState">
				ACT_STATE
			</isNotNull>
			<isNotNull prepend="," property="imageUrl">
				IMAGE_URL
			</isNotNull>
			<isNotNull prepend="," property="auditorLoginId">
				AUDITOR_LOGINID
			</isNotNull>
			<isNotNull prepend="," property="auditorName">
				AUDITOR_NAME
			</isNotNull>
			<isNotNull prepend="," property="auditeDate">
				AUDITE_DATE
			</isNotNull>
			<isNotNull prepend="," property="auditeMemo">
				AUDITE_MEMO
			</isNotNull>
			<isNotNull prepend="," property="auditeState">
				AUDITE_STATE
			</isNotNull>
			<isNotNull prepend="," property="bagmanId">
				BAGMAN_ID
			</isNotNull>
			<isNotNull prepend="," property="password">
				PASSWORD
			</isNotNull>
			<isNotNull prepend="," property="applyType">
				APPLY_TYPE
			</isNotNull>
			<isNotNull prepend="," property="createDate">
				CREATE_DATE
			</isNotNull>
			<isNotNull prepend="," property="loginId">
				LOGINID
			</isNotNull>
			<isNotNull prepend="," property="status">
				STATUS
			</isNotNull>
			)
		</dynamic>
		values
		<dynamic prepend="(">
			<isNotNull prepend="," property="id">
				#id:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="institutionCode">
				#institutionCode:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionName">
				#institutionName:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionAddress">
				#institutionAddress:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionContactor">
				#institutionContactor:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionPhonenumber">
				#institutionPhonenumber:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="registRebate">
				#registRebate:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="spreadStartDate">
				#spreadStartDate#
			</isNotNull>
			<isNotNull prepend="," property="spreadEndDate">
				#spreadEndDate#
			</isNotNull>
			<isNotNull prepend="," property="actState">
				#actState:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="imageUrl">
				#imageUrl:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditorLoginId">
				#auditorLoginId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="auditorName">
				#auditorName:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditeDate">
				#auditeDate#
			</isNotNull>
			<isNotNull prepend="," property="auditeMemo">
				#auditeMemo:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditeState">
				#auditeState:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="bagmanId">
				#bagmanId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="password">
				#password:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="applyType">
				#applyType:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="createDate">
				#createDate#
			</isNotNull>
			<isNotNull prepend="," property="loginId">
				#loginId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="status">
				#status:DECIMAL#
			</isNotNull>
			)
		</dynamic>
	</insert>



	<update id="ibatorgenerated_updateByPrimaryKeySelective"
		parameterClass="com.km.crowdsourcing.model.InstitutionInfo">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
		update CROWD_INSTITUTION_INFO
		<dynamic prepend="set">
			<isNotNull prepend="," property="institutionCode">
				INSTITUTION_CODE =
				#institutionCode:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionName">
				INSTITUTION_NAME =
				#institutionName:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionAddress">
				INSTITUTION_ADDRESS =
				#institutionAddress:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionContactor">
				INSTITUTION_CONTACTOR =
				#institutionContactor:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionPhonenumber">
				INSTITUTION_PHONENUMBER =
				#institutionPhonenumber:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="registRebate">
				REGIST_REBATE =
				#registRebate:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="spreadStartDate">
				SPREAD_START_DATE =
				#spreadStartDate:java.util.DATE#
			</isNotNull>
			<isNotNull prepend="," property="spreadEndDate">
				SPREAD_END_DATE =
				#spreadEndDate:java.util.DATE#
			</isNotNull>
			<isNotNull prepend="," property="actState">
				ACT_STATE =
				#actState:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="imageUrl">
				IMAGE_URL =
				#imageUrl:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditorLoginId">
				AUDITOR_LOGINID =
				#auditorLoginId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="auditorName">
				AUDITOR_NAME =
				#auditorName:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditeDate">
				AUDITE_DATE =
				#auditeDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="auditeMemo">
				AUDITE_MEMO =
				#auditeMemo:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditeState">
				AUDITE_STATE =
				#auditeState:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="bagmanId">
				BAGMAN_ID =
				#bagmanId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="password">
				PASSWORD =
				#password:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="applyType">
				APPLY_TYPE =
				#applyType:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="createDate">
				CREATE_DATE =
				#createDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="loginId">
				LOGINID =
				#loginId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="status">
				status =
				#status:VARCHAR#
			</isNotNull>
		</dynamic>
		where ID = #id:DECIMAL#
	</update>

	<update id="ibatorgenerated_updateByPrimaryLloginIdSelective"
		parameterClass="com.km.crowdsourcing.model.InstitutionInfo">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
		update CROWD_INSTITUTION_INFO
		<dynamic prepend="set">
			<isNotNull prepend="," property="institutionCode">
				INSTITUTION_CODE =
				#institutionCode:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionName">
				INSTITUTION_NAME =
				#institutionName:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionAddress">
				INSTITUTION_ADDRESS =
				#institutionAddress:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionContactor">
				INSTITUTION_CONTACTOR =
				#institutionContactor:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionPhonenumber">
				INSTITUTION_PHONENUMBER =
				#institutionPhonenumber:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="registRebate">
				REGIST_REBATE =
				#registRebate:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="spreadStartDate">
				SPREAD_START_DATE =
				#spreadStartDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="spreadEndDate">
				SPREAD_END_DATE =
				#spreadEndDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="actState">
				ACT_STATE =
				#actState:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="imageUrl">
				IMAGE_URL =
				#imageUrl:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditorLoginId">
				AUDITOR_LOGINID =
				#auditorLoginId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="auditorName">
				AUDITOR_NAME =
				#auditorName:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditeDate">
				AUDITE_DATE =
				#auditeDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="auditeMemo">
				AUDITE_MEMO =
				#auditeMemo:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditeState">
				AUDITE_STATE =
				#auditeState:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="bagmanId">
				BAGMAN_ID =
				#bagmanId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="password">
				PASSWORD =
				#password:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="applyType">
				APPLY_TYPE =
				#applyType:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="createDate">
				CREATE_DATE =
				#createDate:DATE#
			</isNotNull>

			<isNotNull prepend="," property="bankAccount">
				BANK_ACCOUNT =
				#bankAccount:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="bankUname">
				BANK_UNAME =
				#bankUname:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="bankName">
				BANK_NAME =
				#bankName:VARCHAR#
			</isNotNull>
		</dynamic>
		where LOGINID =#loginId:DECIMAL#
	</update>

	<update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.km.crowdsourcing.model.InstitutionInfo">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
		update CROWD_INSTITUTION_INFO
		set INSTITUTION_CODE =
		#institutionCode:VARCHAR#,
		INSTITUTION_NAME =
		#institutionName:VARCHAR#,
		INSTITUTION_ADDRESS =
		#institutionAddress:VARCHAR#,
		INSTITUTION_CONTACTOR =
		#institutionContactor:VARCHAR#,
		INSTITUTION_PHONENUMBER =
		#institutionPhonenumber:VARCHAR#,
		REGIST_REBATE =
		#registRebate:DECIMAL#,
		SPREAD_START_DATE = #spreadStartDate:DATE#,
		SPREAD_END_DATE = #spreadEndDate:DATE#,
		ACT_STATE = #actState:DECIMAL#,
		IMAGE_URL = #imageUrl:VARCHAR#,
		AUDITOR_LOGINID =
		#auditorLoginId:DECIMAL#,
		AUDITOR_NAME = #auditorName:VARCHAR#,
		AUDITE_DATE = #auditeDate:DATE#,
		AUDITE_MEMO = #auditeMemo:VARCHAR#,
		AUDITE_STATE = #auditeState:DECIMAL#,
		BAGMAN_ID = #bagmanId:DECIMAL#,
		PASSWORD = #password:VARCHAR#,
		APPLY_TYPE = #applyType:DECIMAL#,
		CREATE_DATE = #createDate:DATE#,
		LOGINID = #loginId:DECIMAL#
		where ID =
		#id:DECIMAL#
	</update>

	<select id="selectCountByVo" resultClass="java.lang.Integer"
		parameterClass="com.km.commons.general.model.Page">
		<!-- 机构业务员数 -->
		SELECT count(1) from
		CROWD_INSTITUTION_INFO cii, crowd_sourcing_bagman
		csb,login_info l where cii.BAGMAN_ID=csb.id and
		l.n_login_id=cii.LOGINID
		<isNotNull property="queryCondition.institutionCode">
			<isNotEmpty prepend="and" property="queryCondition.institutionCode">
				cii.INSTITUTION_CODE =
				#queryCondition.institutionCode:VARCHAR#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.id">
			<isNotEmpty prepend="and" property="queryCondition.id">
				cii.id =
				#queryCondition.id:DECIMAL#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.institutionName">
			<isNotEmpty prepend="and" property="queryCondition.institutionName">
				cii.INSTITUTION_NAME
				like '%$queryCondition.institutionName$%'

			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.bagmanName">
			<isNotEmpty prepend="and" property="queryCondition.bagmanName">
				csb.name
				like
				'%$queryCondition.bagmanName$%'

			</isNotEmpty>
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.institutionAddress">
			cii.INSTITUTION_ADDRESS =
			#queryCondition.institutionAddress:VARCHAR#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.institutionContactor">
			cii.INSTITUTION_CONTACTOR
			=
			#queryCondition.institutionContactor:VARCHAR#
		</isNotNull>
		<isNotNull property="queryCondition.institutionPhonenumber">
			<isNotEmpty prepend="and"
				property="queryCondition.institutionPhonenumber">
				cii.INSTITUTION_PHONENUMBER =
				#queryCondition.institutionPhonenumber:VARCHAR#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.mobile">
			<isNotEmpty prepend="and" property="queryCondition.mobile">
				l.mobile =
				#queryCondition.mobile:VARCHAR#
			</isNotEmpty>
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.registRebate">
			cii.REGIST_REBATE =
			#queryCondition.registRebate:DECIMAL#
		</isNotNull>
		<isNotNull property="queryCondition.spreadStartDate">
			<isNotEmpty prepend="and" property="queryCondition.spreadStartDate">
		<![CDATA[  cii.SPREAD_START_DATE  >= #queryCondition.spreadStartDate#]]>
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.spreadEndDate">
			<isNotEmpty prepend="and" property="queryCondition.spreadEndDate">
			<![CDATA[  cii.SPREAD_START_DATE  <= #queryCondition.spreadEndDate#]]>
			</isNotEmpty>
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.actState">
			cii.ACT_STATE =
			#queryCondition.actState:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.imageUrl">
			cii.IMAGE_URL =
			#queryCondition.imageUrl:VARCHAR#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.auditorLoginId">
			cii.AUDITOR_LOGINID =
			#queryCondition.auditorLoginId:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.auditorName">
			cii.AUDITOR_NAME =
			#queryCondition.auditorName:VARCHAR#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.auditeDate">
			cii.AUDITE_DATE =
			#queryCondition.auditeDate:DATE#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.auditeMemo">
			cii.AUDITE_MEMO =
			#queryCondition.auditeMemo:VARCHAR#
		</isNotNull>
		<isNotNull property="queryCondition.auditeState">
			<isNotEmpty prepend="and" property="queryCondition.auditeState">
				cii.AUDITE_STATE =
				#queryCondition.auditeState:DECIMAL#
			</isNotEmpty>
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.bagmanId">
			cii.BAGMAN_ID =
			#queryCondition.bagmanId:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.password">
			cii.PASSWORD =
			#queryCondition.password:VARCHAR#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.applyType">
			cii.APPLY_TYPE =
			#queryCondition.applyType:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.createDate">
			cii.CREATE_DATE =
			#queryCondition.createDate:DATE#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.loginId">
			cii.LOGINID =
			#queryCondition.loginId:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.status">
			cii.STATUS =
			#queryCondition.status:DECIMAL#
		</isNotNull>
	</select>
	<select id="selectListByVo" resultMap="ibatorgenerated_BaseResultMap_list"
		parameterClass="com.km.commons.general.model.Page">
		<!-- 机构业务员数 -->
		select ID,NAME, INSTITUTION_CODE, INSTITUTION_NAME,
		INSTITUTION_ADDRESS,
		INSTITUTION_CONTACTOR,
		INSTITUTION_PHONENUMBER,
		REGIST_REBATE,
		SPREAD_START_DATE, SPREAD_END_DATE, ACT_STATE,
		IMAGE_URL,
		AUDITOR_LOGINID, AUDITOR_NAME, AUDITE_DATE, AUDITE_MEMO,
		AUDITE_STATE,
		BAGMAN_ID,
		referrerNum,
		referrerSum,
		PASSWORD, APPLY_TYPE,
		CREATE_DATE,LOGINID,STATUS,mobile,bagmanName from(
		select ROW_NUMBER()
		OVER(order by
		cii.ID desc) as
		view_row_number,
		(select count(1) from
		crowd_institution_user ciu where
		ciu.INSTITUTION_CODE=cii.INSTITUTION_CODE) as referrerNum,
		(select
		sum(CLEARING_AMOUNT) from
		crowd_institution_user ciu where
		ciu.INSTITUTION_CODE=cii.INSTITUTION_CODE and ciu.clearing_status=1) as referrerSum,
		csb.NAME,
		cii.ID,
		cii.INSTITUTION_CODE,
		cii.INSTITUTION_NAME,
		cii.INSTITUTION_ADDRESS,
		cii.INSTITUTION_CONTACTOR,
		cii.INSTITUTION_PHONENUMBER,
		cii.REGIST_REBATE,
		cii.SPREAD_START_DATE,
		cii.SPREAD_END_DATE,
		cii.ACT_STATE,
		cii.IMAGE_URL,
		cii.AUDITOR_LOGINID,
		cii.AUDITOR_NAME,
		cii.AUDITE_DATE, cii.AUDITE_MEMO,
		cii.AUDITE_STATE,
		cii.BAGMAN_ID,
		cii.PASSWORD, cii.APPLY_TYPE,
		cii.CREATE_DATE,
		cii.LOGINID,
		cii.STATUS,
		l.mobile,
		csb.name as bagmanName
		from
		CROWD_INSTITUTION_INFO cii,
		crowd_sourcing_bagman csb,login_info l
		where cii.BAGMAN_ID=csb.id and
		l.n_login_id=cii.LOGINID

		<isNotNull property="queryCondition.institutionCode">
			<isNotEmpty prepend="and" property="queryCondition.institutionCode">
				cii.INSTITUTION_CODE =
				#queryCondition.institutionCode:VARCHAR#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.id">
			<isNotEmpty prepend="and" property="queryCondition.id">
				cii.id =
				#queryCondition.id:DECIMAL#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.institutionName">
			<isNotEmpty prepend="and" property="queryCondition.institutionName">
				cii.INSTITUTION_NAME
				like '%$queryCondition.institutionName$%'

			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.bagmanName">
			<isNotEmpty prepend="and" property="queryCondition.bagmanName">
				csb.name
				like
				'%$queryCondition.bagmanName$%'

			</isNotEmpty>
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.institutionAddress">
			cii.INSTITUTION_ADDRESS =
			#queryCondition.institutionAddress:VARCHAR#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.institutionContactor">
			cii.INSTITUTION_CONTACTOR
			=
			#queryCondition.institutionContactor:VARCHAR#
		</isNotNull>
		<isNotNull property="queryCondition.institutionPhonenumber">
			<isNotEmpty prepend="and"
				property="queryCondition.institutionPhonenumber">
				cii.INSTITUTION_PHONENUMBER =
				#queryCondition.institutionPhonenumber:VARCHAR#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.mobile">
			<isNotEmpty prepend="and" property="queryCondition.mobile">
				l.mobile =
				#queryCondition.mobile:VARCHAR#
			</isNotEmpty>
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.registRebate">
			cii.REGIST_REBATE =
			#queryCondition.registRebate:DECIMAL#
		</isNotNull>
		<isNotNull property="queryCondition.spreadStartDate">
			<isNotEmpty prepend="and" property="queryCondition.spreadStartDate">
		<![CDATA[  cii.SPREAD_START_DATE  >= #queryCondition.spreadStartDate#]]>
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="queryCondition.spreadEndDate">
			<isNotEmpty prepend="and" property="queryCondition.spreadEndDate">
			<![CDATA[  cii.SPREAD_START_DATE  <= #queryCondition.spreadEndDate#]]>
			</isNotEmpty>
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.actState">
			cii.ACT_STATE =
			#queryCondition.actState:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.imageUrl">
			cii.IMAGE_URL =
			#queryCondition.imageUrl:VARCHAR#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.auditorLoginId">
			cii.AUDITOR_LOGINID =
			#queryCondition.auditorLoginId:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.auditorName">
			cii.AUDITOR_NAME =
			#queryCondition.auditorName:VARCHAR#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.auditeDate">
			cii.AUDITE_DATE =
			#queryCondition.auditeDate:DATE#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.auditeMemo">
			cii.AUDITE_MEMO =
			#queryCondition.auditeMemo:VARCHAR#
		</isNotNull>
		<isNotNull property="queryCondition.auditeState">
			<isNotEmpty prepend="and" property="queryCondition.auditeState">
				cii.AUDITE_STATE =
				#queryCondition.auditeState:DECIMAL#
			</isNotEmpty>
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.bagmanId">
			cii.BAGMAN_ID =
			#queryCondition.bagmanId:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.password">
			cii.PASSWORD =
			#queryCondition.password:VARCHAR#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.applyType">
			cii.APPLY_TYPE =
			#queryCondition.applyType:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.createDate">
			cii.CREATE_DATE =
			#queryCondition.createDate:DATE#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.loginId">
			cii.LOGINID =
			#queryCondition.loginId:DECIMAL#
		</isNotNull>
		<isNotNull prepend="and" property="queryCondition.status">
			cii.STATUS =
			#queryCondition.status:DECIMAL#
		</isNotNull>
		)
     <![CDATA[ where view_row_number <= #endIndex# and view_row_number >= #startIndex#  order by ID desc]]>
	</select>
</sqlMap>