<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="CrowdInstitutionWithdrawals">
	<resultMap id="ibatorgenerated_BaseResultMap" class="com.km.crowdsourcing.model.WithdrawalsInfo">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
		<result column="ID" property="id" jdbcType="DECIMAL" />
		<result column="LOGINID" property="loginId" jdbcType="DECIMAL" />
		<result column="INSTITUTION_CODE" property="institutionCode" jdbcType="VARCHAR" />
		<result column="status" property="status" jdbcType="DECIMAL" />
		<result column="BANK_ACCOUNT" property="bankAccount" jdbcType="VARCHAR" />
		<result column="BANK_NAME" property="bankName" jdbcType="VARCHAR" />
		<result column="BANK_UNAME" property="bankUname" jdbcType="VARCHAR" />
		<result column="MOBIE" property="mobie" jdbcType="VARCHAR" />	
		<result column="AMOUNT_AVLIBAL" property="amountAvlibal" jdbcType="DECIMAL" />
		<result column="isExist" property="isExist" jdbcType="DECIMAL" />
		
	</resultMap>
	
	<select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap"
		parameterClass="java.lang.String">
		<!-- WARNING - This element is automatically generated by Apache iBATIS 
			ibator, do not modify. This element was generated on Mon Mar 14 14:32:41 
			CST 2016. -->
	        SELECT CII.ID,
	               CII.LOGINID,
	               CII.INSTITUTION_CODE,
	               CII.STATUS,
	               CII.BANK_ACCOUNT,
	               CII.BANK_NAME,
	               CII.BANK_UNAME,
	               AI.MOBILE MOBIE,
	               AI.AI.AMOUNT_AVLIBAL,
	               (select count(1)
	                  from BNES_ACCT_ENCHASHMENT bae
	                 where bae.n_login_id = CII.LOGINID
	                   and (bae.ENCHASHMENT_STATUS = 0 or bae.ENCHASHMENT_STATUS = 3)
	                   and bae.ENCHASHMENT_RESOURCE = 2) isExist
	          FROM CROWD_INSTITUTION_INFO CII
	          LEFT JOIN ACCOUNT_INFO AI
	            ON AI.N_LOGIN_ID = CII.LOGINID
	         where cii.INSTITUTION_CODE = #institutionCode :VARCHAR#

	</select>

	<insert id="ibatorgenerated_insertSelective" parameterClass="com.km.crowdsourcing.model.InstitutionInfo">
		<selectKey resultClass="java.lang.Integer" keyProperty="id">
			select SEQ_CR_INST_INFO.nextval from dual
		</selectKey>
		insert into CROWD_INSTITUTION_INFO
		<dynamic prepend="(">
			<isNotNull prepend="," property="id">
				ID
			</isNotNull>
			<isNotNull prepend="," property="institutionCode">
				INSTITUTION_CODE
			</isNotNull>
			<isNotNull prepend="," property="institutionName">
				INSTITUTION_NAME
			</isNotNull>
			<isNotNull prepend="," property="institutionAddress">
				INSTITUTION_ADDRESS
			</isNotNull>
			<isNotNull prepend="," property="institutionContactor">
				INSTITUTION_CONTACTOR
			</isNotNull>
			<isNotNull prepend="," property="institutionPhonenumber">
				INSTITUTION_PHONENUMBER
			</isNotNull>
			<isNotNull prepend="," property="registRebate">
				REGIST_REBATE
			</isNotNull>
			<isNotNull prepend="," property="spreadStartDate">
				SPREAD_START_DATE
			</isNotNull>
			<isNotNull prepend="," property="spreadEndDate">
				SPREAD_END_DATE
			</isNotNull>
			<isNotNull prepend="," property="actState">
				ACT_STATE
			</isNotNull>
			<isNotNull prepend="," property="imageUrl">
				IMAGE_URL
			</isNotNull>
			<isNotNull prepend="," property="auditorLoginId">
				AUDITOR_LOGINID
			</isNotNull>
			<isNotNull prepend="," property="auditorName">
				AUDITOR_NAME
			</isNotNull>
			<isNotNull prepend="," property="auditeDate">
				AUDITE_DATE
			</isNotNull>
			<isNotNull prepend="," property="auditeMemo">
				AUDITE_MEMO
			</isNotNull>
			<isNotNull prepend="," property="auditeState">
				AUDITE_STATE
			</isNotNull>
			<isNotNull prepend="," property="bagmanId">
				BAGMAN_ID
			</isNotNull>
			<isNotNull prepend="," property="password">
				PASSWORD
			</isNotNull>
			<isNotNull prepend="," property="applyType">
				APPLY_TYPE
			</isNotNull>
			<isNotNull prepend="," property="createDate">
				CREATE_DATE
			</isNotNull>
			<isNotNull prepend="," property="loginId">
				LOGINID
			</isNotNull>
			)
		</dynamic>
		values
		<dynamic prepend="(">
			<isNotNull prepend="," property="id">
				#id:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="institutionCode">
				#institutionCode:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionName">
				#institutionName:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionAddress">
				#institutionAddress:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionContactor">
				#institutionContactor:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="institutionPhonenumber">
				#institutionPhonenumber:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="registRebate">
				#registRebate:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="spreadStartDate">
				#spreadStartDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="spreadEndDate">
				#spreadEndDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="actState">
				#actState:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="imageUrl">
				#imageUrl:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditorLoginId">
				#auditorLoginId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="auditorName">
				#auditorName:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditeDate">
				#auditeDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="auditeMemo">
				#auditeMemo:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="auditeState">
				#auditeState:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="bagmanId">
				#bagmanId:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="password">
				#password:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="applyType">
				#applyType:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="createDate">
				#createDate:DATE#
			</isNotNull>
			<isNotNull prepend="," property="loginId">
				#loginId:DECIMAL#
			</isNotNull>
			)
		</dynamic>
	</insert>


</sqlMap>