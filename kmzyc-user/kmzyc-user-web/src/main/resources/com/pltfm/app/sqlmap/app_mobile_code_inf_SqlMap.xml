<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="MOBILE_CODE_INF" >
  <resultMap id="abatorgenerated_MobileCodeInfResult" class="com.pltfm.app.vobject.MobileCodeInf" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    <result column="N_CELL_PHONE_TATTED_CODE_ID" property="n_CellPhoneTattedCodeId" jdbcType="DECIMAL" />
    <result column="N_ACCOUNT_ID" property="n_AccountId" jdbcType="DECIMAL" />
    <result column="TATTED_CODE" property="tattedCode" jdbcType="VARCHAR" />
    
    <result column="ACCOUNT_LOGIN" property="accountLogin" jdbcType="VARCHAR" />
    <result column="MOBILE" property="mobile" jdbcType="VARCHAR" />
     
    <result column="LAST_SEND_TATTEDCODE_TIME" property="lastSendTattedcodeTime" jdbcType="VARCHAR" />
    <result column="N_FAILURE_TIME_VALUE" property="n_FailureTimeValue" jdbcType="DECIMAL" />
    <result column="D_CREATE_DATE" property="d_CreateDate"  />
    <result column="N_CREATED" property="n_Created" jdbcType="DECIMAL" />
    <result column="D_MODIFY_DATE" property="d_ModifyDate"  />
    <result column="N_MODIFIED" property="n_Modified" jdbcType="DECIMAL" />
    <result column="IS_STATUS" property="is_Status"  />
    <result column="MOBLIE_TYPE" property="mobile_Type"  />
  </resultMap>
  
    <resultMap id="abatorgenerated_MobileCodeInfResultOther" class="com.pltfm.app.vobject.MobileCodeInf" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    <result column="N_CELL_PHONE_TATTED_CODE_ID" property="n_CellPhoneTattedCodeId" jdbcType="DECIMAL" />
    <result column="N_ACCOUNT_ID" property="n_AccountId" jdbcType="DECIMAL" />
    <result column="TATTED_CODE" property="tattedCode" jdbcType="VARCHAR" />
    <result column="LAST_SEND_TATTEDCODE_TIME" property="lastSendTattedcodeTime" jdbcType="VARCHAR" />
    <result column="N_FAILURE_TIME_VALUE" property="n_FailureTimeValue" jdbcType="DECIMAL" />
    <result column="D_CREATE_DATE" property="d_CreateDate"  />
    <result column="N_CREATED" property="n_Created" jdbcType="DECIMAL" />
    <result column="D_MODIFY_DATE" property="d_ModifyDate"  />
    <result column="N_MODIFIED" property="n_Modified" jdbcType="DECIMAL" />
    <result column="MOBLIE_TYPE" property="mobile_Type"  />
  </resultMap>
  
  <resultMap id="ibatorgenerated_CountResult" class="com.pltfm.sys.model.SysModelUtil">
    <result column="the_count" property="theCount" jdbcType="DECIMAL" />
  </resultMap>
  
  <sql id="abatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="abatorgenerated_selectByPrimaryKey" resultMap="abatorgenerated_MobileCodeInfResult" parameterClass="com.pltfm.app.vobject.MobileCodeInf" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    select N_CELL_PHONE_TATTED_CODE_ID, N_ACCOUNT_ID, TATTED_CODE, LAST_SEND_TATTEDCODE_TIME,
      N_FAILURE_TIME_VALUE, D_CREATE_DATE, N_CREATED, D_MODIFY_DATE, N_MODIFIED,MOBLIE_TYPE
    from MOBILE_CODE_INF
    where N_CELL_PHONE_TATTED_CODE_ID = #n_CellPhoneTattedCodeId:DECIMAL#
  </select>
  <select id="abatorgenerated_selectByExample" resultMap="abatorgenerated_MobileCodeInfResult" parameterClass="com.pltfm.app.vobject.MobileCodeInfExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    select N_CELL_PHONE_TATTED_CODE_ID, N_ACCOUNT_ID, TATTED_CODE, LAST_SEND_TATTEDCODE_TIME,
      N_FAILURE_TIME_VALUE, D_CREATE_DATE, N_CREATED, D_MODIFY_DATE, N_MODIFIED,MOBLIE_TYPE
    from MOBILE_CODE_INF
    <isParameterPresent >
      <include refid="MOBILE_CODE_INF.abatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <delete id="abatorgenerated_deleteByPrimaryKey" parameterClass="com.pltfm.app.vobject.MobileCodeInf" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    delete from MOBILE_CODE_INF
    where N_CELL_PHONE_TATTED_CODE_ID = #n_CellPhoneTattedCodeId:DECIMAL#
  </delete>
  <delete id="abatorgenerated_deleteByExample" parameterClass="com.pltfm.app.vobject.MobileCodeInfExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    delete from MOBILE_CODE_INF
    <include refid="MOBILE_CODE_INF.abatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="abatorgenerated_insert" parameterClass="com.pltfm.app.vobject.MobileCodeInf" >
 
  
   <selectKey resultClass="java.lang.Integer" keyProperty="n_CellPhoneTattedCodeId" >
           select  SEQ_APP_AUTHEN.nextval from dual
   </selectKey>
    
  
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    insert into MOBILE_CODE_INF (N_LOGIN_ID,N_CELL_PHONE_TATTED_CODE_ID, N_ACCOUNT_ID, TATTED_CODE,
      LAST_SEND_TATTEDCODE_TIME, N_FAILURE_TIME_VALUE, D_CREATE_DATE, N_CREATED, D_MODIFY_DATE,
      N_MODIFIED,MOBILE,MOBLIE_TYPE,IS_STATUS)
    values (#n_LoginId#,#n_CellPhoneTattedCodeId:DECIMAL#, #n_AccountId:DECIMAL#, #tattedCode:VARCHAR#,
      #lastSendTattedcodeTime:VARCHAR#, #n_FailureTimeValue:DECIMAL#, #d_CreateDate#,
      #n_Created:DECIMAL#, #d_ModifyDate#, #n_Modified:DECIMAL#,#mobile#,#mobile_Type#,#is_Status#)
  </insert>
  <update id="abatorgenerated_updateByPrimaryKey" parameterClass="com.pltfm.app.vobject.MobileCodeInf" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    update MOBILE_CODE_INF
    set N_ACCOUNT_ID = #n_AccountId:DECIMAL#,
      TATTED_CODE = #tattedCode:VARCHAR#,
      LAST_SEND_TATTEDCODE_TIME = #lastSendTattedcodeTime:VARCHAR#,
      N_FAILURE_TIME_VALUE = #n_FailureTimeValue:DECIMAL#,
      D_CREATE_DATE = #d_CreateDate:DATE#,
      N_CREATED = #n_Created:DECIMAL#,
      D_MODIFY_DATE = #d_ModifyDate:DATE#,
      N_MODIFIED = #n_Modified:DECIMAL#
    where N_CELL_PHONE_TATTED_CODE_ID = #n_CellPhoneTattedCodeId:DECIMAL#
  </update>
  <update id="abatorgenerated_updateByPrimaryKeySelective" parameterClass="com.pltfm.app.vobject.MobileCodeInf" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    update MOBILE_CODE_INF
    <dynamic prepend="set" >
      <isNotNull prepend="," property="n_AccountId" >
        N_ACCOUNT_ID = #n_AccountId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="tattedCode" >
        TATTED_CODE = #tattedCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="lastSendTattedcodeTime" >
        LAST_SEND_TATTEDCODE_TIME = #lastSendTattedcodeTime:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="n_FailureTimeValue" >
        N_FAILURE_TIME_VALUE = #n_FailureTimeValue:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="d_CreateDate" >
        D_CREATE_DATE = #d_CreateDate:DATE#
      </isNotNull>
      <isNotNull prepend="," property="n_Created" >
        N_CREATED = #n_Created:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="d_ModifyDate" >
        D_MODIFY_DATE = #d_ModifyDate:DATE#
      </isNotNull>
      <isNotNull prepend="," property="n_Modified" >
        N_MODIFIED = #n_Modified:DECIMAL#
      </isNotNull>
       <isNotNull prepend="," property="is_Status" >
        IS_STATUS = #is_Status:DECIMAL#
      </isNotNull>
    </dynamic>
    where N_CELL_PHONE_TATTED_CODE_ID = #n_CellPhoneTattedCodeId:DECIMAL#
  </update>
    <update id="abatorgenerated_isupdatecode" parameterClass="com.pltfm.app.vobject.MobileCodeInf" >
    UPDATE MOBILE_CODE_INF M
         SET M.IS_STATUS = 1 
         WHERE M.IS_STATUS = 0 
    <![CDATA[ AND (M.D_CREATE_DATE+M.N_FAILURE_TIME_VALUE/(24*60)) > SYSDATE  ]]>
     <isNotNull property="mobile_Type">
			  <isNotEmpty prepend="and" property="mobile_Type">
				 M.MOBLIE_TYPE = #mobile_Type#
			  </isNotEmpty>
		  </isNotNull>
    <isNotNull property="mobile">
			  <isNotEmpty prepend="and" property="mobile">
				 M.MOBILE = #mobile#
			  </isNotEmpty>
		  </isNotNull>
    <isNotNull property="tattedCode">
			  <isNotEmpty prepend="and" property="tattedCode">
				 M.TATTED_CODE = #tattedCode#
			  </isNotEmpty>
		  </isNotNull>
   </update>
  
  <select id="abatorgenerated_countByExample" parameterClass="com.pltfm.app.vobject.MobileCodeInfExample" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    select count(*) from MOBILE_CODE_INF
    <include refid="MOBILE_CODE_INF.abatorgenerated_Example_Where_Clause" />
  </select>
  <update id="abatorgenerated_updateByExampleSelective" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    update MOBILE_CODE_INF
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.n_CellPhoneTattedCodeId" >
        N_CELL_PHONE_TATTED_CODE_ID = #record.n_CellPhoneTattedCodeId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.n_AccountId" >
        N_ACCOUNT_ID = #record.n_AccountId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.tattedCode" >
        TATTED_CODE = #record.tattedCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.lastSendTattedcodeTime" >
        LAST_SEND_TATTEDCODE_TIME = #record.lastSendTattedcodeTime:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.n_FailureTimeValue" >
        N_FAILURE_TIME_VALUE = #record.n_FailureTimeValue:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.d_CreateDate" >
        D_CREATE_DATE = #record.d_CreateDate:DATE#
      </isNotNull>
      <isNotNull prepend="," property="record.n_Created" >
        N_CREATED = #record.n_Created:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.d_ModifyDate" >
        D_MODIFY_DATE = #record.d_ModifyDate:DATE#
      </isNotNull>
      <isNotNull prepend="," property="record.n_Modified" >
        N_MODIFIED = #record.n_Modified:DECIMAL#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="MOBILE_CODE_INF.abatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="abatorgenerated_updateByExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Jul 23 09:07:31 CST 2013.
    -->
    update MOBILE_CODE_INF
    set N_CELL_PHONE_TATTED_CODE_ID = #record.n_CellPhoneTattedCodeId:DECIMAL#,
      N_ACCOUNT_ID = #record.n_AccountId:DECIMAL#,
      TATTED_CODE = #record.tattedCode:VARCHAR#,
      LAST_SEND_TATTEDCODE_TIME = #record.lastSendTattedcodeTime:VARCHAR#,
      N_FAILURE_TIME_VALUE = #record.n_FailureTimeValue:DECIMAL#,
      D_CREATE_DATE = #record.d_CreateDate:DATE#,
      N_CREATED = #record.n_Created:DECIMAL#,
      D_MODIFY_DATE = #record.d_ModifyDate:DATE#,
      N_MODIFIED = #record.n_Modified:DECIMAL#
    <isParameterPresent >
      <include refid="MOBILE_CODE_INF.abatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  
  
   <select id="selectByMobileCodeInf" resultMap="abatorgenerated_MobileCodeInfResultOther" parameterClass="com.pltfm.app.vobject.MobileCodeInf">
	SELECT *
	FROM  
     (SELECT ROW_NUMBER() OVER(ORDER BY last_send_tattedcode_time DESC) rk ,tt.*
      FROM MOBILE_CODE_INF tt where tt.n_account_id = #n_AccountId:DECIMAL#
      and tt.TATTED_CODE = #tattedCode:VARCHAR#
      ) 
	WHERE  rk = 1 
	</select>
	
	
  
   <!--  ****************  search page by vo  ****************  -->
  <select id="searchPageByVo" resultMap="abatorgenerated_MobileCodeInfResult" parameterClass="com.pltfm.app.vobject.MobileCodeInf">
 select n_login_id,
       N_CELL_PHONE_TATTED_CODE_ID,
       N_ACCOUNT_ID,
       TATTED_CODE,
       LAST_SEND_TATTEDCODE_TIME,
       N_FAILURE_TIME_VALUE,
       D_CREATE_DATE,
       N_CREATED,
       D_MODIFY_DATE,
       N_MODIFIED,
       ACCOUNT_LOGIN,
       MOBILE,
       IS_STATUS,
       MOBLIE_TYPE
    FROM (
    select  ROW_NUMBER() OVER(order by N_CELL_PHONE_TATTED_CODE_ID desc) as view_row_number, 
    tt.n_login_id,
    tt.n_cell_phone_tatted_code_id,
    aa.n_account_id,
    tt.tatted_code,
    tt.last_send_tattedcode_time,
    tt.n_failure_time_value,tt.d_create_date,tt.n_modified,tt.is_status,tt.d_modify_date,tt.n_created,
    aa.ACCOUNT_LOGIN,tt.MOBILE,tt.MOBLIE_TYPE from MOBILE_CODE_INF tt,ACCOUNT_INFO aa
    where tt.n_login_id=aa.n_login_id
		  
		  <isNotNull property="lastSendTattedcodeTime">
			  <isNotEmpty prepend="and" property="lastSendTattedcodeTime">
				tt.LAST_SEND_TATTEDCODE_TIME like '%$lastSendTattedcodeTime$%'
			  </isNotEmpty>
		  </isNotNull>
		  
		  <isNotNull property="mobile">
			  <isNotEmpty prepend="and" property="mobile">
				aa.MOBILE like '%$mobile$%'
			  </isNotEmpty>
		  </isNotNull>
		  
		  <isNotNull property="accountLogin">
			  <isNotEmpty prepend="and" property="accountLogin">
				aa.ACCOUNT_LOGIN like '%$accountLogin$%'
			  </isNotEmpty>
		  </isNotNull>
		  
    )
    <![CDATA[ where view_row_number <= #max# and view_row_number > #skip# ]]>
	</select>
	
 <!-- **************** search user's roleList by vo  ****************  -->
  <select id="getMobileCodeInfCount" parameterClass="com.pltfm.app.vobject.MobileCodeInf" resultMap="ibatorgenerated_CountResult">
     select count(1) the_count from MOBILE_CODE_INF tt, ACCOUNT_INFO aa
    where tt.n_login_id=aa.n_login_id
    
		 <isNotNull property="lastSendTattedcodeTime">
			  <isNotEmpty prepend="and" property="lastSendTattedcodeTime">
				tt.LAST_SEND_TATTEDCODE_TIME like '%$lastSendTattedcodeTime$%'
			  </isNotEmpty>
		  </isNotNull>
		  
		  <isNotNull property="mobile">
			  <isNotEmpty prepend="and" property="mobile">
				aa.MOBILE like '%$mobile$%'
			  </isNotEmpty>
		  </isNotNull>
		  
		  <isNotNull property="accountLogin">
			  <isNotEmpty prepend="and" property="accountLogin">
				aa.ACCOUNT_LOGIN like '%$accountLogin$%'
			  </isNotEmpty>
		  </isNotNull>
  </select>
  
</sqlMap>