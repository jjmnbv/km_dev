<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KMPRODUCT_COUPON_GRANT_FLOW" >
<typeAlias alias="Coupon" type="com.pltfm.app.vobject.Coupon"/>
  <resultMap id="CouponResultMap" class="Coupon" >
    <result column="COUPON_ID" property="couponId" jdbcType="DECIMAL" />
    <result column="COUPON_NAME" property="couponName" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="abatorgenerated_CouponGrantFlowResult" class="com.pltfm.app.vobject.CouponGrantFlow" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Jun 09 04:40:49 CST 2014.
    -->
    <result column="COUPON_GRANT_FLOW_ID" property="couponGrantFlowId" jdbcType="DECIMAL" />
    <result column="COUPON_GRANT_FLOW_TYPE" property="couponGrantFlowType" jdbcType="DECIMAL" />
    <result column="OPERATING_PERSON" property="operatingPerson" jdbcType="DECIMAL" ></result>
    <result column="CREATE_DATE" property="createDate" jdbcType="Timestamp" />
    <result column="ORDER_CODE" property="orderCode" jdbcType="VARCHAR" />
    <result column="ORDER_FLOW_CODE" property="orderFlowCode" jdbcType="VARCHAR" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" ></result>
    <result column="COUPON_GRANT_ID" property="couponGrantId" jdbcType="DECIMAL" />
    <result column="COUPON_ID" property="couponId"  jdbcType="DECIMAL" />
    <result column="COUPON_NAME" property="couponName"  jdbcType="VARCHAR" />
    <result column="OPERATING_PERSON_NAME" property="operatingPersonName"  jdbcType="VARCHAR" />
    <result column="CUSTOMER" property="customer"  jdbcType="VARCHAR" />
  </resultMap>

  <resultMap id="ibatorgenerated_BaseResultMap" class="com.pltfm.app.vobject.CouponGrant" >
    <result column="COUPON_GRANT_ID" property="couponGrantId" jdbcType="DECIMAL"  />
    <result column="COUPON_ID" property="couponId" jdbcType="DECIMAL"  />
    <result column="CUSTOM_ID" property="customId" jdbcType="DECIMAL"   />
    <result column="COUPON_STATUS" property="couponStatus" jdbcType="DECIMAL"   />
 <!-- 10.29新增 -->
    <result column="grant_creattime" property="grantCreattime" jdbcType="VARCHAR"    />
    <result column="GRANT_CRATEMAN" property="grantCreateman" jdbcType="DECIMAL"   />
    <result column="grant_updatetime" property="grantUpdatetime" jdbcType="VARCHAR"  />
    <result column="grant_updateman" property="grantUpdateman" jdbcType="DECIMAL"  />
    <result column="GRANT_TYPE" property="grantType"  jdbcType="DECIMAL" />
    <result column="GRANT_RELATED_CODE" property="grantRelatedCode"  jdbcType="VARCHAR" />
    <result column="GRANT_REMARK" property="grantRemark"  jdbcType="VARCHAR" />
    <result column="GRANT_ENDTIME" property="grantEndtime"  jdbcType="VARCHAR" />
  </resultMap>
  <sql id="abatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Jun 09 04:40:49 CST 2014.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="abatorgenerated_selectByExample" resultMap="abatorgenerated_CouponGrantFlowResult" parameterClass="com.pltfm.app.vobject.CouponGrantFlowExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Jun 09 04:40:49 CST 2014.
    -->
    select COUPON_GRANT_FLOW_ID, COUPON_GRANT_FLOW_TYPE, OPERATING_PERSON, CREATE_DATE, ORDER_CODE,
      ORDER_FLOW_CODE, REMARK, COUPON_GRANT_ID
    from COUPON_GRANT_FLOW
    <isParameterPresent >
      <include refid="KMPRODUCT_COUPON_GRANT_FLOW.abatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <delete id="abatorgenerated_deleteByExample" parameterClass="com.pltfm.app.vobject.CouponGrantFlowExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Jun 09 04:40:49 CST 2014.
    -->
    delete from COUPON_GRANT_FLOW
    <include refid="KMPRODUCT_COUPON_GRANT_FLOW.abatorgenerated_Example_Where_Clause" />
  </delete>
  
  <insert id="abatorgenerated_insert" parameterClass="com.pltfm.app.vobject.CouponGrantFlow" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 22 09:45:29 CST 2013.
    -->
     <selectKey resultClass="java.lang.Long" keyProperty="couponGrantFlowId" >
           select SEQ_APP_COUPON_GRANT_FLOW.nextval from dual
    </selectKey>
    insert into coupon_grant_flow
    <dynamic prepend="(" >
      <isNotNull prepend="," property="couponGrantFlowId" >
        COUPON_GRANT_FLOW_ID
      </isNotNull>
      <isNotNull prepend="," property="couponGrantFlowType" >
        COUPON_GRANT_FLOW_TYPE
      </isNotNull>
      <isNotNull prepend="," property="operatingPerson" >
        OPERATING_PERSON
      </isNotNull>
      <isNotNull prepend="," property="createDate" >
        CREATE_DATE
      </isNotNull>
       <isNotNull prepend="," property="orderCode" >
       ORDER_CODE
      </isNotNull>
         <isNotNull prepend="," property="orderFlowCode" >
      ORDER_FLOW_CODE
      </isNotNull>
        <isNotNull prepend="," property="remark" >
      REMARK
      </isNotNull>
      <isNotNull prepend="," property="couponGrantId" >
       COUPON_GRANT_ID
      </isNotNull>
       <isNotNull prepend="," property="operatingPersonName" >
       OPERATING_PERSON_NAME
      </isNotNull>
      <isNotNull prepend="," property="couponId" >
       COUPON_ID
      </isNotNull>
       <isNotNull prepend="," property="couponName" >
       COUPON_NAME
      </isNotNull>
       <isNotNull prepend="," property="customId" >
       CUSTOM_ID
      </isNotNull>
       <isNotNull prepend="," property="customer" >
       CUSTOMER
      </isNotNull>
     
     
      )
    </dynamic>
    values
    <dynamic prepend="(" >
           <isNotNull prepend="," property="couponGrantFlowId" >
       #couponGrantFlowId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="couponGrantFlowType" >
        #couponGrantFlowType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="operatingPerson" >
        #operatingPerson:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="createDate" >
       #createDate:VARCHAR#
      </isNotNull>
       <isNotNull prepend="," property="orderCode" >
       #orderCode:VARCHAR#
      </isNotNull>
         <isNotNull prepend="," property="orderFlowCode" >
      #orderFlowCode:VARCHAR#
      </isNotNull>
        <isNotNull prepend="," property="remark" >
       #remark:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="couponGrantId" >
       #couponGrantId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="operatingPersonName" >
       #operatingPersonName:VARCHAR#
      </isNotNull>
       <isNotNull prepend="," property="couponId" >
       #couponId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="couponName" >
       #couponName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="customId" >
       #customId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="customer" >
       #customer:VARCHAR#
      </isNotNull>
     
      )
    </dynamic>
  </insert>
  <select id="abatorgenerated_countByExample" parameterClass="com.pltfm.app.vobject.CouponGrantFlowExample" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Jun 09 04:40:49 CST 2014.
    -->
    select count(1) from COUPON_GRANT_FLOW
    <include refid="KMPRODUCT_COUPON_GRANT_FLOW.abatorgenerated_Example_Where_Clause" />
  </select>
  <update id="abatorgenerated_updateByExampleSelective" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Jun 09 04:40:49 CST 2014.
    -->
    update COUPON_GRANT_FLOW
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.couponGrantFlowId" >
        COUPON_GRANT_FLOW_ID = #record.couponGrantFlowId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.couponGrantFlowType" >
        COUPON_GRANT_FLOW_TYPE = #record.couponGrantFlowType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.operatingPerson" >
        OPERATING_PERSON = #record.operatingPerson:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.createDate" >
        CREATE_DATE = #record.createDate:DATE#
      </isNotNull>
      <isNotNull prepend="," property="record.orderCode" >
        ORDER_CODE = #record.orderCode:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.orderFlowCode" >
        ORDER_FLOW_CODE = #record.orderFlowCode:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.remark" >
        REMARK = #record.remark:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.couponGrantId" >
        COUPON_GRANT_ID = #record.couponGrantId:DECIMAL#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="KMPRODUCT_COUPON_GRANT_FLOW.abatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="abatorgenerated_updateByExample" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Jun 09 04:40:49 CST 2014.
    -->
    update COUPON_GRANT_FLOW
    set COUPON_GRANT_FLOW_ID = #record.couponGrantFlowId:DECIMAL#,
      COUPON_GRANT_FLOW_TYPE = #record.couponGrantFlowType:DECIMAL#,
      OPERATING_PERSON = #record.operatingPerson:DECIMAL#,
      CREATE_DATE = #record.createDate:DATE#,
      ORDER_CODE = #record.orderCode:DECIMAL#,
      ORDER_FLOW_CODE = #record.orderFlowCode:DECIMAL#,
      REMARK = #record.remark:VARCHAR#,
      COUPON_GRANT_ID = #record.couponGrantId:DECIMAL#
    <isParameterPresent >
      <include refid="KMPRODUCT_COUPON_GRANT_FLOW.abatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <select id="selectlist" resultMap="abatorgenerated_CouponGrantFlowResult"
		parameterClass="com.pltfm.app.vobject.CouponGrantFlow">
		 select COUPON_GRANT_FLOW_ID,OPERATING_PERSON_NAME,CUSTOM_ID,CUSTOMER,COUPON_NAME,
		 COUPON_GRANT_FLOW_TYPE,OPERATING_PERSON,CREATE_DATE,ORDER_CODE,ORDER_FLOW_CODE,REMARK,COUPON_GRANT_ID,COUPON_ID
		   from( select ROW_NUMBER() OVER(order by COUPON_GRANT_FLOW_ID desc) as view_row_number,COUPON_GRANT_FLOW_ID,OPERATING_PERSON_NAME,CUSTOM_ID,CUSTOMER,COUPON_NAME,
		 COUPON_GRANT_FLOW_TYPE,OPERATING_PERSON,CREATE_DATE,ORDER_CODE,ORDER_FLOW_CODE,REMARK,COUPON_GRANT_ID,COUPON_ID
		  
    from COUPON_GRANT_FLOW where 1=1
    <dynamic>
			<isNotNull property="orderCode" prepend="and">
				ORDER_CODE like '%$orderCode$%'
			
			</isNotNull>
			<isNotNull property="couponGrantId" prepend="and">
				COUPON_GRANT_ID like '%$couponGrantId$%'
			</isNotNull>
			<isNotNull property="couponGrantFlowType" prepend="and">
				COUPON_GRANT_FLOW_TYPE =
				$couponGrantFlowType$
			</isNotNull>
			
		</dynamic>
		 )
    WHERE view_row_number between #skip# and #max#  
		
	</select>
	<select id="getCouponName" parameterClass="java.lang.Long" resultClass="com.pltfm.app.vobject.Coupon">
	 select COUPON_NAME,COUPON_ID from COUPON where COUPON_ID = #couponId#
	</select> 
	 <select id="getCount" resultClass="java.lang.Integer" 
		parameterClass="com.pltfm.app.vobject.CouponGrantFlow">
		  select count(p.COUPON_GRANT_FLOW_ID) the_count 
    from COUPON_GRANT_FLOW p where 1=1
    <dynamic>
			<isNotNull property="orderCode" prepend="and">
				p.ORDER_CODE  like '%$orderCode$%'
				
			</isNotNull>
			<isNotNull property="couponGrantId" prepend="and">
				p.COUPON_GRANT_ID like '%$couponGrantId$%'
			</isNotNull>
			<isNotNull property="couponGrantFlowType" prepend="and">
				COUPON_GRANT_FLOW_TYPE =
				$couponGrantFlowType$
			</isNotNull>
		</dynamic>
		 ORDER  BY   p.COUPON_GRANT_FLOW_ID DESC  
		
	</select>
	 
  	
</sqlMap>