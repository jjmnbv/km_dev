<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="PRODUCT_SKU" >
	<typeAlias alias="Product" type="com.pltfm.app.vobject.Product"/>
	<typeAlias alias="ProductSku" type="com.pltfm.app.vobject.ProductSku"/>
  <resultMap id="countResult" class="com.pltfm.sys.model.SysModelUtil">
    <result column="the_count" property="theCount" jdbcType="DECIMAL" />
  </resultMap>
  <resultMap id="searchPageByVoMap" class="com.pltfm.app.vobject.ProductSku" >
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
    <result column="PROCUCT_NAME" property="productName" jdbcType="VARCHAR"/>
    <result column="product_title" property="productTitle" jdbcType="VARCHAR"/>
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIT_WEIGHT" property="unitWeight" jdbcType="DECIMAL" />
    <result column="MARK_PRICE" property="markPrice" jdbcType="DECIMAL" />
  </resultMap>
  
   <resultMap id="skuIdAndCode" class="com.pltfm.app.vobject.ProductSku" >
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="LONG" />
        <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL"/>
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
  </resultMap>
  
  
  <resultMap id="ibatorgenerated_BaseResultMap" class="com.pltfm.app.vobject.ProductSku" >
    <!-- 
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL"/>
    <result column="PRICE" property="price" jdbcType="DOUBLE" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIT_WEIGHT" property="unitWeight" jdbcType="DECIMAL" />
	<result column="MARK_PRICE" property="markPrice" jdbcType="DECIMAL" />
	<result column="COST_PRICE" property="costPrice" jdbcType="DECIMAL" />
  </resultMap>
  
  <resultMap id="ibatorgenerated_BaseResultMapForIntroduce" class="com.pltfm.app.vobject.ProductSku" >
    <!-- 
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL"/>
    <result column="PRICE" property="price" jdbcType="DOUBLE" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIT_WEIGHT" property="unitWeight" jdbcType="DECIMAL" />
	<result column="MARK_PRICE" property="markPrice" jdbcType="DECIMAL" />
	<result column="COST_PRICE" property="costPrice" jdbcType="DECIMAL" />
	<result column="PV_VALUE" property="pvValue" jdbcType="DECIMAL" />
	<result column="COST_INCOME_RATIO" property="costIncomeRatio" jdbcType="DECIMAL" />
	<result column="SKU_INTRODUCE" property="skuIntroduce" jdbcType="VARCHAR" />
    <result column="SKU_INTRODUCELAZY" property="skuIntroduceLazy" jdbcType="VARCHAR" />
    <result column="FREIGHT" property="freight" jdbcType="DECIMAL" />
	<result column="FREE_STATUS" property="freeStatus" jdbcType="VARCHAR" />
	<result column="STOCK" property="stock" jdbcType="DECIMAL" />
	<result column="SELLER_SKU_CODE" property="sellerSkuCode" jdbcType="DECIMAL" />
	<result column="SKU_BAR_CODE" property="skuBarCode" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="ibatorgenerated_BaseResultMap3" class="com.pltfm.app.vobject.ProductSku" >
  	<result column="PRODUCT_TITLE" property="productTitle" jdbcType="VARCHAR" />
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL"/>
    <result column="PRICE" property="price" jdbcType="DOUBLE" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIT_WEIGHT" property="unitWeight" jdbcType="DECIMAL" />
	<result column="MARK_PRICE" property="markPrice" jdbcType="DECIMAL" />
	<result column="COST_PRICE" property="costPrice" jdbcType="DECIMAL" />
	<result column="PV_VALUE" property="pvValue" jdbcType="DECIMAL" />
	<result column="COST_INCOME_RATIO" property="costIncomeRatio" jdbcType="DECIMAL" />
	<result column="SKU_INTRODUCE" property="skuIntroduce" jdbcType="VARCHAR" />
    <result column="SKU_INTRODUCELAZY" property="skuIntroduceLazy" jdbcType="VARCHAR" />
    <result column="FREIGHT" property="freight" jdbcType="DECIMAL" />
	<result column="FREE_STATUS" property="freeStatus" jdbcType="VARCHAR" />
	<result column="SKU_BAR_CODE" property="skuBarCode" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="ibatorgenerated_BaseResultMap2" class="com.pltfm.app.vobject.ProductSku" >
    <!-- 
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL"/>
    <result column="PRODUCT_ID" property="product" select="PRODUCT_SKU.loadProductById"/>
    <result column="PRICE" property="price" jdbcType="DOUBLE" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIT_WEIGHT" property="unitWeight" jdbcType="DECIMAL" />
	<result column="MARK_PRICE" property="markPrice" jdbcType="DECIMAL" />
	<result column="STOCK" property="stock" jdbcType="DECIMAL" />
  </resultMap>
  
  <!-- SKU查找产品信息 -->
  <resultMap id="ProductResultMap" class="com.pltfm.app.vobject.Product" >
    <result column="PRODUCT_ID" property="id" jdbcType="DECIMAL" />
    <result column="CATEGORY_ID" property="categoryId" jdbcType="DECIMAL" />
    <result column="PROCUCT_NAME" property="name" jdbcType="VARCHAR" />
    <result column="PRODUCT_DESC" property="productDesc" jdbcType="VARCHAR" />
    <result column="PACK_LISTING" property="packListing" jdbcType="VARCHAR" />
    <result column="PRODUCT_TITLE" property="productTitle" jdbcType="VARCHAR" />
    <result column="KEYWORD" property="keyword" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="CREATE_USER" property="createUser" jdbcType="INTEGER" />
    <result column="CREATE_USER_NAME" property="createUserName" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="Date" />
    <result column="PRODUCTHOT" property="productHot" jdbcType="DECIMAL" />
    <result column="ARCHIVE_TIME" property="archiveTime" jdbcType="Date" />
    <result column="CHECK_USER" property="checkUser" jdbcType="INTEGER" />
    <result column="CHECK_USER_NAME" property="checkUserName" jdbcType="VARCHAR" />
    <result column="CHECK_TIME" property="checkTime" jdbcType="Date" />
    <result column="MODIF_TIME" property="modifTime" jdbcType="Date" />
    <result column="SHOP_CODE" property="shopCode" jdbcType="VARCHAR" />
    <result column="MODIF_USER" property="modifUser" jdbcType="INTEGER" />
    <result column="UP_TIME" property="upTime" jdbcType="Date" />
    <result column="MARKET_PRICE"  property="marketPrice" jdbcType="BigDecimal"/>
    <result column="COST_PRICE"  property="costPrice" jdbcType="BigDecimal"/>
    <result column="PRODUCT_NO" property="productNo" jdbcType="VARCHAR" />
    <result column="BRAND_ID" property="brandId" jdbcType="DECIMAL" />
    <result column="BRAND_NAME" property="brandName" jdbcType="VARCHAR" />
    <result column="APPROVAL_TYPE" property="approvalType" jdbcType="VARCHAR" />
    <result column="APPROVAL_NO" property="approvalNo" jdbcType="VARCHAR" />
    <result column="CATEGORY_NAME" property="categoryName" jdbcType="VARCHAR" />
  </resultMap>


  
  
  <sql id="ibatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="ibatorgenerated_selectByExample" resultMap="ibatorgenerated_BaseResultMapForIntroduce" parameterClass="com.pltfm.app.vobject.ProductSkuExample" >
    select PRODUCT_SKU_ID, PRODUCT_ID, PRICE, PRODUCT_SKU_CODE,STATUS,UNIT_WEIGHT,MARK_PRICE,COST_PRICE,PV_VALUE,COST_INCOME_RATIO,SKU_INTRODUCE,SKU_INTRODUCELAZY,FREIGHT,FREE_STATUS,STOCK,SELLER_SKU_CODE,SKU_BAR_CODE  
    from PRODUCT_SKU
    <isParameterPresent >
      <include refid="PRODUCT_SKU.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMapForIntroduce" parameterClass="com.pltfm.app.vobject.ProductSku" >
    select PRODUCT_SKU_ID, PRODUCT_ID, PRICE, PRODUCT_SKU_CODE,STATUS,UNIT_WEIGHT,MARK_PRICE,COST_PRICE,PV_VALUE,COST_INCOME_RATIO,SKU_INTRODUCE,SKU_INTRODUCELAZY,FREIGHT,FREE_STATUS,STOCK,SELLER_SKU_CODE,SKU_BAR_CODE    
    from PRODUCT_SKU
    where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
  </select>
  <delete id="ibatorgenerated_deleteByExample" parameterClass="com.pltfm.app.vobject.ProductSkuExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    delete from PRODUCT_SKU
    <include refid="PRODUCT_SKU.ibatorgenerated_Example_Where_Clause" />
  </delete>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.pltfm.app.vobject.ProductSku" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Sep 29 17:47:38 CST 2013.
    -->
    delete from PRODUCT_SKU
    where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.pltfm.app.vobject.ProductSku" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    <selectKey resultClass="java.lang.Long" keyProperty="productSkuId" >
      select SEQ_APP_PRODUCT_SKU.nextval from dual
    </selectKey>
    insert into PRODUCT_SKU (PRODUCT_SKU_ID, PRODUCT_ID, PRICE, PRODUCT_SKU_CODE,STATUS,UNIT_WEIGHT,MARK_PRICE,MODIF_TIME,CREATE_TIME)
    values (#productSkuId:DECIMAL#, #productId:DECIMAL#, #price:DOUBLE#, 
      #productSkuCode:VARCHAR#,#status:CHAR#, #unitWeight:DECIMAL#, #markPrice:DECIMAL#,sysdate,sysdate))
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.pltfm.app.vobject.ProductSku" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    insert into PRODUCT_SKU
    <dynamic prepend="(" >
      <isNotNull prepend="," property="productSkuId" >
        PRODUCT_SKU_ID
      </isNotNull>
      <isNotNull prepend="," property="productId" >
        PRODUCT_ID
      </isNotNull>
      <isNotNull prepend="," property="price" >
        PRICE
      </isNotNull>
      <isNotNull prepend="," property="productSkuCode" >
        PRODUCT_SKU_CODE
      </isNotNull>
       <isNotNull prepend="," property="status" >
        STATUS
      </isNotNull>
      <isNotNull prepend="," property="unitWeight">
        UNIT_WEIGHT
      </isNotNull>
      <isNotNull prepend="," property="markPrice">
        MARK_PRICE
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="productSkuId" >
        #productSkuId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productId" >
        #productId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="price" >
        #price:DOUBLE#
      </isNotNull>
      <isNotNull prepend="," property="productSkuCode" >
        #productSkuCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        #status:CHAR#
      </isNotNull>
       <isNotNull prepend="," property="unitWeight" >
        #unitWeight:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="markPrice">
        #markPrice:DECIMAL#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <select id="ibatorgenerated_countByExample" parameterClass="com.pltfm.app.vobject.ProductSkuExample" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    select count(1) from PRODUCT_SKU
    <include refid="PRODUCT_SKU.ibatorgenerated_Example_Where_Clause" />
  </select>
  <update id="ibatorgenerated_updateByExampleSelective" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    update PRODUCT_SKU
    <dynamic prepend="set" >
        MODIF_TIME=sysdate,
      <isNotNull prepend="," property="record.productSkuId" >
        PRODUCT_SKU_ID = #record.productSkuId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.productId" >
        PRODUCT_ID = #record.productId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.price" >
        PRICE = #record.price:DOUBLE#
      </isNotNull>
      <isNotNull prepend="," property="record.productSkuCode" >
        PRODUCT_SKU_CODE = #record.productSkuCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.status" >
        STATUS = #record.status:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.unitWeight">
        UNIT_WEIGHT = #record.unitWeight:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.markPrice">
        MARK_PRICE = #record.markPrice:DECIMAL#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="PRODUCT_SKU.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.pltfm.app.vobject.ProductSku" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 25 15:26:13 CST 2015.
    -->
    update PRODUCT_SKU
    <dynamic prepend="set" >
        MODIF_TIME=sysdate,
      <isNotNull prepend="," property="productId" >
        PRODUCT_ID = #productId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="price" >
        PRICE = #price:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productSkuCode" >
        PRODUCT_SKU_CODE = #productSkuCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS = #status:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="unitWeight" >
        UNIT_WEIGHT = #unitWeight:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="markPrice" >
        MARK_PRICE = #markPrice:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="costPrice" >
        COST_PRICE = #costPrice:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="pvValue" >
        PV_VALUE = #pvValue:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="costIncomeRatio" >
        COST_INCOME_RATIO = #costIncomeRatio:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="freight" >
        FREIGHT = #freight:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="freeStatus" >
        FREE_STATUS = #freeStatus:VARCHAR#
      </isNotNull>
    </dynamic>
    where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
  </update>
  
  <update id="ibatorgenerated_updateByExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    --> 
    update PRODUCT_SKU
    set PRODUCT_SKU_ID = #record.productSkuId:DECIMAL#,
      PRODUCT_ID = #record.productId:DECIMAL#,
      PRICE = #record.price:DOUBLE#,
      PRODUCT_SKU_CODE = #record.productSkuCode:VARCHAR#,
      STATUS = #record.status:CHAR#,
      UNIT_WEIGHT = #record.unitWeight:DECIMAL#,
      MARK_PRICE = #record.markPrice:DECIMAL#,
      MODIF_TIME=sysdate
    <isParameterPresent >
      <include refid="PRODUCT_SKU.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  
   <!-- 根据SKUId，查找产品信息   -->
    <resultMap id="SKU_resultMap" class="com.pltfm.app.vobject.ProductAndSku" >
	    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL" />
	    <result column="CATEGORY_ID" property="categoryId" jdbcType="DECIMAL" />
	    <result column="PROCUCT_NAME" property="name" jdbcType="VARCHAR" />
	    <result column="PRODUCT_DESC" property="productDesc" jdbcType="VARCHAR" />
	    <result column="PACK_LISTING" property="packListing" jdbcType="VARCHAR" />
	    <result column="PRODUCT_TITLE" property="productTitle" jdbcType="VARCHAR" />
	    <result column="KEYWORD" property="keyword" jdbcType="VARCHAR" />
	    <result column="STATUS" property="status" jdbcType="VARCHAR" />
	    <result column="PRODUCTHOT" property="productHot" jdbcType="DECIMAL" />
	    <result column="CHECK_USER" property="checkUser" jdbcType="INTEGER" />
	    <result column="CHECK_USER_NAME" property="checkUserName" jdbcType="VARCHAR" />
	    <result column="CHECK_TIME" property="checkTime" jdbcType="Date" />
	    <result column="MODIF_TIME" property="modifTime" jdbcType="Date" />
	    <result column="SHOP_CODE" property="shopCode" jdbcType="VARCHAR" />
	    <result column="MODIF_USER" property="modifUser" jdbcType="INTEGER" />
	    <result column="UP_TIME" property="upTime" jdbcType="Date" />
	    <result column="MARKET_PRICE"  property="marketPrice" jdbcType="BigDecimal"/>
	    <result column="COST_PRICE"  property="costPrice" jdbcType="BigDecimal"/>
	    <result column="PRICE"  property="price" jdbcType="BigDecimal"/>
	    <result column="PRODUCT_NO" property="productNo" jdbcType="VARCHAR" />
	    <result column="BRAND_ID" property="brandId" jdbcType="DECIMAL" />
	    <result column="BRAND_NAME" property="brandName" jdbcType="VARCHAR" />
	    <result column="APPROVAL_TYPE" property="approvalType" jdbcType="VARCHAR" />
	    <result column="APPROVAL_NO" property="approvalNo" jdbcType="VARCHAR" />
	    <result column="CATEGORY_NAME" property="categoryName" jdbcType="VARCHAR" />
	    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
	    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
  </resultMap>
    
  <select id="findProductInfoBySkuCode" parameterClass="java.lang.String" resultMap="SKU_resultMap">
  	SELECT p.PRODUCT_ID,p.CATEGORY_ID,p.PRODUCT_DESC,p.PROCUCT_NAME,p.PACK_LISTING,p.PRODUCT_TITLE
		  	,p.KEYWORD,p.STATUS,p.PRODUCTHOT,p.CHECK_USER,p.CHECK_USER_NAME,p.CHECK_TIME,p.MODIF_TIME,p.SHOP_CODE
		  	,p.MODIF_USER,p.UP_TIME,p.MARKET_PRICE,p.COST_PRICE,s.PRICE, p.PRODUCT_NO,p.BRAND_ID,p.BRAND_NAME
		  	,p.APPROVAL_TYPE,p.APPROVAL_NO,p.CATEGORY_NAME,s.PRODUCT_SKU_ID,s.PRODUCT_SKU_CODE
    FROM PRODUCT_SKU s,productmain p    
    where s.PRODUCT_ID = p.PRODUCT_ID AND  s.PRODUCT_SKU_CODE =  #productSkuCode#
  </select>
  
  <select id="findProductListBySkuCodeList" parameterClass="java.util.ArrayList" resultMap="SKU_resultMap">
  	SELECT p.PRODUCT_ID,p.CATEGORY_ID,p.PRODUCT_DESC,p.PROCUCT_NAME,p.PACK_LISTING,p.PRODUCT_TITLE
		  	,p.KEYWORD,p.STATUS,p.PRODUCTHOT,p.CHECK_USER,p.CHECK_USER_NAME,p.CHECK_TIME,p.MODIF_TIME,p.SHOP_CODE
		  	,p.MODIF_USER,p.UP_TIME,p.MARKET_PRICE,p.COST_PRICE,s.PRICE, p.PRODUCT_NO,p.BRAND_ID,p.BRAND_NAME
		  	,p.APPROVAL_TYPE,p.APPROVAL_NO,p.CATEGORY_NAME,s.PRODUCT_SKU_ID,s.PRODUCT_SKU_CODE
    FROM PRODUCT_SKU s,productmain p    
    where s.PRODUCT_ID = p.PRODUCT_ID
    AND  s.PRODUCT_SKU_CODE IN
	   <iterate  open="(" close=")" conjunction=","  >
	   #productSkuCodeList[].skuCode# 
	   </iterate>
  </select>
  
  <select id="findProductSkuBySkuCodes" parameterClass="java.util.ArrayList" resultMap="ibatorgenerated_BaseResultMap2">
  	SELECT * FROM PRODUCT_SKU WHERE 1=1 
    <dynamic prepend="AND">
   		<iterate open="(" close=")" conjunction=" OR ">
   			PRODUCT_SKU_CODE = #productSkuCodeList[]#  
   		</iterate>
   	</dynamic>
  </select>
  
  <select id="loadProductById" parameterClass="java.lang.Long" resultMap="ProductResultMap">
  	select * from productmain where product_id = #value# 
  </select>
  
  <select id="findProductInfoBySkuId" parameterClass="java.lang.Long" resultMap="SKU_resultMap">
  	SELECT p.PRODUCT_ID,p.CATEGORY_ID,p.PRODUCT_DESC,p.PROCUCT_NAME,p.PACK_LISTING,p.PRODUCT_TITLE
		  	,p.KEYWORD,p.STATUS,p.PRODUCTHOT,p.CHECK_USER,p.CHECK_USER_NAME,p.CHECK_TIME,p.MODIF_TIME,p.SHOP_CODE
		  	,p.MODIF_USER,p.UP_TIME,p.MARKET_PRICE,p.COST_PRICE,p.PRODUCT_NO,p.BRAND_ID,p.BRAND_NAME
		  	,p.APPROVAL_TYPE,p.APPROVAL_NO,p.CATEGORY_NAME,s.PRODUCT_SKU_ID,s.PRODUCT_SKU_CODE,s.price
    FROM PRODUCT_SKU s join productmain p on s.PRODUCT_ID = p.PRODUCT_ID 
	where s.PRODUCT_SKU_ID =  #productSkuId#
  </select>
  
  
  <update id="updatePriceByPrimaryKey" parameterClass="com.pltfm.app.vobject.ProductSku" >
  	update PRODUCT_SKU
    set PRICE = #price:DOUBLE#,MARK_PRICE = #markPrice:DOUBLE#,MODIF_TIME=sysdate
    where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
  </update>
  
  <update id="updateWeightByPrimaryKey" parameterClass="com.pltfm.app.vobject.ProductSku">
  	update PRODUCT_SKU
    set UNIT_WEIGHT = #unitWeight:DOUBLE#,MODIF_TIME=sysdate
    where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
  </update>
  
  <update id="updateStock" parameterClass="com.pltfm.app.vobject.ProductStock">
  	update PRODUCT_SKU
    set stock = #stockQuality:DOUBLE#,MODIF_TIME=sysdate
    where PRODUCT_SKU_ID = #skuAttributeId:DECIMAL#
  </update>
  
  
   <!--  ****************  search page by vo  ****************  -->
  <select id="searchPageByVo" resultMap="searchPageByVoMap" parameterClass="com.pltfm.app.vobject.ProductSku">
    select PROCUCT_NAME, PRODUCT_SKU_CODE, PRODUCT_SKU_ID,STATUS,UNIT_WEIGHT,MARK_PRICE,product_title
    FROM (
    select  ROW_NUMBER() OVER(order by PRODUCT_SKU_ID desc) as view_row_number, PROCUCT_NAME, 
    PRODUCT_SKU_CODE, PRODUCT_SKU_ID,sku.STATUS,sku.UNIT_WEIGHT,sku.MARK_PRICE ,p.product_title
    from PRODUCT_SKU sku join PRODUCTMAIN p on sku.product_id = p.product_id
  	left join suppliers_info sup on TO_CHAR(supplier_id) = p.shop_code
    where (p.STATUS = 3 or  p.STATUS = 4 )
    <dynamic>
      <isNotEmpty prepend="and" property="productSkuId" >
        PRODUCT_SKU_ID = #ProductSkuId:DECIMAL#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="productSkuCode" >
        PRODUCT_SKU_CODE like '%$productSkuCode$%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="productName" >
        PROCUCT_NAME like '%$productName$%'
      </isNotEmpty>
       <isNotEmpty prepend="and" property="productTitle" >
        p.product_title like '%$productTitle$%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="categoryId" >
        category_id = #categoryId#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="brandId" >
        brand_id = #brandId#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="product.shopCode" >
        p.SHOP_CODE = #product.shopCode#
      </isNotEmpty>
      <!-- suppliers_info  里的 supplier_id字段？ -->
       <isEqual compareValue="3" prepend="and" property="product.suppliterType" >
        (sup.SUPPLIER_TYPE = 3 or sup.SUPPLIER_TYPE = 1 or  p.SHOP_CODE = '221')
      </isEqual>
    </dynamic>
    )
    WHERE view_row_number between #skip# and #max#
	</select>


 <!-- **************** search user's roleList by vo  ****************  -->
  <select id="getProductSkuCount" parameterClass="com.pltfm.app.vobject.ProductSku" resultClass="java.lang.Integer">
     select count(1) the_count from PRODUCT_SKU sku join PRODUCTMAIN p on sku.product_id = p.product_id 
     left join suppliers_info sup on TO_CHAR(supplier_id) = p.shop_code
      where (p.STATUS = 3 or  p.STATUS = 4 )
    <dynamic>
      <isNotEmpty prepend="and" property="productSkuId" >
        PRODUCT_SKU_ID = #ProductSkuId:DECIMAL#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="productSkuCode" >
        PRODUCT_SKU_CODE like '%$productSkuCode$%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="productName" >
        PROCUCT_NAME like '%$productName$%'
      </isNotEmpty>
       <isNotEmpty prepend="and" property="productTitle" >
        PRODUCT_TITLE like '%$productTitle$%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="categoryId" >
        category_id = #categoryId#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="brandId" >
        brand_id = #brandId#
      </isNotEmpty>
       <isNotEmpty prepend="and" property="product.shopCode" >
        p.SHOP_CODE = #product.shopCode#
      </isNotEmpty>
       <!-- suppliers_info  里的 supplier_id字段？ -->
       <isEqual compareValue="3" prepend="and" property="product.suppliterType" >
        (sup.SUPPLIER_TYPE = 3 or sup.SUPPLIER_TYPE = 1 or  p.SHOP_CODE = '221')
      </isEqual>
    </dynamic>
  </select>
  
    
    <select id="getSkuIdAndCodeMap"  parameterClass="java.util.ArrayList" resultMap="skuIdAndCode" >
    select   s.product_sku_id,s.product_sku_code,s.product_id  from product_sku s
    where s.product_sku_id in
	   <iterate open="(" close=")" conjunction=" , "  >
	    #[]#
	   </iterate>
    </select>
    
    
  
  
    <select id="selectSkuBySkuCode"  parameterClass="com.pltfm.app.vobject.ProductSku"  resultMap="ibatorgenerated_BaseResultMap" >
  select PRODUCT_SKU_ID, PRODUCT_ID, PRICE, PRODUCT_SKU_CODE,STATUS,UNIT_WEIGHT,MARK_PRICE,COST_PRICE 
    from PRODUCT_SKU where product_sku_code =#productSkuCode# and status=1
    </select>
  
  	<!-- 根据产品ID集合，查询其所有SKUID集合 -->
  	<select id="selectSkuIdsByProductIdList" resultClass="java.lang.Long" parameterClass="java.util.ArrayList">
  		select PRODUCT_SKU_ID  from PRODUCT_SKU WHERE
  		<dynamic>
    		<iterate open="(" close=")" conjunction=" OR ">
    			PRODUCT_ID = #productIdList[]# 
    		</iterate>
    	</dynamic>
  	</select>
  
  
  <select id="findMaxSkuCodeByCateCode" resultClass="java.lang.String" parameterClass="java.lang.String" >
  	select max(t.product_sku_code) from PRODUCT_SKU t where t.product_sku_code like '$cateCode$__%'
  </select>
  
  <update id="updateSkuStatus" parameterClass="java.lang.Long">
  	update PRODUCT_SKU set STATUS = 0,MODIF_TIME=sysdate where PRODUCT_SKU_ID = #productSkuId#
  </update>
  
  <!-- 20140918 maliqun add begin -->
  <update id="updateSkuOnlyUnitWeight" parameterClass="com.pltfm.app.vobject.ProductSku" >
  	update PRODUCT_SKU
    set 
      UNIT_WEIGHT = #unitWeight:DECIMAL#,MODIF_TIME=sysdate
      
    where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
  </update>
   <!-- 20140918 maliqun add begin -->
   
   <select id="findSameSkuBarCodeProductSku" parameterClass="java.util.Map" resultMap="ibatorgenerated_BaseResultMap3" >
  	select pd.PRODUCT_TITLE,psd.PRODUCT_SKU_ID, psd.PRODUCT_ID, psd.PRODUCT_SKU_CODE, psd.MARK_PRICE, psd.PRICE, psd.UNIT_WEIGHT, psd.PV_VALUE, psd.COST_INCOME_RATIO, psd.STATUS,
      psd.FREIGHT,psd.FREE_STATUS,psd.COST_PRICE,psd.SKU_INTRODUCE,psd.SKU_INTRODUCELAZY,psd.SKU_BAR_CODE 
    from PRODUCT_SKU psd,PRODUCTMAIN pd where psd.PRODUCT_ID = pd.PRODUCT_ID
    <dynamic prepend="AND">
    	<iterate open="(" close=")" conjunction=" OR " property="skuDraftList">
			(PRODUCT_SKU_ID != #skuDraftList[].productSkuId:DECIMAL# AND SKU_BAR_CODE = #skuDraftList[].skuBarCode:VARCHAR#) 
		</iterate>
	</dynamic>
  </select>
  	<!-- 根据对接系统产品编号查询sku信息 20151023 add  尚未过滤掉无效的sku-->
	<select id="querySkuByEprProCode" resultClass="com.pltfm.app.vobject.ProductSku" parameterClass="java.util.Map">
		select product_sku_id productSkuId, product_id productId, price price, product_sku_code productSkuCode, status status,sku_bar_code skuBarCode from product_sku where product_sku_id in(select product_sku_id from product_erp_relation where sys_code=#sysCode:VARCHAR# and erp_pro_code=#erpProCode:VARCHAR#)
	</select>


    <!-- SKU查找产品信息 -->
    <resultMap id="ProductSkuDetailsMap" class="java.util.HashMap" >
        <result column="productID" property="productID" javaType="java.lang.String"/>
        <result column="productSkuId" property="productSkuId" javaType="java.lang.String"/>
        <result column="productSkuCode" property="productSkuCode" javaType="java.lang.String"/>
        <result column="unitWeight" property="unitWeight" javaType="java.lang.String"/>
        <result column="price" property="price" javaType="java.lang.String"/>
        <result column="finalPrice" property="costPrice" javaType="java.lang.String"/>
        <result column="costPrice" property="costPrice" javaType="java.lang.String"/>
        <result column="marketPrice" property="marketPrice" javaType="java.lang.String"/>
        <result column="pvalue" property="pvalue" javaType="java.lang.String"/>
        <result column="freight" property="freight" javaType="java.lang.String"/>
        <result column="freeStatus" property="freeStatus" javaType="java.lang.String"/>
        <result column="erpProCode" property="erpProCode" javaType="java.lang.String"/>
        <result column="erpSysCode" property="erpSysCode" javaType="java.lang.String"/>
        <result column="jxcCode" property="jxcCode" javaType="java.lang.String"/>
        <result column="costIncomeRatio" property="costIncomeRatio" javaType="java.lang.String"/>
        <result column="costIncomeMoney" property="costIncomeMoney" javaType="java.lang.String"/>
        <result column="skuStatus" property="skuStatus" javaType="java.lang.String"/>
        <result column="productStatus" property="productStatus" javaType="java.lang.String"/>
        <result column="title" property="title" javaType="java.lang.String"/>
        <result column="name" property="name" javaType="java.lang.String"/>
        <result column="productDesc" property="productDesc" javaType="java.lang.String"/>
        <result column="productNo" property="productNo" javaType="java.lang.String"/>
        <result column="imagePath"  property="imagePath" javaType="java.lang.String"/>
        <result column="supplierCode"  property="supplierCode" javaType="java.lang.String"/>
        <result column="sellerId" property="sellerId" javaType="java.lang.String"/>
        <result column="categoryId" property="categoryId" javaType="java.lang.String"/>
        <result column="brandId" property="brandId" javaType="java.lang.String"/>
        <result column="brandName" property="brandName" javaType="java.lang.String"/>
        <result column="credits" property="credits" javaType="java.lang.String"/>
        <result column="batchNo" property="batchNo" javaType="java.lang.String"/>
        <result column="productType" property="productType" javaType="java.lang.String"/>
        <result column="shopName" property="shopName" javaType="java.lang.String"/>
        <result column="stockCount" property="stockCount" javaType="java.lang.String"/>
        <result column="supplierType" property="supplierType" javaType="java.lang.String"/>
        <result column="skuAttrValue" property="skuAttrValue" javaType="java.lang.String"/>
    </resultMap>

    <!-- 批量查询商品信息 -->
    <select id="getProductSkuDetailsMap"  resultMap="ProductSkuDetailsMap">
        <![CDATA[
		select s.product_id productID,
		       s.product_sku_id productSkuId,
		       s.product_sku_code productSkuCode,
		       s.unit_weight unitWeight,
		       nvl(s.price, 0) price,
		       nvl(s.price, 0) finalPrice,
		       s.cost_price costPrice,
		       s.mark_price marketPrice,
		       s.pv_value pvalue,
		       nvl(s.freight, 0) freight,
		       to_number(s.free_status) freeStatus,
		       erp.erp_pro_code erpProCode,
		       erp.sys_code erpSysCode,
		       (select erpi.erp_pro_code
		          from product_erp_relation erpi
		         where erpi.product_sku_id = s.product_sku_id
		           and erpi.sys_code = 'JXC') jxcCode,
		       s.cost_income_ratio costIncomeRatio,
		       s.cost_income_ratio costIncomeMoney,
		       s.status skuStatus,
		       m.status productStatus,
		       m.product_title title,
		       m.procuct_name name,
		       m.product_desc productDesc,
		       m.product_no productNo,
		       i.img_path imagePath,
		       m.shop_code supplierCode,
		       m.shop_code sellerId,
		       m.category_id categoryId,
		       m.brand_id brandId,
		       m.brand_name brandName,
		       0 credits,
		       '' batchNo,
		       nvl(m.product_type, 0) productType,
		       nvl((select smi.shop_name
		             from shop_main smi
		            where smi.audit_status = 2
		              and smi.supplier_id = si.supplier_id),
		           (select ctbi.corporate_name
		              from commercial_tenant_basic_info ctbi
		             where ctbi.n_commercial_tenant_id = si.merchant_id)) shopName,
		       (select max(st.stock_quality - (case
		                     when st.order_quality < 0 then
		                      0 else st.order_quality end)) productStockSum
		          from product_stock st
		         where st.sku_attribute_id = s.product_sku_id
		           and st.stock_quality > 0) stockCount,
		       si.supplier_type supplierType,
		       (select wmsys.wm_concat(vsa.category_attr_value)
		          from (select nvl(d.category_attr_value,b.new_attr) category_attr_value,b.product_sku_id
		          		from product_sku_attr b
		 				left join category_attr_value d on b.category_attr_value_id = d.category_attr_value_id) vsa
		         where vsa.product_sku_id = s.product_sku_id) skuAttrValue
		  from product_sku s
		 inner join productmain m
		    on (m.product_id = s.product_id)
		 inner join suppliers_info si
		    on (si.supplier_id = to_number(m.shop_code))
		  left join product_image i
		    on (i.sku_id = s.product_sku_id and i.is_default = 0)
		  left join product_erp_relation erp
		    on (s.product_sku_id = erp.product_sku_id and erp.sys_code = 'JIEKE')
		    ]]>
        <dynamic prepend=" where s.product_sku_id in">
            <isNotEmpty>
                <iterate open="(" conjunction="," close=")">
                    #[]#
                </iterate>
            </isNotEmpty>
        </dynamic>
    </select>

    <resultMap id="couponProductMap" class="com.pltfm.app.vobject.CouponProduct" >
        <result column="COUPON_PRODUCT_ID" property="couponProductId" jdbcType="DECIMAL" />
        <result column="COUPON_ID" property="couponId" jdbcType="DECIMAL" />
        <result column="RELATED_ID" property="relatedId" jdbcType="VARCHAR" />
        <result column="RELATED_TYPE" property="relatedType" jdbcType="DECIMAL" />
    </resultMap>
    <select id="selectCouponProductBySkuId" parameterClass="java.lang.String" resultMap="couponProductMap">
        select * from COUPON_PRODUCT where RELATED_ID=#skuCode# and RELATED_TYPE=1
    </select>

</sqlMap>