<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="PRODUCT_SKU" >
	<typeAlias alias="Product" type="com.pltfm.app.vobject.Product"/>
	<typeAlias alias="ProductSku" type="com.pltfm.app.vobject.ProductSku"/>
  <resultMap id="searchPageByVoMap" class="com.pltfm.app.vobject.ProductSku" >
    <!-- 
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
    <result column="PROCUCT_NAME" property="productName" jdbcType="VARCHAR"/>
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIT_WEIGHT" property="unitWeight" jdbcType="DECIMAL" />
    <result column="MARK_PRICE" property="markPrice" jdbcType="DECIMAL" />
  </resultMap>
  
   <resultMap id="skuIdAndCode" class="com.pltfm.app.vobject.ProductSku" >
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="LONG" />
        <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL"/>
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="ibatorgenerated_BaseResultMap_NewAttr" class="com.pltfm.app.vobject.ProductSkuAttr">
    <result column="NEW_ATTR" property="newAttr" jdbcType="VARCHAR" />
    <result column="CATEGORY_ATTR_ID" property="categoryAttrId" jdbcType="DECIMAL" />
  </resultMap>
  
  
  <resultMap id="ibatorgenerated_BaseResultMap" class="com.pltfm.app.vobject.ProductSku" >
    <!-- 
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL"/>
    <result column="PRICE" property="price" jdbcType="DOUBLE" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="CHAR" />
    <result column="UNIT_WEIGHT" property="unitWeight" jdbcType="DECIMAL" />
	<result column="MARK_PRICE" property="markPrice" jdbcType="DECIMAL" />
	<result column="PV_VALUE" property="pvValue" jdbcType="DECIMAL" />
	<result column="STOCK" property="stock" jdbcType="DECIMAL" />
	<result column="SELLER_SKU_CODE" property="sellerSkuCode" jdbcType="VARCHAR" />
  </resultMap>
  
  <!-- SKU查找产品信息 -->
  <resultMap id="ProductResultMap" class="com.pltfm.app.vobject.Product" >
    <result column="PRODUCT_ID" property="id" jdbcType="DECIMAL" />
    <result column="CATEGORY_ID" property="categoryId" jdbcType="DECIMAL" />
    <result column="PROCUCT_NAME" property="name" jdbcType="VARCHAR" />
    <result column="PRODUCT_DESC" property="productDesc" jdbcType="VARCHAR" />
    <result column="PACK_LISTING" property="packListing" jdbcType="VARCHAR" />
    <result column="PRODUCT_TITLE" property="productTitle" jdbcType="VARCHAR" />
    <result column="KEYWORD" property="keyword" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="CREATE_USER" property="createUser" jdbcType="INTEGER" />
    <result column="CREATE_USER_NAME" property="createUserName" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="Date" />
    <result column="PRODUCTHOT" property="productHot" jdbcType="DECIMAL" />
    <result column="ARCHIVE_TIME" property="archiveTime" jdbcType="Date" />
    <result column="CHECK_USER" property="checkUser" jdbcType="INTEGER" />
    <result column="CHECK_USER_NAME" property="checkUserName" jdbcType="VARCHAR" />
    <result column="CHECK_TIME" property="checkTime" jdbcType="Date" />
    <result column="MODIF_TIME" property="modifTime" jdbcType="Date" />
    <result column="SHOP_CODE" property="shopCode" jdbcType="VARCHAR" />
    <result column="MODIF_USER" property="modifUser" jdbcType="INTEGER" />
    <result column="UP_TIME" property="upTime" jdbcType="Date" />
    <result column="MARKET_PRICE"  property="marketPrice" jdbcType="BigDecimal"/>
    <result column="COST_PRICE"  property="costPrice" jdbcType="BigDecimal"/>
    <result column="PRODUCT_NO" property="productNo" jdbcType="VARCHAR" />
    <result column="BRAND_ID" property="brandId" jdbcType="DECIMAL" />
    <result column="BRAND_NAME" property="brandName" jdbcType="VARCHAR" />
    <result column="APPROVAL_TYPE" property="approvalType" jdbcType="VARCHAR" />
    <result column="APPROVAL_NO" property="approvalNo" jdbcType="VARCHAR" />
    <result column="CATEGORY_NAME" property="categoryName" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="ibatorgenerated_BaseResultMap_SKUATTR" class="com.pltfm.app.vobject.ViewProductSku" >
    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL" />
    <result column="PROCUCT_NAME" property="procuctName" jdbcType="VARCHAR" />
    <result column="PRODUCT_NO" property="productNo" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
 	<result column="PRODUCT_SKU_ID" property="viewSkuAttrs" select="PRODUCT_SKU.querySKUAttr" />
  	<result column="PRICE" property="price" jdbcType="DOUBLE" />
  	<result column="unit_weight" property="unitWeight" jdbcType="DOUBLE" />
  	<result column="MARK_PRICE" property="markPrice" jdbcType="DOUBLE" />
  </resultMap>

  <resultMap id="BaseResultMapForFreight" class="com.pltfm.app.vobject.ViewProductSku" >
    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL" />
    <result column="PROCUCT_NAME" property="procuctName" jdbcType="VARCHAR" />
    <result column="PRODUCT_TITLE" property="productTitle" jdbcType="VARCHAR" />
    <result column="PRODUCT_NO" property="productNo" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
 	<result column="PRODUCT_SKU_ID" property="viewSkuAttrs" select="PRODUCT_SKU.querySKUAttr" />
  	<result column="PRICE" property="price" jdbcType="DOUBLE" />
  	<result column="unit_weight" property="unitWeight" jdbcType="DOUBLE" />
  	<result column="MARK_PRICE" property="markPrice" jdbcType="DOUBLE" />
  	<result column="SKU_COST_PRICE" property="skuCostPrice" jdbcType="DOUBLE" />
  	<result column="FREIGHT" property="freight" jdbcType="DOUBLE" />
  	<result column="FREE_STATUS" property="freeStatus" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="enableStockSkuResultMap" class="com.pltfm.app.vobject.ViewProductSku" >
    <result column="PRODUCT_ID" property="productId" jdbcType="DECIMAL" />
    <result column="PROCUCT_NAME" property="procuctName" jdbcType="VARCHAR" />    
    <result column="PRODUCT_NO" property="productNo" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="PRODUCT_TITLE" property="productTitle" jdbcType="VARCHAR" />
    <result column="PRODUCT_SKU_ID" property="productSkuId" jdbcType="DECIMAL" />
    <result column="PRODUCT_SKU_CODE" property="productSkuCode" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="skuAttrValue" class="com.pltfm.app.vobject.ViewSkuAttr" >
    <result column="CATEGORY_ATTR_NAME" property="categoryAttrName" jdbcType="VARCHAR" />
    <result column="CATEGORY_ATTR_VALUE" property="categoryAttrValue" jdbcType="VARCHAR" />
  </resultMap>
  
  <sql id="ibatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  
  <sql id="ibatorgenerated_Example_Where_Clause_View" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 15 14:32:43 CST 2013.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  
  <select id="ibatorgenerated_selectByExample" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.pltfm.app.vobject.ProductSkuExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 14:37:11 CST 2013.
    -->
    select PRODUCT_SKU_ID, PRODUCT_ID, PRICE, PRODUCT_SKU_CODE,STATUS,UNIT_WEIGHT,MARK_PRICE,PV_VALUE,psktmp.STOCK_QUALITY STOCK,SELLER_SKU_CODE
    from PRODUCT_SKU ps
    left join (select a.*, wi.WAREHOUSE_NAME
               from (select e.WAREHOUSE_ID,e.SKU_ATTRIBUTE_ID,e.STOCK_QUALITY,
                            row_number() over(partition by SKU_ATTRIBUTE_ID order by(stock_quality - order_quality) desc) rn
                       from product_stock e) a,
                    WAREHOUSE_INFO wi
              where a.rn = 1
                and a.WAREHOUSE_ID = wi.WAREHOUSE_ID) psktmp
    on psktmp.SKU_ATTRIBUTE_ID = ps.product_sku_id
    
    <isParameterPresent >
      <include refid="PRODUCT_SKU.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  
  <!-- 商品发布SKU列表记录数 -->
	<select id="selectCountForProductSkuByMerchantId" resultClass="java.lang.Integer" parameterClass="pagination">
           <![CDATA[
          SELECT COUNT(PRODUCT_SKU_ID) FROM (SELECT t.*, ROWNUM RN FROM (select * from VIEW_PRODUCT_SKU WHERE STATUS != -1   
		]]>
		<dynamic prepend="AND">
			 <![CDATA[
					  SHOP_CODE = #objCondition.supplierId:VARCHAR# 
				]]>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productName">
            <![CDATA[
					PROCUCT_NAME like '%'||#objCondition.productName:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productTitle">
            <![CDATA[
					PRODUCT_TITLE like '%'||#objCondition.productTitle:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productNo">
            <![CDATA[
					PRODUCT_NO like '%'||#objCondition.productNo:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productName">
            <![CDATA[
					PROCUCT_NAME like '%'||#objCondition.productName:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productSkuCode">
            <![CDATA[
					PRODUCT_SKU_CODE like '%'||#objCondition.productSkuCode:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.status">
            <![CDATA[
					STATUS = #objCondition.status:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.skuStatus">
            <![CDATA[
					sku_status = #objCondition.skuStatus:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
			<dynamic prepend="AND">
			<isNotEmpty property="objCondition.categoryId">
            <![CDATA[
					CATEGORY_ID = #objCondition.categoryId:DECIMAL#
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.mCategoryId">
            <![CDATA[
					CATEGORY_ID in (select CATEGORY_ID from CATEGORYS where PARENT_ID = #objCondition.mCategoryId:DECIMAL# ) 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.bCategoryId">
            <![CDATA[
			 CATEGORY_ID in (select sc.CATEGORY_ID from categorys sc
			inner join categorys mc on sc.parent_id=mc.category_id 
			inner join categorys bc on mc.parent_id=bc.category_id 
			where bc.category_id = #objCondition.bCategoryId:DECIMAL# ) 
				]]>
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		) t )  
		]]>
	</select>
	<!-- 商品发布SKU列表记录数，促销专用 -->
	<select id="selectCountForProductSkuByMerchantIdForPromotion" resultClass="java.lang.Integer" parameterClass="pagination">
           <![CDATA[
          SELECT COUNT(PRODUCT_SKU_ID) FROM (SELECT t.*, ROWNUM RN FROM (select * from VIEW_PRODUCT_SKU WHERE STATUS =3
		]]>
		<dynamic prepend="AND">
			 <![CDATA[
					  SHOP_CODE = #objCondition.supplierId:VARCHAR# 
				]]>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productName">
            <![CDATA[
					PROCUCT_NAME like '%'||#objCondition.productName:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productNo">
            <![CDATA[
					PRODUCT_NO like '%'||#objCondition.productNo:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productSkuCode">
            <![CDATA[
					PRODUCT_SKU_CODE like '%'||#objCondition.productSkuCode:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.status">
            <![CDATA[
					STATUS = #objCondition.status:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.skuStatus">
            <![CDATA[
					sku_status = #objCondition.skuStatus:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
			<dynamic prepend="AND">
			<isNotEmpty property="objCondition.categoryId">
            <![CDATA[
					CATEGORY_ID = #objCondition.categoryId:DECIMAL#
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.mCategoryId">
            <![CDATA[
					CATEGORY_ID in (select CATEGORY_ID from CATEGORYS where PARENT_ID = #objCondition.mCategoryId:DECIMAL# ) 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.bCategoryId">
            <![CDATA[
			 CATEGORY_ID in (select sc.CATEGORY_ID from categorys sc
			inner join categorys mc on sc.parent_id=mc.category_id 
			inner join categorys bc on mc.parent_id=bc.category_id 
			where bc.category_id = #objCondition.bCategoryId:DECIMAL# ) 
				]]>
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		) t )  
		]]>
	</select>
	<!-- 商品发布SKU列表 -->
	<select id="selectProductSkuListByMerchantId" resultMap="ibatorgenerated_BaseResultMap_SKUATTR" parameterClass="pagination">
           <![CDATA[
          SELECT * FROM (SELECT t.*, ROWNUM RN FROM (select * from VIEW_PRODUCT_SKU  WHERE  status=3
		]]>
		<dynamic prepend="AND">
			 <![CDATA[
					  SHOP_CODE = #objCondition.supplierId:VARCHAR#
				]]>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productName">
            <![CDATA[
					PROCUCT_NAME like '%'||#objCondition.productName:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productNo">
            <![CDATA[
					PRODUCT_NO like '%'||#objCondition.productNo:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productSkuCode">
            <![CDATA[
					PRODUCT_SKU_CODE like '%'||#objCondition.productSkuCode:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.status">
            <![CDATA[
					STATUS = #objCondition.status:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.skuStatus">
            <![CDATA[
					sku_status = #objCondition.skuStatus:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.categoryId">
            <![CDATA[
					CATEGORY_ID = #objCondition.categoryId:DECIMAL#
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.mCategoryId">
            <![CDATA[
					CATEGORY_ID in (select CATEGORY_ID from CATEGORYS where PARENT_ID = #objCondition.mCategoryId:DECIMAL# ) 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.bCategoryId">
            <![CDATA[
			 CATEGORY_ID in (select sc.CATEGORY_ID from categorys sc
			inner join categorys mc on sc.parent_id=mc.category_id 
			inner join categorys bc on mc.parent_id=bc.category_id 
			where bc.category_id = #objCondition.bCategoryId:DECIMAL# ) 
				]]>
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		ORDER BY PRODUCT_ID,PRODUCT_SKU_ID DESC ) t 
		WHERE  ROWNUM <= $endindex$ ) WHERE RN >= #startindex# 
		]]>
	</select>
	<!-- 商品发布SKU列表,促销专用 -->
	<select id="selectProductSkuListByMerchantIdForPromotion" resultMap="ibatorgenerated_BaseResultMap_SKUATTR" parameterClass="pagination">
           <![CDATA[
          SELECT * FROM (SELECT t.*, ROWNUM RN FROM (select * from VIEW_PRODUCT_SKU  WHERE  status=3
		]]>
		<dynamic prepend="AND">
			 <![CDATA[
					  SHOP_CODE = #objCondition.supplierId:VARCHAR#
				]]>
		</dynamic>
        <dynamic prepend="AND">
			<isNotEmpty property="objCondition.productName">
            <![CDATA[
					PROCUCT_NAME like '%'||#objCondition.productName:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productNo">
            <![CDATA[
					PRODUCT_NO like '%'||#objCondition.productNo:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productSkuCode">
            <![CDATA[
					PRODUCT_SKU_CODE like '%'||#objCondition.productSkuCode:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.status">
            <![CDATA[
					STATUS = #objCondition.status:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.skuStatus">
            <![CDATA[
					sku_status = #objCondition.skuStatus:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.categoryId">
            <![CDATA[
					CATEGORY_ID = #objCondition.categoryId:DECIMAL#
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.mCategoryId">
            <![CDATA[
					CATEGORY_ID in (select CATEGORY_ID from CATEGORYS where PARENT_ID = #objCondition.mCategoryId:DECIMAL# ) 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.bCategoryId">
            <![CDATA[
			 CATEGORY_ID in (select sc.CATEGORY_ID from categorys sc
			inner join categorys mc on sc.parent_id=mc.category_id 
			inner join categorys bc on mc.parent_id=bc.category_id 
			where bc.category_id = #objCondition.bCategoryId:DECIMAL# ) 
				]]>
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		ORDER BY PRODUCT_ID,PRODUCT_SKU_ID DESC ) t 
		WHERE  ROWNUM <= $endindex$ ) WHERE RN >= #startindex# 
		]]>
	</select>
	<!-- sku列表（运费） -->
	<select id="selectProductSkuListForFreightByMerchantId" resultMap="BaseResultMapForFreight" parameterClass="pagination">
           <![CDATA[
          SELECT * FROM (SELECT t.*, ROWNUM RN FROM (select PRODUCT_ID, PROCUCT_NAME, PRODUCT_TITLE, PRODUCT_NO, STATUS,
      			CATEGORY_ID, CATEGORY_NAME, PRODUCT_SKU_ID, PRODUCT_SKU_CODE,PRICE,unit_weight,MARK_PRICE,SKU_COST_PRICE,FREIGHT,FREE_STATUS
      	    from VIEW_PRODUCT_SKU  WHERE STATUS != -1 
		]]>
		<dynamic prepend="AND">
			 <![CDATA[
					  SHOP_CODE = #objCondition.supplierId:VARCHAR#
				]]>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productName">
            <![CDATA[
					PROCUCT_NAME like '%'||#objCondition.productName:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productTitle">
            <![CDATA[
					PRODUCT_TITLE like '%'||#objCondition.productTitle:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productNo">
            <![CDATA[
					PRODUCT_NO like '%'||#objCondition.productNo:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productSkuCode">
            <![CDATA[
					PRODUCT_SKU_CODE like '%'||#objCondition.productSkuCode:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.status">
            <![CDATA[
					STATUS = #objCondition.status:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.skuStatus">
            <![CDATA[
					sku_status = #objCondition.skuStatus:VARCHAR# 
				]]>
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		ORDER BY PRODUCT_ID,PRODUCT_SKU_ID DESC ) t 
		WHERE  ROWNUM <= $endindex$ ) WHERE RN >= #startindex# 
		]]>
	</select>
  
  <select id="querySKUAttr" parameterClass="int" resultMap="skuAttrValue">  
    select CATEGORY_ATTR_NAME, CATEGORY_ATTR_VALUE
  	from VIEW_SKU_ATTR where PRODUCT_SKU_ID = #productSkuId#
  </select> 
  
    <select id="ibatorgenerated_selectSKUAttrByExample" resultMap="ibatorgenerated_BaseResultMap_SKUATTR" parameterClass="com.pltfm.app.vobject.ViewProductSkuExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Aug 01 17:27:14 CST 2013.
    -->
    select PRODUCT_ID, PROCUCT_NAME, PRODUCT_NO, STATUS,
      CATEGORY_ID, CATEGORY_NAME, PRODUCT_SKU_ID, PRODUCT_SKU_CODE,PRICE,unit_weight,MARK_PRICE
    from VIEW_PRODUCT_SKU 
    <isParameterPresent >
      <include refid="PRODUCT_SKU.ibatorgenerated_Example_Where_Clause_View" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  
  <!-- 已上架和已下架的供应商的所有sku产品记录数 -->
	<select id="selectCanEnableStockCountForProductSkuByMerchantId" resultClass="java.lang.Integer" parameterClass="pagination">
           <![CDATA[
         select count(product_sku_id) from (SELECT t.*, ROWNUM RN FROM (select a.product_id,a.product_title,a.procuct_name,a.product_no,b.product_sku_code,a.status,a.b.product_sku_id from productmain a,product_sku b where a.product_id=b.product_id and a.shop_code=#objCondition.supplierId:VARCHAR# and a.status in(3,4,5) and b.status=1
		]]>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productTitle">
            <![CDATA[
					a.product_title like '%'||#objCondition.productTitle:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>

		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productSkuCode">
            <![CDATA[
					b.product_sku_code like '%'||#objCondition.productSkuCode:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		) t )  
		]]>
	</select>
	
	<!-- 已上架和已下架的供应商的所有sku产品 -->
	<select id="selectCanEnableStockProductSkuListByMerchantId" resultMap="enableStockSkuResultMap" parameterClass="pagination">
           <![CDATA[
         select product_id,product_title,procuct_name,product_no,product_sku_code,status,product_sku_id FROM (SELECT t.*, ROWNUM RN FROM (select a.product_id,a.product_title,a.procuct_name,a.product_no,b.product_sku_code,a.status,a.b.product_sku_id from productmain a,product_sku b where a.product_id=b.product_id and a.shop_code=#objCondition.supplierId:VARCHAR# and a.status in(3,4,5) and b.status=1
		]]>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productTitle">
            <![CDATA[
					a.product_title like '%'||#objCondition.productTitle:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<dynamic prepend="AND">
			<isNotEmpty property="objCondition.productSkuCode">
            <![CDATA[
					b.product_sku_code like '%'||#objCondition.productSkuCode:VARCHAR#||'%' 
				]]>
			</isNotEmpty>
		</dynamic>
		<![CDATA[
		ORDER BY a.PRODUCT_ID,b.PRODUCT_SKU_ID DESC ) t 
		WHERE  ROWNUM <= $endindex$ ) WHERE RN >= #startindex# 
		]]>
	</select>
  
  	<select id="findProductSkuAndName" resultMap="BaseResultMapForFreight" parameterClass="java.lang.Long" >
	    select PRODUCT_ID, PROCUCT_NAME, PRODUCT_TITLE, PRODUCT_NO, STATUS,  CATEGORY_ID, CATEGORY_NAME,
	    	PRODUCT_SKU_ID, PRODUCT_SKU_CODE,PRICE,unit_weight,MARK_PRICE,SKU_COST_PRICE,FREIGHT,FREE_STATUS
	    from VIEW_PRODUCT_SKU where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
	</select>
	
	<update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.pltfm.app.vobject.ProductSku" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Wed Mar 25 15:26:13 CST 2015.
    -->
    update PRODUCT_SKU
    <dynamic prepend="set" >
        MODIF_TIME=sysdate,
      <isNotNull prepend="," property="productId" >
        PRODUCT_ID = #productId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="price" >
        PRICE = #price:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productSkuCode" >
        PRODUCT_SKU_CODE = #productSkuCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        STATUS = #status:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="unitWeight" >
        UNIT_WEIGHT = #unitWeight:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="markPrice" >
        MARK_PRICE = #markPrice:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="costPrice" >
        COST_PRICE = #costPrice:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="pvValue" >
        PV_VALUE = #pvValue:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="costIncomeRatio" >
        COST_INCOME_RATIO = #costIncomeRatio:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="freight" >
        FREIGHT = #freight:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="freeStatus" >
        FREE_STATUS = #freeStatus:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="stock" >
        STOCK = #stock:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="sellerSkuCode" >
        SELLER_SKU_CODE = #sellerSkuCode:VARCHAR#
      </isNotNull>
    </dynamic>
    where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
  </update>
  
  <delete id="deleteByPrimaryKey" parameterClass="java.lang.Long">
  	delete PRODUCT_SKU where PRODUCT_SKU_ID = #productSkuId:DECIMAL#
  </delete>
  
  <select id="findSkuNewAttr" parameterClass="java.lang.Long" resultMap="ibatorgenerated_BaseResultMap_NewAttr" >
  	select PSAD.NEW_ATTR,PSAD.CATEGORY_ATTR_ID
    from PRODUCT_SKU_ATTR PSAD,PRODUCT_SKU PS 
      where PSAD.PRODUCT_SKU_ID = PS.PRODUCT_SKU_ID
      	and PSAD.NEW_ATTR IS NOT NULL 
        and PS.PRODUCT_ID = #productId:DECIMAL#         
        order by PSAD.CATEGORY_ATTR_ID,PSAD.PRODUCT_SKU_ATTR_ID
  </select>
  
  <select id="findMaxSkuCodeByCateCode" resultClass="java.lang.String" parameterClass="java.lang.String" >
  	select max(t.product_sku_code) from PRODUCT_SKU t where t.product_sku_code like '$cateCode$__%'
  </select>
  
  <insert id="insertProductSku" parameterClass="com.pltfm.app.vobject.ProductSku" >
    <selectKey resultClass="java.lang.Long" keyProperty="productSkuId" >
      select SEQ_APP_PRODUCT_SKU.nextval from dual
    </selectKey>
    insert into PRODUCT_SKU (PRODUCT_SKU_ID, PRODUCT_ID, PRICE, PRODUCT_SKU_CODE,STATUS,UNIT_WEIGHT,MARK_PRICE,COST_PRICE,PV_VALUE,COST_INCOME_RATIO,SKU_INTRODUCE,SKU_INTRODUCELAZY,SELLER_SKU_CODE,STOCK,MODIF_TIME,CREATE_TIME)
    values (#productSkuId:DECIMAL#, #productId:DECIMAL#, #price:DOUBLE#, 
      #productSkuCode:VARCHAR#,#status:VARCHAR#, #unitWeight:DECIMAL#, #markPrice:DECIMAL#, #costPrice:DECIMAL#, #pvValue:DECIMAL#, #costIncomeRatio:DECIMAL#,#skuIntroduce:VARCHAR#,#skuIntroduceLazy:VARCHAR#,#sellerSkuCode:VARCHAR#,#stock:DECIMAL#,sysdate,sysdate)
  </insert>

</sqlMap>