<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="KMORDER_ORDER_ALTER_OPERATE_STATEMENT">
  <resultMap class="com.pltfm.app.entities.OrderAlterOperateStatement" id="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    <result column="STATEMENT_ID" jdbcType="DECIMAL" property="statementId" />
    <result column="ORDER_ALTER_CODE" jdbcType="VARCHAR" property="orderAlterCode" />
    <result column="PREVIOUS_ALTER_STATUS" jdbcType="DECIMAL" property="previousAlterStatus" />
    <result column="NOW_ALTER_STATUS" jdbcType="DECIMAL" property="nowAlterStatus" />
    <result column="PREVIOUS_OPERATOR" jdbcType="VARCHAR" property="previousOperator" />
    <result column="NOW_OPERATOR" jdbcType="VARCHAR" property="nowOperator" />
    <result column="PREVIOUS_OPERATE_DATE" jdbcType="date" property="previousOperateDate" />
    <result column="NOW_OPERATE_DATE" jdbcType="date" property="nowOperateDate" />
    <result column="PREVIOUS_OPERATE_TYPE" jdbcType="DECIMAL" property="previousOperateType" />
    <result column="NOW_OPERATE_TYPE" jdbcType="DECIMAL" property="nowOperateType" />
    <result column="PREVIOUS_RETURN_SUM" jdbcType="DECIMAL" property="previousReturnSum" />
    <result column="NOW_RETURN_SUM" jdbcType="DECIMAL" property="nowReturnSum" />
    <result column="OPERATE_INFO" jdbcType="VARCHAR" property="operateInfo" />
  </resultMap>
   <resultMap class="com.pltfm.app.vobject.OrderAlterOperateStatementVo" id="ibatorgenerated_ExtendsResultMap"
  		  extends="ibatorgenerated_BaseResultMap">
  	<!-- 附加 -->
    <result column="NOWALTERSTATUSSTR" jdbcType="VARCHAR" property="nowAlterStatusStr" />
    <result column="NOWOPERATETYPESTR" jdbcType="VARCHAR" property="nowOperateTypeStr" />
  </resultMap>
   <resultMap class="com.pltfm.app.vobject.Address" id="AddressMap">
		<result column="n_address_id" property="n_addressId" jdbcType="DECIMAL" />
		<result column="n_account_id" property="n_accountId" jdbcType="DECIMAL" />
		<result column="name" property="name" jdbcType="VARCHAR" />
		<result column="province" property="province" jdbcType="VARCHAR" />
		<result column="city" property="city" jdbcType="VARCHAR" />
		<result column="detailedaddress" property="detailedAddress" jdbcType="VARCHAR" />
		<result column="cellphone" property="cellphone" jdbcType="VARCHAR" />
		<result column="area" property="area" jdbcType="VARCHAR" />
	</resultMap>
  <sql id="ibatorgenerated_Example_Where_Clause">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    <iterate conjunction="or" prepend="where" property="oredCriteria" removeFirstPrepend="iterate">
      <isEqual compareValue="true" property="oredCriteria[].valid">
        (
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithoutValue">
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithSingleValue">
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithListValue">
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate close=")" conjunction="," open="(" property="oredCriteria[].criteriaWithListValue[].values">
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithBetweenValue">
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="ibatorgenerated_selectByExample" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatementExample" resultMap="ibatorgenerated_ExtendsResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    select STATEMENT_ID, ORDER_ALTER_CODE, PREVIOUS_ALTER_STATUS, NOW_ALTER_STATUS,
      PREVIOUS_OPERATOR, NOW_OPERATOR, PREVIOUS_OPERATE_DATE, NOW_OPERATE_DATE,
      PREVIOUS_OPERATE_TYPE, NOW_OPERATE_TYPE, PREVIOUS_RETURN_SUM, NOW_RETURN_SUM, OPERATE_INFO
            <!-- 附加 -->
      ,(SELECT D.ORDER_DICTIONARY_VALUE FROM ORDER_DICTIONARY D WHERE D.ORDER_DICTIONARY_TYPE = 'Propose_Status' AND D.ORDER_DICTIONARY_KEY = T.NOW_ALTER_STATUS) NOWALTERSTATUSSTR
      ,(SELECT D.ORDER_DICTIONARY_VALUE FROM ORDER_DICTIONARY D WHERE D.ORDER_DICTIONARY_TYPE = 'Alter_Operate_Type' AND D.ORDER_DICTIONARY_KEY = T.NOW_OPERATE_TYPE) NOWOPERATETYPESTR
      <!--  -->
    from  ORDER_ALTER_OPERATE_STATEMENT T
    <isParameterPresent>
      <include refid="KMORDER_ORDER_ALTER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause">
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <select id="ibatorgenerated_selectByPrimaryKey" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatement" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    select STATEMENT_ID, ORDER_ALTER_CODE, PREVIOUS_ALTER_STATUS, NOW_ALTER_STATUS,
      PREVIOUS_OPERATOR, NOW_OPERATOR, PREVIOUS_OPERATE_DATE, NOW_OPERATE_DATE,
      PREVIOUS_OPERATE_TYPE, NOW_OPERATE_TYPE, PREVIOUS_RETURN_SUM, NOW_RETURN_SUM, OPERATE_INFO
    from  ORDER_ALTER_OPERATE_STATEMENT
    where STATEMENT_ID = #statementId:DECIMAL#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatement">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    delete from  ORDER_ALTER_OPERATE_STATEMENT
    where STATEMENT_ID = #statementId:DECIMAL#
  </delete>
  <delete id="ibatorgenerated_deleteByExample" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatementExample">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    delete from  ORDER_ALTER_OPERATE_STATEMENT
    <include refid="KMORDER_ORDER_ALTER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatement">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    <selectKey keyProperty="statementId" resultClass="java.lang.Long">
      select SEQ_ALTER_OPERATE_STATEMENT.NEXTVAL from dual
    </selectKey>
    insert into  ORDER_ALTER_OPERATE_STATEMENT (STATEMENT_ID, ORDER_ALTER_CODE,
      PREVIOUS_ALTER_STATUS, NOW_ALTER_STATUS, PREVIOUS_OPERATOR, NOW_OPERATOR,
      PREVIOUS_OPERATE_DATE, NOW_OPERATE_DATE, PREVIOUS_OPERATE_TYPE, NOW_OPERATE_TYPE,
      PREVIOUS_RETURN_SUM, NOW_RETURN_SUM, OPERATE_INFO)
    values (#statementId:DECIMAL#, #orderAlterCode:VARCHAR#, #previousAlterStatus:DECIMAL#,
      #nowAlterStatus:DECIMAL#, #previousOperator:VARCHAR#, #nowOperator:VARCHAR#,
      #previousOperateDate#, #nowOperateDate#, #previousOperateType:DECIMAL#,
      #nowOperateType:DECIMAL#, #previousReturnSum:DECIMAL#, #nowReturnSum:DECIMAL#,
      #operateInfo:VARCHAR#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatement">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    <selectKey keyProperty="statementId" resultClass="java.lang.Long">
      select SEQ_ALTER_OPERATE_STATEMENT.NEXTVAL from dual
    </selectKey>
    insert into  ORDER_ALTER_OPERATE_STATEMENT
    <dynamic prepend="(">
      <isNotNull prepend="," property="statementId">
        STATEMENT_ID
      </isNotNull>
      <isNotNull prepend="," property="orderAlterCode">
        ORDER_ALTER_CODE
      </isNotNull>
      <isNotNull prepend="," property="previousAlterStatus">
        PREVIOUS_ALTER_STATUS
      </isNotNull>
      <isNotNull prepend="," property="nowAlterStatus">
        NOW_ALTER_STATUS
      </isNotNull>
      <isNotNull prepend="," property="previousOperator">
        PREVIOUS_OPERATOR
      </isNotNull>
      <isNotNull prepend="," property="nowOperator">
        NOW_OPERATOR
      </isNotNull>
      <isNotNull prepend="," property="previousOperateDate">
        PREVIOUS_OPERATE_DATE
      </isNotNull>
      <isNotNull prepend="," property="nowOperateDate">
        NOW_OPERATE_DATE
      </isNotNull>
      <isNotNull prepend="," property="previousOperateType">
        PREVIOUS_OPERATE_TYPE
      </isNotNull>
      <isNotNull prepend="," property="nowOperateType">
        NOW_OPERATE_TYPE
      </isNotNull>
      <isNotNull prepend="," property="previousReturnSum">
        PREVIOUS_RETURN_SUM
      </isNotNull>
      <isNotNull prepend="," property="nowReturnSum">
        NOW_RETURN_SUM
      </isNotNull>
      <isNotNull prepend="," property="operateInfo">
        OPERATE_INFO
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(">
      <isNotNull prepend="," property="statementId">
        #statementId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="orderAlterCode">
        #orderAlterCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="previousAlterStatus">
        #previousAlterStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowAlterStatus">
        #nowAlterStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousOperator">
        #previousOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nowOperator">
        #nowOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="previousOperateDate">
        #previousOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="nowOperateDate">
        #nowOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="previousOperateType">
        #previousOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowOperateType">
        #nowOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousReturnSum">
        #previousReturnSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowReturnSum">
        #nowReturnSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="operateInfo">
        #operateInfo:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <select id="ibatorgenerated_countByExample" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatementExample" resultClass="java.lang.Integer">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    select count(*) from  ORDER_ALTER_OPERATE_STATEMENT
    <include refid="KMORDER_ORDER_ALTER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
  </select>
  <update id="ibatorgenerated_updateByExampleSelective">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    update  ORDER_ALTER_OPERATE_STATEMENT
    <dynamic prepend="set">
      <isNotNull prepend="," property="record.statementId">
        STATEMENT_ID = #record.statementId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.orderAlterCode">
        ORDER_ALTER_CODE = #record.orderAlterCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.previousAlterStatus">
        PREVIOUS_ALTER_STATUS = #record.previousAlterStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.nowAlterStatus">
        NOW_ALTER_STATUS = #record.nowAlterStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.previousOperator">
        PREVIOUS_OPERATOR = #record.previousOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.nowOperator">
        NOW_OPERATOR = #record.nowOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.previousOperateDate">
        PREVIOUS_OPERATE_DATE = #record.previousOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="record.nowOperateDate">
        NOW_OPERATE_DATE = #record.nowOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="record.previousOperateType">
        PREVIOUS_OPERATE_TYPE = #record.previousOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.nowOperateType">
        NOW_OPERATE_TYPE = #record.nowOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.previousReturnSum">
        PREVIOUS_RETURN_SUM = #record.previousReturnSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.nowReturnSum">
        NOW_RETURN_SUM = #record.nowReturnSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.operateInfo">
        OPERATE_INFO = #record.operateInfo:VARCHAR#
      </isNotNull>
    </dynamic>
    <isParameterPresent>
      <include refid="KMORDER_ORDER_ALTER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByExample">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    update  ORDER_ALTER_OPERATE_STATEMENT
    set STATEMENT_ID = #record.statementId:DECIMAL#,
      ORDER_ALTER_CODE = #record.orderAlterCode:VARCHAR#,
      PREVIOUS_ALTER_STATUS = #record.previousAlterStatus:DECIMAL#,
      NOW_ALTER_STATUS = #record.nowAlterStatus:DECIMAL#,
      PREVIOUS_OPERATOR = #record.previousOperator:VARCHAR#,
      NOW_OPERATOR = #record.nowOperator:VARCHAR#,
      PREVIOUS_OPERATE_DATE = #record.previousOperateDate#,
      NOW_OPERATE_DATE = #record.nowOperateDate#,
      PREVIOUS_OPERATE_TYPE = #record.previousOperateType:DECIMAL#,
      NOW_OPERATE_TYPE = #record.nowOperateType:DECIMAL#,
      PREVIOUS_RETURN_SUM = #record.previousReturnSum:DECIMAL#,
      NOW_RETURN_SUM = #record.nowReturnSum:DECIMAL#,
      OPERATE_INFO = #record.operateInfo:VARCHAR#
    <isParameterPresent>
      <include refid="KMORDER_ORDER_ALTER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatement">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    update  ORDER_ALTER_OPERATE_STATEMENT
    <dynamic prepend="set">
      <isNotNull prepend="," property="orderAlterCode">
        ORDER_ALTER_CODE = #orderAlterCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="previousAlterStatus">
        PREVIOUS_ALTER_STATUS = #previousAlterStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowAlterStatus">
        NOW_ALTER_STATUS = #nowAlterStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousOperator">
        PREVIOUS_OPERATOR = #previousOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nowOperator">
        NOW_OPERATOR = #nowOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="previousOperateDate">
        PREVIOUS_OPERATE_DATE = #previousOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="nowOperateDate">
        NOW_OPERATE_DATE = #nowOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="previousOperateType">
        PREVIOUS_OPERATE_TYPE = #previousOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowOperateType">
        NOW_OPERATE_TYPE = #nowOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousReturnSum">
        PREVIOUS_RETURN_SUM = #previousReturnSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowReturnSum">
        NOW_RETURN_SUM = #nowReturnSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="operateInfo">
        OPERATE_INFO = #operateInfo:VARCHAR#
      </isNotNull>
    </dynamic>
    where STATEMENT_ID = #statementId:DECIMAL#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.pltfm.app.entities.OrderAlterOperateStatement">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Thu Sep 05 17:33:01 CST 2013.
    -->
    update  ORDER_ALTER_OPERATE_STATEMENT
    set ORDER_ALTER_CODE = #orderAlterCode:VARCHAR#,
      PREVIOUS_ALTER_STATUS = #previousAlterStatus:DECIMAL#,
      NOW_ALTER_STATUS = #nowAlterStatus:DECIMAL#,
      PREVIOUS_OPERATOR = #previousOperator:VARCHAR#,
      NOW_OPERATOR = #nowOperator:VARCHAR#,
      PREVIOUS_OPERATE_DATE = #previousOperateDate#,
      NOW_OPERATE_DATE = #nowOperateDate#,
      PREVIOUS_OPERATE_TYPE = #previousOperateType:DECIMAL#,
      NOW_OPERATE_TYPE = #nowOperateType:DECIMAL#,
      PREVIOUS_RETURN_SUM = #previousReturnSum:DECIMAL#,
      NOW_RETURN_SUM = #nowReturnSum:DECIMAL#,
      OPERATE_INFO = #operateInfo:VARCHAR#
    where STATEMENT_ID = #statementId:DECIMAL#
  </update>
  <!-- 上一次操作 -->
  <select id="selectNewest" resultMap="ibatorgenerated_BaseResultMap" parameterClass="java.lang.String" >
		SELECT * FROM 
		( SELECT * FROM ORDER_ALTER_OPERATE_STATEMENT WHERE ORDER_ALTER_CODE = #value# ORDER BY NOW_OPERATE_DATE DESC ) 
		WHERE ROWNUM = 1
  </select>
  <select id="selectAddressById" resultMap="AddressMap" parameterClass="java.math.BigDecimal" >
		SELECT * FROM   ADDRESS WHERE N_ADDRESS_ID = #value#
  </select>
  
	<select id="SQL_QUERY_STATEMENT_FOR_REFUND" parameterClass="java.util.Map" resultClass="com.pltfm.app.entities.OrderAlterOperateStatement">
	<![CDATA[
		  select oa.order_alter_id   orderAlterId,
		         oa.propose_status   proposestatus,
		         oa.ruturn_sum       ruturnSum,
		         oa.ruturn_money     ruturnMoney,
		         oa.fare_subsidy     fareSubsidy,
		         oa.order_code       orderCode,
		         oa.order_alter_code orderAlterCode,
		         oa.order_item_id    orderItemId,
		         oa.alter_num        alterNum,
		         oa.alter_type       alterType,
		         oa.province         province,
		         oa.city             city,
		         oa.area             area,
		         oa.address          address,
		         oa.phone            phone,
		         oa.name             name,
		         oa.alter_comment    alterComment
		    from order_alter oa
		   where oa.propose_status = #status:DECIMAL#
		     and oa.order_code in 
	]]>
		<iterate open="(" close=")" conjunction="," property="orderCodes">
		    	#orderCodes[]#
		</iterate>
	</select> 
	
	<!-- 查询待确认的退换货编号 -->
	<select id="SQL_QUERY_UN_CONFIRM_RECEIPT_ORDER_ALTER_CODE" resultClass="java.lang.String">
	<![CDATA[
		select oaps.order_alter_code
		  from order_alter_operate_statement oaps
		 where oaps.now_alter_status in (61, 62, 63)
		   and oaps.now_operate_date <= (sysdate - 10.5)
		    and exists(select 1 from  order_alter oa 
		   where oa.order_alter_code = oaps.order_alter_code and oa.propose_status != 7)
	]]>		   
	</select>
</sqlMap>