<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="KMORDER_ORDER_OPERATE_STATEMENT" >
  <resultMap id="ibatorgenerated_BaseResultMap" class="com.pltfm.app.entities.OrderOperateStatement" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    <result column="STATEMENT_ID" property="statementId" jdbcType="DECIMAL" />
    <!--result column="ORDER_ID" property="orderId" jdbcType="DECIMAL" /-->
    <result column="ORDER_CODE" property="orderCode" jdbcType="VARCHAR" />
    <result column="ORDER_ITEM_ID" property="orderItemId" jdbcType="DECIMAL" />
    <result column="PREVIOUS_ORDER_STATUS" property="previousOrderStatus" jdbcType="DECIMAL" />
    <result column="NOW_ORDER_STATUS" property="nowOrderStatus" jdbcType="DECIMAL" />
    <result column="PREVIOUS_OPERATOR" property="previousOperator" jdbcType="VARCHAR" />
    <result column="NOW_OPERATOR" property="nowOperator" jdbcType="VARCHAR" />
    <result column="PREVIOUS_OPERATE_DATE" property="previousOperateDate" jdbcType="date" />
    <result column="NOW_OPERATE_DATE" property="nowOperateDate" jdbcType="date" />
    <result column="PREVIOUS_OPERATE_TYPE" property="previousOperateType" jdbcType="DECIMAL" />
    <result column="NOW_OPERATE_TYPE" property="nowOperateType" jdbcType="DECIMAL" />
    <result column="PREVIOUS_ORDER_SUM" property="previousOrderSum" jdbcType="DECIMAL" />
    <result column="NOW_ORDER_SUM" property="nowOrderSum" jdbcType="DECIMAL" />
    <result column="OPERATE_INFO" property="operateInfo" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap class="com.pltfm.app.vobject.OrderOperateStatementVo" id="ibatorgenerated_ExtendsResultMap"
  		  extends="ibatorgenerated_BaseResultMap">
  	<!-- 附加 -->
    <result column="NOWORDERSTATUSSTR" jdbcType="VARCHAR" property="nowOrderStatusStr" />
    <result column="NOWOPERATETYPESTR" jdbcType="VARCHAR" property="nowOperateTypeStr" />
  </resultMap>
  <sql id="ibatorgenerated_Example_Where_Clause" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    <iterate property="oredCriteria" conjunction="or" prepend="where" removeFirstPrepend="iterate" >
      <isEqual property="oredCriteria[].valid" compareValue="true" >
        (
        <iterate prepend="and" property="oredCriteria[].criteriaWithoutValue" conjunction="and" >
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithSingleValue" conjunction="and" >
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithListValue" conjunction="and" >
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate property="oredCriteria[].criteriaWithListValue[].values" open="(" close=")" conjunction="," >
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate prepend="and" property="oredCriteria[].criteriaWithBetweenValue" conjunction="and" >
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="ibatorgenerated_selectByExample" resultMap="ibatorgenerated_ExtendsResultMap" parameterClass="com.pltfm.app.entities.OrderOperateStatementExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    select STATEMENT_ID, ORDER_CODE, ORDER_ITEM_ID, PREVIOUS_ORDER_STATUS, NOW_ORDER_STATUS,
      PREVIOUS_OPERATOR, NOW_OPERATOR, PREVIOUS_OPERATE_DATE, NOW_OPERATE_DATE,
      PREVIOUS_OPERATE_TYPE, NOW_OPERATE_TYPE, PREVIOUS_ORDER_SUM, NOW_ORDER_SUM, OPERATE_INFO
       <!-- 附加 -->
      ,(SELECT D.ORDER_DICTIONARY_VALUE FROM ORDER_DICTIONARY D WHERE D.ORDER_DICTIONARY_TYPE = 'Order_Status' AND D.ORDER_DICTIONARY_KEY = T.NOW_ORDER_STATUS) nowOrderStatusStr
      ,(SELECT D.ORDER_DICTIONARY_VALUE FROM ORDER_DICTIONARY D WHERE D.ORDER_DICTIONARY_TYPE = 'Order_Operate_Type' AND D.ORDER_DICTIONARY_KEY = T.NOW_OPERATE_TYPE) nowOperateTypeStr
      <!--  -->
    from  ORDER_OPERATE_STATEMENT T
    <isParameterPresent >
      <include refid="KMORDER_ORDER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause" >
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  
    <!-- 批量查询 -->
  <select id="ibatorgenerated_selectByList" resultMap="ibatorgenerated_BaseResultMap" parameterClass="java.util.List">
    <!--
      	通过orderCode集合查询出相关的订单项集合
      	select * from order_operate_statement oos where oos.now_operate_date 
      	in(select max(oo.now_operate_date) now_operate_date from order_operate_statement oo 
      	where oo.order_code in(13091609520752761,130916095415541561) group by oo.order_code)
    -->
    select STATEMENT_ID, ORDER_CODE, ORDER_ITEM_ID, PREVIOUS_ORDER_STATUS, NOW_ORDER_STATUS,
      PREVIOUS_OPERATOR, NOW_OPERATOR, PREVIOUS_OPERATE_DATE, NOW_OPERATE_DATE,
      PREVIOUS_OPERATE_TYPE, NOW_OPERATE_TYPE, PREVIOUS_ORDER_SUM, NOW_ORDER_SUM, OPERATE_INFO
    from  ORDER_OPERATE_STATEMENT oos where oos.order_code in
    <iterate open="(" close=")" conjunction=","> #[]# </iterate>
     and oos.now_operate_date in
    (select max(oo.now_operate_date) now_operate_date from order_operate_statement oo 
    where oo.ORDER_CODE IN 
       <iterate open="(" close=")" conjunction=","> #[]# </iterate>
      group by oo.order_code )
  </select>
  
  <select id="ibatorgenerated_selectByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.pltfm.app.entities.OrderOperateStatement" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    select STATEMENT_ID, ORDER_CODE, ORDER_ITEM_ID, PREVIOUS_ORDER_STATUS, NOW_ORDER_STATUS,
      PREVIOUS_OPERATOR, NOW_OPERATOR, PREVIOUS_OPERATE_DATE, NOW_OPERATE_DATE,
      PREVIOUS_OPERATE_TYPE, NOW_OPERATE_TYPE, PREVIOUS_ORDER_SUM, NOW_ORDER_SUM, OPERATE_INFO
    from  ORDER_OPERATE_STATEMENT
    where STATEMENT_ID = #statementId:DECIMAL#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.pltfm.app.entities.OrderOperateStatement" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    delete from  ORDER_OPERATE_STATEMENT
    where STATEMENT_ID = #statementId:DECIMAL#
  </delete>
  <delete id="ibatorgenerated_deleteByExample" parameterClass="com.pltfm.app.entities.OrderOperateStatementExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    delete from  ORDER_OPERATE_STATEMENT
    <include refid="KMORDER_ORDER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.pltfm.app.entities.OrderOperateStatement" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    <selectKey resultClass="java.lang.Long" keyProperty="statementId" >
      select SEQ_ORDER_OPERATE_STATEMENT.NEXTVAL from dual
    </selectKey>
    insert into  ORDER_OPERATE_STATEMENT (STATEMENT_ID, ORDER_CODE, ORDER_ITEM_ID,
      PREVIOUS_ORDER_STATUS, NOW_ORDER_STATUS, PREVIOUS_OPERATOR, NOW_OPERATOR,
      PREVIOUS_OPERATE_DATE, NOW_OPERATE_DATE, PREVIOUS_OPERATE_TYPE, NOW_OPERATE_TYPE,
      PREVIOUS_ORDER_SUM, NOW_ORDER_SUM, OPERATE_INFO)
    values (#statementId:DECIMAL#, #orderCode:VARCHAR#, #orderItemId:DECIMAL#,
      #previousOrderStatus:DECIMAL#, #nowOrderStatus:DECIMAL#, #previousOperator:VARCHAR#,
      #nowOperator:VARCHAR#, #previousOperateDate#, #nowOperateDate#,
      #previousOperateType:DECIMAL#, #nowOperateType:DECIMAL#, #previousOrderSum:DECIMAL#,
      #nowOrderSum:DECIMAL#, #operateInfo:VARCHAR#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.pltfm.app.entities.OrderOperateStatement" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    <selectKey resultClass="java.lang.Long" keyProperty="statementId" >
      select SEQ_ORDER_OPERATE_STATEMENT.NEXTVAL from dual
    </selectKey>
    insert into  ORDER_OPERATE_STATEMENT
    <dynamic prepend="(" >
      <isNotNull prepend="," property="statementId" >
        STATEMENT_ID
      </isNotNull>
      <isNotNull prepend="," property="orderCode" >
        ORDER_CODE
      </isNotNull>
      <isNotNull prepend="," property="orderItemId" >
        ORDER_ITEM_ID
      </isNotNull>
      <isNotNull prepend="," property="previousOrderStatus" >
        PREVIOUS_ORDER_STATUS
      </isNotNull>
      <isNotNull prepend="," property="nowOrderStatus" >
        NOW_ORDER_STATUS
      </isNotNull>
      <isNotNull prepend="," property="previousOperator" >
        PREVIOUS_OPERATOR
      </isNotNull>
      <isNotNull prepend="," property="nowOperator" >
        NOW_OPERATOR
      </isNotNull>
      <isNotNull prepend="," property="previousOperateDate" >
        PREVIOUS_OPERATE_DATE
      </isNotNull>
      <isNotNull prepend="," property="nowOperateDate" >
        NOW_OPERATE_DATE
      </isNotNull>
      <isNotNull prepend="," property="previousOperateType" >
        PREVIOUS_OPERATE_TYPE
      </isNotNull>
      <isNotNull prepend="," property="nowOperateType" >
        NOW_OPERATE_TYPE
      </isNotNull>
      <isNotNull prepend="," property="previousOrderSum" >
        PREVIOUS_ORDER_SUM
      </isNotNull>
      <isNotNull prepend="," property="nowOrderSum" >
        NOW_ORDER_SUM
      </isNotNull>
      <isNotNull prepend="," property="operateInfo" >
        OPERATE_INFO
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(" >
      <isNotNull prepend="," property="statementId" >
        #statementId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="orderCode" >
        #orderCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="orderItemId" >
        #orderItemId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousOrderStatus" >
        #previousOrderStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowOrderStatus" >
        #nowOrderStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousOperator" >
        #previousOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nowOperator" >
        #nowOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="previousOperateDate" >
        #previousOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="nowOperateDate" >
        #nowOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="previousOperateType" >
        #previousOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowOperateType" >
        #nowOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousOrderSum" >
        #previousOrderSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowOrderSum" >
        #nowOrderSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="operateInfo" >
        #operateInfo:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <select id="ibatorgenerated_countByExample" parameterClass="com.pltfm.app.entities.OrderOperateStatementExample" resultClass="java.lang.Integer" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    select count(*) from  ORDER_OPERATE_STATEMENT
    <include refid="KMORDER_ORDER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
  </select>
  <update id="ibatorgenerated_updateByExampleSelective" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    update  ORDER_OPERATE_STATEMENT
    <dynamic prepend="set" >
      <isNotNull prepend="," property="record.statementId" >
        STATEMENT_ID = #record.statementId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.orderCode" >
        ORDER_CODE = #record.orderCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.orderItemId" >
        ORDER_ITEM_ID = #record.orderItemId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.previousOrderStatus" >
        PREVIOUS_ORDER_STATUS = #record.previousOrderStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.nowOrderStatus" >
        NOW_ORDER_STATUS = #record.nowOrderStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.previousOperator" >
        PREVIOUS_OPERATOR = #record.previousOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.nowOperator" >
        NOW_OPERATOR = #record.nowOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.previousOperateDate" >
        PREVIOUS_OPERATE_DATE = #record.previousOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="record.nowOperateDate" >
        NOW_OPERATE_DATE = #record.nowOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="record.previousOperateType" >
        PREVIOUS_OPERATE_TYPE = #record.previousOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.nowOperateType" >
        NOW_OPERATE_TYPE = #record.nowOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.previousOrderSum" >
        PREVIOUS_ORDER_SUM = #record.previousOrderSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.nowOrderSum" >
        NOW_ORDER_SUM = #record.nowOrderSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.operateInfo" >
        OPERATE_INFO = #record.operateInfo:VARCHAR#
      </isNotNull>
    </dynamic>
    <isParameterPresent >
      <include refid="KMORDER_ORDER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByExample" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    update  ORDER_OPERATE_STATEMENT
    set STATEMENT_ID = #record.statementId:DECIMAL#,
      ORDER_CODE = #record.orderCode:VARCHAR#,
      ORDER_ITEM_ID = #record.orderItemId:DECIMAL#,
      PREVIOUS_ORDER_STATUS = #record.previousOrderStatus:DECIMAL#,
      NOW_ORDER_STATUS = #record.nowOrderStatus:DECIMAL#,
      PREVIOUS_OPERATOR = #record.previousOperator:VARCHAR#,
      NOW_OPERATOR = #record.nowOperator:VARCHAR#,
      PREVIOUS_OPERATE_DATE = #record.previousOperateDate#,
      NOW_OPERATE_DATE = #record.nowOperateDate#,
      PREVIOUS_OPERATE_TYPE = #record.previousOperateType:DECIMAL#,
      NOW_OPERATE_TYPE = #record.nowOperateType:DECIMAL#,
      PREVIOUS_ORDER_SUM = #record.previousOrderSum:DECIMAL#,
      NOW_ORDER_SUM = #record.nowOrderSum:DECIMAL#,
      OPERATE_INFO = #record.operateInfo:VARCHAR#
    <isParameterPresent >
      <include refid="KMORDER_ORDER_OPERATE_STATEMENT.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.pltfm.app.entities.OrderOperateStatement" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    update  ORDER_OPERATE_STATEMENT
    <dynamic prepend="set" >
      <isNotNull prepend="," property="orderCode" >
        ORDER_CODE = #orderCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="orderItemId" >
        ORDER_ITEM_ID = #orderItemId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousOrderStatus" >
        PREVIOUS_ORDER_STATUS = #previousOrderStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowOrderStatus" >
        NOW_ORDER_STATUS = #nowOrderStatus:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousOperator" >
        PREVIOUS_OPERATOR = #previousOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="nowOperator" >
        NOW_OPERATOR = #nowOperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="previousOperateDate" >
        PREVIOUS_OPERATE_DATE = #previousOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="nowOperateDate" >
        NOW_OPERATE_DATE = #nowOperateDate#
      </isNotNull>
      <isNotNull prepend="," property="previousOperateType" >
        PREVIOUS_OPERATE_TYPE = #previousOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowOperateType" >
        NOW_OPERATE_TYPE = #nowOperateType:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="previousOrderSum" >
        PREVIOUS_ORDER_SUM = #previousOrderSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="nowOrderSum" >
        NOW_ORDER_SUM = #nowOrderSum:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="operateInfo" >
        OPERATE_INFO = #operateInfo:VARCHAR#
      </isNotNull>
    </dynamic>
    where STATEMENT_ID = #statementId:DECIMAL#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.pltfm.app.entities.OrderOperateStatement" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    update  ORDER_OPERATE_STATEMENT
    set ORDER_CODE = #orderCode:VARCHAR#,
      ORDER_ITEM_ID = #orderItemId:DECIMAL#,
      PREVIOUS_ORDER_STATUS = #previousOrderStatus:DECIMAL#,
      NOW_ORDER_STATUS = #nowOrderStatus:DECIMAL#,
      PREVIOUS_OPERATOR = #previousOperator:VARCHAR#,
      NOW_OPERATOR = #nowOperator:VARCHAR#,
      PREVIOUS_OPERATE_DATE = #previousOperateDate#,
      NOW_OPERATE_DATE = #nowOperateDate#,
      PREVIOUS_OPERATE_TYPE = #previousOperateType:DECIMAL#,
      NOW_OPERATE_TYPE = #nowOperateType:DECIMAL#,
      PREVIOUS_ORDER_SUM = #previousOrderSum:DECIMAL#,
      NOW_ORDER_SUM = #nowOrderSum:DECIMAL#,
      OPERATE_INFO = #operateInfo:VARCHAR#
    where STATEMENT_ID = #statementId:DECIMAL#
  </update>
  
  <select id="selectLatestByPrimaryKey" resultMap="ibatorgenerated_BaseResultMap" parameterClass="com.pltfm.app.entities.OrderOperateStatement" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Mon Jul 29 11:23:58 CST 2013.
    -->
    SELECT * FROM
    (select STATEMENT_ID, ORDER_CODE, ORDER_ITEM_ID, PREVIOUS_ORDER_STATUS, NOW_ORDER_STATUS,
      PREVIOUS_OPERATOR, NOW_OPERATOR, PREVIOUS_OPERATE_DATE, NOW_OPERATE_DATE,
      PREVIOUS_OPERATE_TYPE, NOW_OPERATE_TYPE, PREVIOUS_ORDER_SUM, NOW_ORDER_SUM, OPERATE_INFO
    from  ORDER_OPERATE_STATEMENT
    where ORDER_CODE = #orderCode:VARCHAR# and NOW_OPERATE_DATE = (select max(NOW_OPERATE_DATE) from  ORDER_OPERATE_STATEMENT where ORDER_CODE = #orderCode:VARCHAR#)
    order by STATEMENT_ID DESC) 
    where ROWNUM = 1
  </select>  
  
  <select id="selectNewest" resultMap="ibatorgenerated_BaseResultMap" parameterClass="java.lang.String" >
		SELECT * FROM 
		( SELECT * FROM ORDER_OPERATE_STATEMENT WHERE ORDER_CODE = #value# ORDER BY NOW_OPERATE_DATE DESC ) 
		WHERE ROWNUM = 1
  </select>
  <!-- 根据订单号和订单状态查询最近一次满足条件的订单流水 -->
   <select id="selectNewestWithStatus" resultMap="ibatorgenerated_BaseResultMap" parameterClass="java.util.Map" >
		SELECT * FROM 
		( SELECT * FROM  ORDER_OPERATE_STATEMENT WHERE ORDER_CODE = #orderCode# and now_order_status =#orderStatus#  ORDER BY NOW_OPERATE_DATE DESC ) 
		WHERE ROWNUM = 1
  </select>
  
  	<!-- 获取订单物流信息修改次数 -->
	<select id="SQL_QUERY_UPDATE_COUNT_FOR_LOGISTIC" parameterClass="java.lang.String" resultClass="int">
  	<![CDATA[
  		select count(1)
		  from order_operate_statement ops
		 where ops.now_operate_type = 7
		   and ops.order_code = #orderCode:VARCHAR#
  	]]>
  	</select>
  	
  	<!-- 查询待确认收货的订单编号 -->
  	<select id="SQL_QUERY_UN_CONFIRM_RECEIPT_ORDER_CODE" resultClass="java.lang.String">
  	<![CDATA[
  		select rs.orderCode orderCode
		  from (select ops.order_code orderCode,
		               max(ops.now_operate_date) +
		               nvl((select max(ome.delay_receipt)
		                     from order_main_ext ome
		                    where ome.order_code = ops.order_code),
		                   0) distDate
		          from order_operate_statement ops
		         where ops.now_operate_date <= (sysdate - 10.5)
		           and ops.now_operate_type = 7
		           and exists (select 1
		                  from order_main om
		                 where om.order_status = 5
		                   and om.order_code = ops.order_code)
		         group by ops.order_code) rs
		 where rs.distDate <= (sysdate - 10.5)
  	]]>
  	</select>
</sqlMap>